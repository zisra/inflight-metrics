/*
 RequireJS 2.0.4 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 Available via the MIT or new BSD license.
 see: http://github.com/jrburke/requirejs for details
*/
(function(l){function p(r){return"[object Function]"===e.call(r)}function k(r){return"[object Array]"===e.call(r)}function h(e,r){if(e){var a;for(a=0;a<e.length&&(!e[a]||!r(e[a],a,e));a+=1);}}function m(e,r){if(e){var a;for(a=e.length-1;-1<a&&(!e[a]||!r(e[a],a,e));--a);}}function g(e,r){for(var a in e)if(e.hasOwnProperty(a)&&r(e[a],a))break}function d(e,r,a,b){r&&g(r,function(r,n){if(a||!e.hasOwnProperty(n))b&&"string"!==typeof r?(e[n]||(e[n]={}),d(e[n],r,a,b)):e[n]=r});return e}function c(e,r){return function(){return r.apply(e,
arguments)}}function q(e){if(!e)return e;var r=l;h(e.split("."),function(e){r=r[e]});return r}function b(e,r,a){return function(){var b=A.call(arguments,0),n;a&&p(n=b[b.length-1])&&(n.__requireJsBuild=!0);b.push(r);return e.apply(null,b)}}function a(e,r,a){h([["toUrl"],["undef"],["defined","requireDefined"],["specified","requireSpecified"]],function(n){var c=n[1]||n[0];e[n[0]]=r?b(r[c],a):function(){var e=J._;return e[c].apply(e,arguments)}})}function w(e,r,a,b){r=Error(r+"\nhttp://requirejs.org/docs/errors.html#"+
e);r.requireType=e;r.requireModules=b;a&&(r.originalError=a);return r}function x(e){function r(e,a,b){var n=a&&a.split("/"),c=n,d=I.map,q=d&&d["*"],g,z,x;if(e&&"."===e.charAt(0))if(a){c=I.pkgs[a]?n=[a]:n.slice(0,n.length-1);a=e=c.concat(e.split("/"));for(c=0;a[c];c+=1)if(g=a[c],"."===g)a.splice(c,1),--c;else if(".."===g)if(1!==c||".."!==a[2]&&".."!==a[0])0<c&&(a.splice(c-1,2),c-=2);else break;c=I.pkgs[a=e[0]];e=e.join("/");c&&e===a+"/"+c.main&&(e=a)}else 0===e.indexOf("./")&&(e=e.substring(2));if(b&&
(n||q)&&d)for(a=e.split("/"),c=a.length;0<c;--c){z=a.slice(0,c).join("/");if(n)for(g=n.length;0<g;--g)if(b=d[n.slice(0,g).join("/")])if(b=b[z]){x=b;break}!x&&q&&q[z]&&(x=q[z]);if(x){a.splice(0,c,x);e=a.join("/");break}}return e}function n(e){W&&h(document.getElementsByTagName("script"),function(r){if(r.getAttribute("data-requiremodule")===e&&r.getAttribute("data-requirecontext")===K.contextName)return r.parentNode.removeChild(r),!0})}function x(e){var r=I.paths[e];if(r&&k(r)&&1<r.length)return n(e),
r.shift(),K.undef(e),K.require([e]),!0}function z(e,a,b,n){var c=e?e.indexOf("!"):-1,d=null,q=a?a.name:null,g=e,x=!0,A="",w,h;e||(x=!1,e="_@r"+(U+=1));-1!==c&&(d=e.substring(0,c),e=e.substring(c+1,e.length));d&&(d=r(d,q,n),h=O[d]);e&&(d?A=h&&h.normalize?h.normalize(e,function(e){return r(e,q,n)}):r(e,q,n):(A=r(e,q,n),w=K.nameToUrl(A)));e=!d||h||b?"":"_unnormalized"+(ca+=1);return{prefix:d,name:A,parentMap:a,unnormalized:!!e,url:w,originalName:g,isDefine:x,id:(d?d+"!"+A:A)+e}}function A(e){var r=e.id,
a=H[r];a||(a=H[r]=new K.Module(e));return a}function t(e,r,a){var b=e.id,n=H[b];if(!O.hasOwnProperty(b)||n&&!n.defineEmitComplete)A(e).on(r,a);else"defined"===r&&a(O[b])}function v(e,r){var a=e.requireModules,b=!1;if(r)r(e);else if(h(a,function(r){if(r=H[r])r.error=e,r.events.error&&(b=!0,r.emit("error",e))}),!b)B.onError(e)}function m(){X.length&&(Z.apply(ka,[ka.length-1,0].concat(X)),X=[])}function u(e,r,n){e=e&&e.map;r=b(n||K.require,e,r);a(r,K,e);r.isBrowser=W;return r}function y(e){delete H[e];
h(ba,function(r,a){if(r.map.id===e)return ba.splice(a,1),r.defined||--K.waitCount,!0})}function J(e,r){var a=e.map.id,b=e.depMaps,n;if(e.inited){if(r[a])return e;r[a]=!0;h(b,function(e){if(e=H[e.id])return e.inited&&e.enabled?n=J(e,d({},r)):(n=null,delete r[a],!0)});return n}}function Q(e,r,a){var b=e.map.id,n=e.depMaps;if(e.inited&&e.map.isDefine){if(r[b])return O[b];r[b]=e;h(n,function(n){n=n.id;var c=H[n];!Oa[n]&&c&&(c.inited&&c.enabled?(c=Q(c,r,a),a[n]||e.defineDepById(n,c)):a[b]=!0)});e.check(!0);
return O[b]}}function ra(e){e.check()}function da(){var e=1E3*I.waitSeconds,r=e&&K.startTime+e<(new Date).getTime(),a=[],b=!1,c=!0,d,q,z;if(!ma){ma=!0;g(H,function(e){d=e.map;q=d.id;if(e.enabled&&!e.error)if(!e.inited&&r)x(q)?b=z=!0:(a.push(q),n(q));else if(!e.inited&&e.fetched&&d.isDefine&&(b=!0,!d.prefix))return c=!1});if(r&&a.length)return e=w("timeout","Load timeout for modules: "+a,null,a),e.contextName=K.contextName,v(e);c&&(h(ba,function(e){if(!e.defined){e=J(e,{});var r={};e&&(Q(e,r,{}),g(r,
ra))}}),g(H,ra));r&&!z||!b||!W&&!oa||Ya||(Ya=setTimeout(function(){Ya=0;da()},50));ma=!1}}function na(e){A(z(e[0],null,!0)).init(e[1],e[2])}function D(e){e=e.currentTarget||e.srcElement;var r=K.onScriptLoad;e.detachEvent&&!ea?e.detachEvent("onreadystatechange",r):e.removeEventListener("load",r,!1);r=K.onScriptError;e.detachEvent&&!ea||e.removeEventListener("error",r,!1);return{node:e,id:e&&e.getAttribute("data-requiremodule")}}var I={waitSeconds:7,baseUrl:"./",paths:{},pkgs:{},shim:{}},H={},L={},
ka=[],O={},S={},U=1,ca=1,ba=[],ma,Fa,K,Oa,Ya;Oa={require:function(e){return u(e)},exports:function(e){e.usingExports=!0;if(e.map.isDefine)return e.exports=O[e.map.id]={}},module:function(e){return e.module={id:e.map.id,uri:e.map.url,config:function(){return I.config&&I.config[e.map.id]||{}},exports:O[e.map.id]}}};Fa=function(e){this.events=L[e.id]||{};this.map=e;this.shim=I.shim[e.id];this.depExports=[];this.depMaps=[];this.depMatched=[];this.pluginMaps={};this.depCount=0};Fa.prototype={init:function(e,
r,a,b){b=b||{};if(!this.inited){this.factory=r;if(a)this.on("error",a);else this.events.error&&(a=c(this,function(e){this.emit("error",e)}));this.depMaps=e&&e.slice(0);this.depMaps.rjsSkipMap=e.rjsSkipMap;this.errback=a;this.inited=!0;this.ignore=b.ignore;b.enabled||this.enabled?this.enable():this.check()}},defineDepById:function(e,r){var a;h(this.depMaps,function(r,b){if(r.id===e)return a=b,!0});return this.defineDep(a,r)},defineDep:function(e,r){this.depMatched[e]||(this.depMatched[e]=!0,--this.depCount,
this.depExports[e]=r)},fetch:function(){if(!this.fetched){this.fetched=!0;K.startTime=(new Date).getTime();var e=this.map;if(this.shim)u(this,!0)(this.shim.deps||[],c(this,function(){return e.prefix?this.callPlugin():this.load()}));else return e.prefix?this.callPlugin():this.load()}},load:function(){var e=this.map.url;S[e]||(S[e]=!0,K.load(this.map.id,e))},check:function(e){if(this.enabled&&!this.enabling){var r=this.map.id,a=this.depExports,b=this.exports,n=this.factory,c;if(!this.inited)this.fetch();
else if(this.error)this.emit("error",this.error);else if(!this.defining){this.defining=!0;if(1>this.depCount&&!this.defined){if(p(n)){if(this.events.error)try{b=K.execCb(r,n,a,b)}catch(d){c=d}else b=K.execCb(r,n,a,b);this.map.isDefine&&((a=this.module)&&void 0!==a.exports&&a.exports!==this.exports?b=a.exports:void 0===b&&this.usingExports&&(b=this.exports));if(c)return c.requireMap=this.map,c.requireModules=[this.map.id],c.requireType="define",v(this.error=c)}else b=n;this.exports=b;if(this.map.isDefine&&
!this.ignore&&(O[r]=b,B.onResourceLoad))B.onResourceLoad(K,this.map,this.depMaps);delete H[r];this.defined=!0;--K.waitCount;0===K.waitCount&&(ba=[])}this.defining=!1;e||!this.defined||this.defineEmitted||(this.defineEmitted=!0,this.emit("defined",this.exports),this.defineEmitComplete=!0)}}},callPlugin:function(){var e=this.map,a=e.id,b=z(e.prefix,null,!1,!0);t(b,"defined",c(this,function(b){var n=this.map.name,d=this.map.parentMap?this.map.parentMap.name:null;if(this.map.unnormalized){if(b.normalize&&
(n=b.normalize(n,function(e){return r(e,d,!0)})||""),b=z(e.prefix+"!"+n,this.map.parentMap,!1,!0),t(b,"defined",c(this,function(e){this.init([],function(){return e},null,{enabled:!0,ignore:!0})})),b=H[b.id]){if(this.events.error)b.on("error",c(this,function(e){this.emit("error",e)}));b.enable()}}else n=c(this,function(e){this.init([],function(){return e},null,{enabled:!0})}),n.error=c(this,function(e){this.inited=!0;this.error=e;e.requireModules=[a];g(H,function(e){0===e.map.id.indexOf(a+"_unnormalized")&&
y(e.map.id)});v(e)}),n.fromText=function(e,r){var a=N;a&&(N=!1);A(z(e));B.exec(r);a&&(N=!0);K.completeLoad(e)},b.load(e.name,u(e.parentMap,!0,function(e,r){e.rjsSkipMap=!0;return K.require(e,r)}),n,I)}));K.enable(b,this);this.pluginMaps[b.id]=b},enable:function(){this.enabled=!0;this.waitPushed||(ba.push(this),K.waitCount+=1,this.waitPushed=!0);this.enabling=!0;h(this.depMaps,c(this,function(e,r){var a,b;if("string"===typeof e){e=z(e,this.map.isDefine?this.map:this.map.parentMap,!1,!this.depMaps.rjsSkipMap);
this.depMaps[r]=e;if(a=Oa[e.id]){this.depExports[r]=a(this);return}this.depCount+=1;t(e,"defined",c(this,function(e){this.defineDep(r,e);this.check()}));this.errback&&t(e,"error",this.errback)}a=e.id;b=H[a];Oa[a]||!b||b.enabled||K.enable(e,this)}));g(this.pluginMaps,c(this,function(e){var r=H[e.id];r&&!r.enabled&&K.enable(e,this)}));this.enabling=!1;this.check()},on:function(e,r){var a=this.events[e];a||(a=this.events[e]=[]);a.push(r)},emit:function(e,r){h(this.events[e],function(e){e(r)});"error"===
e&&delete this.events[e]}};return K={config:I,contextName:e,registry:H,defined:O,urlFetched:S,waitCount:0,defQueue:ka,Module:Fa,makeModuleMap:z,configure:function(e){e.baseUrl&&"/"!==e.baseUrl.charAt(e.baseUrl.length-1)&&(e.baseUrl+="/");var r=I.pkgs,a=I.shim,b=I.paths,n=I.map;d(I,e,!0);I.paths=d(b,e.paths,!0);e.map&&(I.map=d(n||{},e.map,!0,!0));e.shim&&(g(e.shim,function(e,r){k(e)&&(e={deps:e});e.exports&&!e.exports.__buildReady&&(e.exports=K.makeShimExports(e.exports));a[r]=e}),I.shim=a);e.packages&&
(h(e.packages,function(e){e="string"===typeof e?{name:e}:e;r[e.name]={name:e.name,location:e.location||e.name,main:(e.main||"main").replace(F,"").replace(C,"")}}),I.pkgs=r);g(H,function(e,r){e.map=z(r)});(e.deps||e.callback)&&K.require(e.deps||[],e.callback)},makeShimExports:function(e){var r;return"string"===typeof e?(r=function(){return q(e)},r.exports=e,r):function(){return e.apply(l,arguments)}},requireDefined:function(e,r){var a=z(e,r,!1,!0).id;return O.hasOwnProperty(a)},requireSpecified:function(e,
r){e=z(e,r,!1,!0).id;return O.hasOwnProperty(e)||H.hasOwnProperty(e)},require:function(r,a,b,n){var c;if("string"===typeof r){if(p(a))return v(w("requireargs","Invalid require call"),b);if(B.get)return B.get(K,r,a);r=z(r,a,!1,!0);r=r.id;return O.hasOwnProperty(r)?O[r]:v(w("notloaded",'Module name "'+r+'" has not been loaded yet for context: '+e))}b&&!p(b)&&(n=b,b=void 0);a&&!p(a)&&(n=a,a=void 0);for(m();ka.length;){c=ka.shift();if(null===c[0])return v(w("mismatch","Mismatched anonymous define() module: "+
c[c.length-1]));na(c)}A(z(null,n)).init(r,a,b,{enabled:!0});da();return K.require},undef:function(e){var r=z(e,null,!0),a=H[e];delete O[e];delete S[r.url];delete L[e];a&&(a.events.defined&&(L[e]=a.events),y(e))},enable:function(e,r){H[e.id]&&A(e).enable()},completeLoad:function(e){var r=I.shim[e]||{},a=r.exports&&r.exports.exports,b,n;for(m();ka.length;){n=ka.shift();if(null===n[0]){n[0]=e;if(b)break;b=!0}else n[0]===e&&(b=!0);na(n)}n=H[e];if(!b&&!O[e]&&n&&!n.inited)if(!I.enforceDefine||a&&q(a))na([e,
r.deps||[],r.exports]);else return x(e)?void 0:v(w("nodefine","No define call for "+e,null,[e]));da()},toUrl:function(e,a){var b=e.lastIndexOf("."),n=null;-1!==b&&(n=e.substring(b,e.length),e=e.substring(0,b));return K.nameToUrl(r(e,a&&a.id,!0),n)},nameToUrl:function(e,r){var a,b,n,c,d,q;if(B.jsExtRegExp.test(e))c=e+(r||"");else{a=I.paths;b=I.pkgs;c=e.split("/");for(d=c.length;0<d;--d)if(q=c.slice(0,d).join("/"),n=b[q],q=a[q]){k(q)&&(q=q[0]);c.splice(0,d,q);break}else if(n){a=e===n.name?n.location+
"/"+n.main:n.location;c.splice(0,d,a);break}c=c.join("/")+(r||".js");c=("/"===c.charAt(0)||c.match(/^[\w\+\.\-]+:/)?"":I.baseUrl)+c}return I.urlArgs?c+((-1===c.indexOf("?")?"?":"&")+I.urlArgs):c},load:function(e,r){B.load(K,e,r)},execCb:function(e,r,a,b){return r.apply(b,a)},onScriptLoad:function(e){if("load"===e.type||T.test((e.currentTarget||e.srcElement).readyState))qa=null,e=D(e),K.completeLoad(e.id)},onScriptError:function(e){var r=D(e);if(!x(r.id))return v(w("scripterror","Script error",e,[r.id]))}}}
function v(){if(qa&&"interactive"===qa.readyState)return qa;m(document.getElementsByTagName("script"),function(e){if("interactive"===e.readyState)return qa=e});return qa}var t,n,z,y=/(\/\*([\s\S]*?)\*\/|([^:]|^)\/\/(.*)$)/mg,u=/[^.]\s*require\s*\(\s*["']([^'"\s]+)["']\s*\)/g,C=/\.js$/,F=/^\.\//,e=Object.prototype.toString,r=Array.prototype,A=r.slice,Z=r.splice,W=!("undefined"===typeof window||!navigator||!document),oa=!W&&"undefined"!==typeof importScripts,T=W&&"PLAYSTATION 3"===navigator.platform?
/^complete$/:/^(complete|loaded)$/,ea="undefined"!==typeof opera&&"[object Opera]"===opera.toString(),J={},Q={},X=[],N=!1,B,L,ra,da,na,qa,I,ka,D;if("undefined"===typeof z){if("undefined"!==typeof t){if(p(t))return;Q=t;t=void 0}"undefined"===typeof n||p(n)||(Q=n,n=void 0);B=t=function(e,r,a,b){var n="_",c;k(e)||"string"===typeof e||(c=e,k(r)?(e=r,r=a,a=b):e=[]);c&&c.context&&(n=c.context);(b=J[n])||(b=J[n]=B.s.newContext(n));c&&b.configure(c);return b.require(e,r,a)};B.config=function(e){return B(e)};
n||(n=B);B.version="2.0.4";B.jsExtRegExp=/^\/|:|\?|\.js$/;B.isBrowser=W;z=B.s={contexts:J,newContext:x};B({});a(B);W&&(L=z.head=document.getElementsByTagName("head")[0],ra=document.getElementsByTagName("base")[0])&&(L=z.head=ra.parentNode);B.onError=function(e){throw e;};B.load=function(e,r,a){var b=e&&e.config||{},n;if(W)return n=b.xhtml?document.createElementNS("http://www.w3.org/1999/xhtml","html:script"):document.createElement("script"),n.type=b.scriptType||"text/javascript",n.charset="utf-8",
n.async=!0,n.setAttribute("data-requirecontext",e.contextName),n.setAttribute("data-requiremodule",r),!n.attachEvent||n.attachEvent.toString&&0>n.attachEvent.toString().indexOf("[native code")||ea?(n.addEventListener("load",e.onScriptLoad,!1),n.addEventListener("error",e.onScriptError,!1)):(N=!0,n.attachEvent("onreadystatechange",e.onScriptLoad)),n.src=a,I=n,ra?L.insertBefore(n,ra):L.appendChild(n),I=null,n;oa&&(importScripts(a),e.completeLoad(r))};W&&m(document.getElementsByTagName("script"),function(e){L||
(L=e.parentNode);if(da=e.getAttribute("data-main"))return Q.baseUrl||(na=da.split("/"),ka=na.pop(),D=na.length?na.join("/")+"/":"./",Q.baseUrl=D,da=ka),da=da.replace(C,""),Q.deps=Q.deps?Q.deps.concat(da):[da],!0});z=function(e,r,a){var b,n;"string"!==typeof e&&(a=r,r=e,e=null);k(r)||(a=r,r=[]);!r.length&&p(a)&&a.length&&(a.toString().replace(y,"").replace(u,function(e,a){r.push(a)}),r=(1===a.length?["require"]:["require","exports","module"]).concat(r));N&&(b=I||v())&&(e||(e=b.getAttribute("data-requiremodule")),
n=J[b.getAttribute("data-requirecontext")]);(n?n.defQueue:X).push([e,r,a])};z.amd={jQuery:!0};B.exec=function(e){return eval(e)};B(Q);var ba={version:"02.04.00.0",host:location.protocol+"//api.inflightpanasonic.aero",servicesHost:location.protocol+"//services.inflightpanasonic.aero",setHost:function(e){Inflight.console.warn("Deprecated Host",e)},makeServiceURL:function(e,r){e=this.servicesHost+"/inflight/services"+e;!0===r&&(e=e.replace("http://","https://"));return e},define:z,initService:function(e,
r,a){var b=[];"string"===typeof e?b.push(e):e instanceof Array&&(b=e);n(b,r,function(e){for(var r=" | Failed to load: ",b=0;b<e.requireModules.length;b++)t.undef(e.requireModules[b]),r+=e.requireModules[b]+",";r=r.substring(0,r.length-1);if(a&&e&&e.requireType&&("scripterror"===e.requireType||"timeout"===e.requireType))a({code:404,text:e.requireType+": "+e.message+r});else throw e;})},exit:function(e){ba.initService("sdk/v1/iosbridge",function(r){r=r.call("ifapi.portal.notification",{message:"ifapi.portal.exit"},
e);"object"===typeof r&&503===r.code&&e(r)})},console:{log:function(){Date.prototype.toUTCString&&Array.prototype.unshift&&Array.prototype.unshift.call(arguments,(new Date).toUTCString());window.console&&console.log&&(console.log&&console.log.apply?console.log.apply(console,arguments):console.log&&console.log(Array.prototype.slice.call(arguments)))},info:function(){Date.prototype.toUTCString&&Array.prototype.unshift&&Array.prototype.unshift.call(arguments,(new Date).toUTCString());window.console&&
(console.info&&console.info.apply?console.info.apply(console,arguments):console.info?console.info(Array.prototype.slice.call(arguments)):ba.console.log.apply(this,arguments))},error:function(){Date.prototype.toUTCString&&Array.prototype.unshift&&Array.prototype.unshift.call(arguments,(new Date).toUTCString());window.console&&(console.error&&console.error.apply?console.error.apply(console,arguments):console.error?console.error(Array.prototype.slice.call(arguments)):ba.console.log.apply(this,arguments))},
warn:function(){var e;Date.prototype.toUTCString&&Array.prototype.unshift&&Array.prototype.unshift.call(arguments,(new Date).toUTCString());if(window.console){e=Array.prototype.slice.call(arguments);for(var r=0;r<e.length;r++)"undefined"===typeof e[r]&&(e[r]="undefined");console.warn&&console.warn.apply?console.warn.apply(console,e):console.warn?console.warn(e):ba.console.log.apply(this,e)}},trace:function(){window.console&&console.trace&&console.trace.apply(console,Array.prototype.slice.call(arguments))}},
Error:function(e,r){this.code=e;this.text=r}},U={};ba.dispatchEvent=function(e,r){if(U.hasOwnProperty(e))for(var a=0;a<U[e].length;a++)U[e][a](r)};ba.addEventListener=function(e,r){U.hasOwnProperty(e)||(U[e]=[]);U[e].push(r)};ba.removeEventListener=function(e){U.hasOwnProperty(e)&&delete U[e]};n.config({baseUrl:location.protocol+"//api.inflightpanasonic.aero/inflight/static",enforceDefine:!0,urlArgs:ba.version,waitSeconds:30});window.InFlight=ba}})(this);/*
 Copyright (c) 2010-2012 Robert Kieffer
 MIT License - http://opensource.org/licenses/mit-license.php
*/
(function(){function l(c,b,a){var d=c=null;switch(a){case m.TEST.SUCCESS_RESPONSE:c='{"data":{"voucher_id":"c170bb2f6bfa9bb416c7d90b0022dfbe0b1f2124"}}';break;case m.TEST.ERROR_RESPONSE:c='{"error":{"code":404,"message":"Could not get auth token"}}';break;case m.TEST.NO_DATA_RESPONSE:c='{"voucher_id":"c170bb2f6bfa9bb416c7d90b0022dfbe0b1f2124"}';break;case m.TEST.EMPTY_RESPONSE:c="{}";break;case m.TEST.INVALID_RESPONSE:c="[]";break;case m.TEST.NULL_RESPONSE:c=null;break;case m.TEST.PERMANENT_REDIRECT:d=
h(308,"");break;case m.TEST.BAD_REQUEST:d=h(400,"");break;case m.TEST.FORBIDDEN:d=h(403,"");break;case m.TEST.NOT_FOUND:d=h(404,"");break;case m.TEST.REQUEST_TIMEOUT:d=h(408,"");break;case m.TEST.TOO_MANY_REQUESTS:d=h(429,"");break;case m.TEST.INTERNAL_SERVER_ERROR:d=h(500,"");break;case m.TEST.BAD_GATEWAY:d=h(502,"");break;case m.TEST.SERVICE_UNAVAILABLE:d=h(503,"");break;case m.TEST.NETWORK_AUTHENTICATION_REQUIRED:d=h(511,"")}b(d,c)}function p(c,b){var a=this;g.get({url:InFlight.makeServiceURL("/one_media/v1/get_voucher"),
query:c},function(b,c){var d=null;null!=c&&(d=c.body);a.voucherCallback(b,d)})}function k(c,b){return{code:c,text:b}}function h(c,b){return{code:c,text:b}}var m={},g=null,d=null;m.UNIT_TEST=null;m.UNIT_TEST_FLAG=null;m.TEST={SUCCESS_RESPONSE:"success_response",ERROR_RESPONSE:"error_response",NO_DATA_RESPONSE:"no_data_response",EMPTY_RESPONSE:"empty_response",INVALID_RESPONSE:"invalid_response",NULL_RESPONSE:"null_response",PERMANENT_REDIRECT:"permanent_redirect",BAD_REQUEST:"bad_request",FORBIDDEN:"forbidden",
NOT_FOUND:"not_found",REQUEST_TIMEOUT:"request_rimeout",TOO_MANY_REQUESTS:"too_many_requests",INTERNAL_SERVER_ERROR:"internal_server_error",BAD_GATEWAY:"bad_gateway",SERVICE_UNAVAILABLE:"service_unavailable",NETWORK_AUTHENTICATION_REQUIRED:"network_authentication_required"};m.getBanner=function(c,b){c&&c.zone_path?c&&c.zone_width?c&&c.zone_height?g.get({url:InFlight.makeServiceURL("/one_media/v1/banner"),query:c},function(a,c){if(a)b(a,c);else if(200!==c.code)404===c.code?b({code:404,text:""},null):
b({code:c.code,text:""});else{try{resp=JSON.parse(c.body)}catch(d){b({code:500,text:""});return}b(null,resp)}}):b({code:400,text:""}):b({code:400,text:""}):b({code:400,text:""})};m.getInterstitial=function(c,b){c&&c.zone_path?c&&c.zone_width?c&&c.zone_height?g.get({url:InFlight.makeServiceURL("/one_media/v1/interstitial"),query:c},function(a,c){if(a)b(a,c);else if(200!==c.code)404===c.code?b({code:404,text:""},null):b({code:c.code,text:""});else{try{resp=JSON.parse(c.body)}catch(d){b({code:500,text:""});
return}b(null,resp)}}):b({code:400,text:""}):b({code:400,text:""}):b({code:400,text:""})};m.getVideo=function(c,b){c&&c.zone_path?g.get({url:InFlight.makeServiceURL("/one_media/v1/video"),query:c},function(a,c){if(a)b(a,c);else if(200!==c.code)404===c.code?b({code:404,text:""},null):b({code:c.code,text:""});else{try{resp=JSON.parse(c.body)}catch(d){b({code:500,text:""});return}b(null,resp)}}):b({code:400,text:""})};m.getVoucher=function(c,b){c&&c.group_id?(voucherCallback=function(a,c){if(null!=a){var g=
null;switch(a.code){case 200:k(200,"OK");break;case 202:k(202,"Accepted");break;case 308:g=k(308,"Permanent Redirect");break;case 400:g=k(400,"Bad Request");break;case 403:g=k(403,"Forbidden");break;case 404:g=k(404,"Not Found");break;case 408:g=k(408,"Request Timeout");break;case 429:g=k(429,"Too Many Requests");break;case 500:g=k(500,"Internal Server Error");break;case 502:g=k(502,"Bad Gateway");break;case 503:g=k(503,"Service Unavailable");break;case 511:g=k(511,"Network Authentication Required");
break;default:g=k(a.code,"Invalid response returned from server")}b(g,null)}else{g=null;try{var q=null;if(null==c)throw k(500,"Invalid response returned from server");try{q=JSON.parse(c)}catch(h){throw d.error("failed to parse voucher response."),k(500,"Invalid response returned from server");}if(void 0===q||null===q||q.constructor!=Object)throw d.error("Invalid type when parsing voucher response."),k(500,"Invalid response returned from server");if(q.hasOwnProperty("error")){var n=q.error;throw k(n.code,
n.message);}if(!q.hasOwnProperty("data"))throw d.error("No data or error object when parsing voucher response."),k(500,"Invalid response returned from server");var z=q.data,g=z.hasOwnProperty("voucher_id")?"string"!==typeof z.voucher_id?null:z.voucher_id:null}catch(m){b(m,null);return}b(null,g)}},null!==m.UNIT_TEST&&void 0!==m.UNIT_TEST?l(c,voucherCallback,m.UNIT_TEST_FLAG):p(c,voucherCallback)):b(k(400,"Missing required parameters, Bad Request."),null)};var c=["sdk/v1/http","sdk/v1/logger"];window.JSON||
c.push("sdk/v1/json2");InFlight.define("advertising/v1",c,function(c,b,a){g=c;d=b.createLogger("advertising/v1","api");a&&(JSON=a);return m})})();
(function(){var l=null,p=window.JSON,k={},h=[],m=null,g=[],d=function(a,b){h.push({key:a,callback:b});null===m&&(m=setTimeout(function(){c(function(a,b){if(a)InFlight.console.log(a.code+" error: "+a.text);else{for(var c=0;c<b.length;c++)h[c].callback(b[c]);h=[];m=null}})},0))},c=function(a){for(var b={},c=[],d=[],t=0;t<h.length;++t)if(d.push(h[t].key.icao_code),0===t%169&&0!==t||t===h.length-1)c.push(d.join(",")),d=[];for(var n=0,t=0;t<c.length;t++)b.icao_codes=c[t],q(t,b,function(){n++;if(n===c.length){for(var b=
[],d=0;d<g.length;d++)b=b.concat(g[d]);g=[];a(null,b)}})},q=function(a,b,c){l.get({url:InFlight.makeServiceURL("/airport_info/v1/multi_airport_info?icao_codes="+b.icao_codes+"&"),headers:{Accept:"application/json"}},function(b,d){if(null!==b)c(b,null);else if(d.code&&200!==d.code)c({code:d.code,text:""},null);else{try{var n=p.parse(d.body)}catch(q){c({code:500,text:""},null);return}g[a]=n;c()}})};k.cityNameByICAO=function(a,b){var c;a&&a.icao_code?a&&a.lang?(a.icao_code=a.icao_code.toLowerCase(),
c=a.lang.toLowerCase(),d(a,function(d){if(404===d.response_code)b({code:404,text:""},null);else if("undefined"===typeof d.body.city)b({code:4042,text:""},null);else{var g="";if(d.body.city.hasOwnProperty(c))g=d.body.city[c];else if(d.body.city.en)InFlight.console.log('airport_info/v1: Language "'+c+'" not found in ICAO "'+a.icao_code+'", defaulting to English.'),g=d.body.city.en;else{b({code:4041,text:""},null);return}b(null,g)}})):b({code:400,text:""}):b({code:400,text:""})};k.countryCodeByICAO=
function(a,b){a&&a.icao_code?(a.icao_code=a.icao_code.toLowerCase(),d(a,function(a){404===a.response_code?b({code:404,text:""},null):"undefined"===typeof a.body.country?b({code:4042,text:""},null):b(null,a.body.country)})):b({code:400,text:""})};var b=["sdk/v1/http"];window.JSON||b.push("sdk/v1/json2");InFlight.define("airport_info/v1",b,function(a,b){l=a;b&&(p=b);return k})})();
InFlight.define("analytics/v1","sdk/v1/http flightdata/v2 sdk/v1/devicestorage sdk/v1/pagevisibilitydispatcher system/v1 sdk/v1/logger".split(" "),function(l,p,k,h,m,g){var d=g.createLogger("analytics/v1","api"),c=null,q=null,b=null,a=null;g={};var w=!1,x=!1,v=[],t=null,n=function(){if(b&&null!==c&&null!==q)switch(b){case h.PAGE_LOAD:d.debug("page has been loaded, push logs");C(!0);break;case h.PAGE_UNLOAD:C(!1)}},z=function(e){k.setData("inflight.analytics.v1.currentLanguage",e)},y=function(){return k.getData("inflight.analytics.v1.currentLanguage")},
u=function(){var e=q;d.debug("reset screen start time to now ["+e+"]");k.setData("inflight.analytics.v1.screenChangeTime",e)};u();m.addEventListener(m.NET_STATE_CHANGE,function(e){a=e.online;d.debug("network connection is  ["+a+"]");n()});p.flightId(function(e,a){null!==e?InFlight.console.warn("analytics/v1: error while fetching flight id.",e):(c=a,d.debug("flight id is  ["+a+"]"),n())});p.currentDateTimeUTC(function(e,a){null!==e?InFlight.console.warn("analytics/v1: error while fetching ServerTime.",
e):(q=(new Date(a.raw)).getTime(),setInterval(function(){q+=1E3},1E3),d.debug("ServerTime is  ["+q+"]"),n())});h.addEventListener(h.PAGE_LOAD,function(e){b=e.type;d.debug("page visibility event ["+e.type+"]");n()});h.addEventListener(h.PAGE_UNLOAD,function(e){b=e.type;d.debug("page visibility event ["+e.type+"]");C(!1)});h.addEventListener(h.PAGE_VISIBLE,function(e){d.debug("page visibility event ["+e.type+"]");e=t;var a=(new Date).getTime();v.push({start:e,end:a});d.debug("added page hidden time span of ["+
Math.floor((a-e)/1E3)+"] seconds")});h.addEventListener(h.PAGE_HIDDEN,function(e){d.debug("page visibility event ["+e.type+"]");t=(new Date).getTime()});g.screenChange=function(e,a){if(!e||!e.screen||e.language&&"string"!==typeof e.language||e.previous_screen&&"string"!==typeof e.previous_screen||e.category&&"string"!==typeof e.category||e.dynamic_content&&"string"!==typeof e.dynamic_content)a({code:400,text:""});else{var b=null,n=null,g=null;void 0!==e.category&&null!==e.category&&(b=e.category);
void 0!==e.dynamic_content&&null!==e.dynamic_content&&(n=e.dynamic_content);void 0!==e.language&&null!==e.language&&z(e.language);var g=void 0!==e.previous_screen&&null!==e.previous_screen?e.previous_screen:k.getData("inflight.analytics.v1.currentScreen"),h;var x=q;h=parseInt(k.getData("inflight.analytics.v1.screenChangeTime"));d.debug("then ["+h+"], now ["+x+"]");var x=Math.ceil((x-h)/1E3),t=0;d.debug("screen visit duration ["+x+"] seconds");if(isNaN(h))h=null;else{if(0<v.length){for(h=0;h<v.length;h++)t+=
v[h].end-v[h].start;x-=Math.floor(t/1E3);v.length=0;d.debug("screen visit duration ["+x+"] seconds after page hidden time spans are removed")}h=x}u();b={flightId:c,type:"screen_change",data:{current_screen:g,requested_screen:e.screen,screen_category:b,screen_content:n,screen_language_code:y(),current_screen_duration:h}};F(b);k.setData("inflight.analytics.v1.currentScreen",e.screen);a(null,null)}};g.languageChange=function(e,a){if(e&&e.language){var b=e.language,n=y();z(b);F({flightId:c,type:"language_change",
data:{current_language:n,requested_language:b}});a(null,null)}else a({code:400,text:""})};g.appStart=function(e,a){e&&e.app_name?(F({flightId:c,type:"application_state",data:{app_name:e.app_name,state:"start"}}),a(null,null)):a({code:400,text:""})};g.appStop=function(e,a){e&&e.app_name?(F({flightId:c,type:"application_state",data:{app_name:e.app_name,state:"stop"}}),a(null,null)):a({code:400,text:""})};g.gameStart=function(e,a){e&&e.game_name?(F({flightId:c,type:"game_state",data:{game_name:e.game_name,
state:"start"}}),a(null,null)):a({code:400,text:""})};g.gameStop=function(e,a){e&&e.game_name?(F({flightId:c,type:"game_state",data:{game_name:e.game_name,state:"stop"}}),a(null,null)):a({code:400,text:""})};var C=function(e){if(a){var b=!1;x=!0;var n=JSON.parse(k.getData("inflight.analytics.v1.logQueue")||"[]");k.deleteData("inflight.analytics.v1.logQueue");if(!0===e){var g=[];for(e=0;e<n.length;e++)n[e].flightId===c&&g.push(n[e]);n=g}else!1===e&&(b=!0);if(0<n.length){d.debug("send logs to server");
for(e=0;e<n.length;e++)delete n[e].flightId;n={client_timestamp:Math.round(q/1E3),logs:JSON.stringify(n)};l.post({url:InFlight.makeServiceURL("/analytics/v1/log"),data:n,synchronous:b},function(e,a){x=!1;if(e)d.error("500: Analytics Log Error");else try{JSON.parse(a.body)}catch(r){d.error("500: Analytics Log Error parsing JSON: "+r.toString())}})}}},F=function(a){a.timestamp=Math.round(q/1E3);var b=JSON.parse(k.getData("inflight.analytics.v1.logQueue")||"[]");b.push(a);a=b.length;k.setData("inflight.analytics.v1.logQueue",
JSON.stringify(b));w||e();5<=a&&!x&&C()},e=function(){w=setTimeout(function(){w=!1;d.debug("timer expired");C()},1E4)};return g});
(function(){var l,p={sendMessage:function(h,k){void 0===k&&(k=null);return h?"ifapi."===h.substring(0,6)?{code:401,text:""}:l.callMethod("ifapi.portal.notification",{message:h,value:k}):{code:400,text:""}},portalVersion:function(h){return h?l.callMethod("ifapi.portal.notification",{message:"ifapi.portal.version",value:h}):{code:400,text:""}},exitPortal:function(){return l.callMethod("ifapi.portal.notification",{message:"ifapi.portal.exit"})},getBridgeType:function(){return l.getBridgeType()}},k=["sdk/v1/app_bridge"];
window.JSON||k.push("sdk/v1/json2");InFlight.define("app_bridge/v1",k,function(h){l=h;p.BridgeType=l.BridgeTypes;return p})})();
(function(){var l=null,p=window.JSON,k=null,h={},m="https:"==window.location.protocol;h.appLog=function(d,c){var g={url:InFlight.makeServiceURL("/analytics/v1/applog",m),data:p.stringify(d),headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}};k.trace("request: ",d);l.postJSON(g,function(b,a){b?c({code:b.code,text:""},null):a.body.error?c({code:a.body.error.code,text:a.body.error.message},null):200!=a.code?a.body.error?c({code:a.body.error.code,text:a.body.error.message},null):
c({code:a.code,text:""},null):c(null,a.body.data)})};var g=["sdk/v1/http","sdk/v1/event","sdk/v1/logger"];p||g.push("sdk/v1/json2");InFlight.define("app_log/v1",g,function(d,c,g,b){l=d;k=g.createLogger("app_log/v1","api");b&&(p=b);return h})})();
(function(){var l,p,k={newChallenge:function(h){l.post({url:InFlight.makeServiceURL("/captcha/v1/new_challenge")},function(k,g){if(k)h(k,null);else try{var d=p.parse(g.body);d.image_url=d.image_url;h(null,d)}catch(c){h({code:500,text:""})}})},solveChallenge:function(h,k){var g=h.challenge_id||"",d=h.solution||"";l.post({url:InFlight.makeServiceURL("/captcha/v1/solution"),data:{challenge_id:g,solution:d}},function(c,d){if(c)k(c,null);else switch(d.code){case 200:k(null,!0);break;case 401:k(null,!1);
break;case 403:try{var b=p.parse(d.body)}catch(a){k({code:500,text:""});break}k({code:403,retry_in:b.retry_in,text:""},null);break;case 410:k({code:410,text:""},null);break;default:k({code:500,text:""},null)}})}};InFlight.define("captcha/v1",["sdk/v1/http","sdk/v1/json2"],function(h,m){l=h;p=window.JSON||m;return k})})();
InFlight.define("catalogs/v1",["sdk/v1/http","sdk/v1/json2"],function(l,p){function k(g){l.get(g.urlArgs,function(d,c){var q=null;if(d||200!==c.code)g.callback({code:500,text:""},null);else{try{q=h.parse(c.body)}catch(b){q=null,g.callback({code:500,text:""},null)}null!==q&&("object"===typeof q.error&&null!==q.error?g.callback({code:q.error.code,text:""},null):"object"===typeof q.data&&null!==q.data&&g.callback(null,q.data))}})}var h=window.JSON||p,m=function(g,d){this.id=g;this.serviceRoot=d};m.prototype.catalogs=
function(g,d){var c={},q={};g&&(g.seat_class&&(c["class"]=g.seat_class),g.lang&&(c.lang=g.lang));q.callback=d;q.urlArgs={url:InFlight.makeServiceURL("/"+this.serviceRoot+"/browse/v1/catalogs"),query:c};k.call(this,q)};m.prototype.categories=function(g,d){if(g.catalog_id){var c={},q={};c.catalog_id=g.catalog_id;g.lang&&(c.lang=g.lang);q.callback=d;q.urlArgs={url:InFlight.makeServiceURL("/"+this.serviceRoot+"/browse/v1/categories"),query:c};k.call(this,q)}else d({code:400,text:""})};m.prototype.categoryItems=
function(g,d){if(g.category_id){var c={},q={};c.category_id=g.category_id;g.lang&&(c.lang=g.lang);q.callback=d;q.urlArgs={url:InFlight.makeServiceURL("/"+this.serviceRoot+"/browse/v1/items"),query:c};k.call(this,q)}else d({code:400,text:""})};m.prototype.items=function(g,d){if(g.item_ids&&Array.isArray(g.item_ids)&&0!=g.item_ids.length){var c={},q={};c.item_ids=g.item_ids.join(",");g.lang&&(c.lang=g.lang);q.callback=d;q.urlArgs={url:InFlight.makeServiceURL("/"+this.serviceRoot+"/browse/v1/items"),
query:c};k.call(this,q)}else d({code:400,text:""})};return m});
(function(){var l,p,k,h,m={Events:{DATA_UPDATE:"data_update",DATA_CLEAR:"data_clear"},connectingGateInfo:function(g,d){var c=h.createLogger("connecting_gate/v1","connectingGateInfo"),q={url:InFlight.makeServiceURL("/connecting_gate/v1/connecting_gate_info"),query:g};c.trace("request: "+k.stringify(g));p.getJSON(q,function(b,a){c.trace("response error: "+k.stringify(b));c.trace("response data: "+k.stringify(a));null!==b?d(b,null):200!==a.code?d({code:a.code,text:""},null):void 0!==a.body.error?d({code:a.body.error.code,
text:""},null):d(null,a.body.data)})},addEventListener:function(g,d){l.register({event_name:g,namespace:"core.connecting_gate",callback:function(c){d({type:"core.connecting_gate"+g,data:c.data})}})}};InFlight.define("connecting_gate/v1",["sdk/v1/event","sdk/v1/http","sdk/v1/json2","sdk/v1/logger"],function(g,d,c,q){l=g;p=d;k=void 0!==window.JSON?window.JSON:c;h=q;return m})})();
(function(){var l,p,k,h=[],m=!1,g=function(a,b){h.push([a,b]);m||(m=!0,p.get({url:InFlight.makeServiceURL("/exconnect/v1/status")},function(a,b){var c,d,g;if(!a)try{g=k.parse(b.body)}catch(q){}for(var x=0;x<h.length;x++){d=h[x][0];var w=h[x][1];g&&"undefined"===typeof g[d]?(c={code:404,text:""},d=null):(c=null,d=g[d]);w(c,d)}m=!1;h.pop()}))},d=function(b){var c=null;g("global_conn_enabled",function(d,g){g!==c&&(b({event:a.Events.GLOBAL_CONN_ENABLED_CHANGE,global_conn_enabled:g}),c=g)});l.register({namespace:"core.exconnect",
event_name:"global_conn_enabled_change",callback:function(d){d="1"===d.argv[0];d!==c&&(b({event:a.Events.GLOBAL_CONN_ENABLED_CHANGE,global_conn_enabled:d}),c=d)}})},c=function(b){var c=null;g("total_coverage_remaining",function(d,g){g!==c&&(b({event:a.Events.TOTAL_COVERAGE_REMAINING_CHANGE,total_coverage_remaining:g}),c=g)});l.register({namespace:"core.exconnect",event_name:"total_coverage_remaining_change",callback:function(d){d=parseInt(d.argv[0],10);d!==c&&(b({event:a.Events.TOTAL_COVERAGE_REMAINING_CHANGE,
total_coverage_remaining:d}),c=d)}})},q=function(b){var c=null;g("time_until_coverage_change",function(d,g){g!==c&&(b({event:a.Events.TIME_UNTIL_COVERAGE_CHANGE_CHANGE,time_until_coverage_change:g}),c=g)});l.register({namespace:"core.exconnect",event_name:"time_until_coverage_change_change",callback:function(d){d=parseInt(d.argv[0],10);d!==c&&(b({event:a.Events.TIME_UNTIL_COVERAGE_CHANGE_CHANGE,time_until_coverage_change:d}),c=d)}})},b=function(b){var c=null;g("internet_connectivity_status",function(d,
g){g!==c&&(b({event:a.Events.INTERNET_CONNECTIVITY_STATUS_CHANGE,internet_connectivity_status:g}),c=g)});l.register({namespace:"core.exconnect",event_name:"internet_connectivity_status_change",callback:function(d){d="1"===d.argv[0];d!==c&&(b({event:a.Events.INTERNET_CONNECTIVITY_STATUS_CHANGE,internet_connectivity_status:d}),c=d)}})},a={Events:{GLOBAL_CONN_ENABLED_CHANGE:"core.exconnect.global_conn_enabled_change",TOTAL_COVERAGE_REMAINING_CHANGE:"core.exconnect.total_coverage_remaining_change",TIME_UNTIL_COVERAGE_CHANGE_CHANGE:"core.exconnect.time_until_coverage_change_change",
INTERNET_CONNECTIVITY_STATUS_CHANGE:"core.exconnect.internet_connectivity_status_change"},enableDeviceForWhitelist:function(a){p.post({url:InFlight.makeServiceURL("/exconnect/v1/enable_device_for_whitelist")},function(b,c){if(b)a(b);else if(200!==c.code)try{var d=k.parse(c.body);a(d)}catch(n){a({code:500,text:""})}else a(null)})},enableDeviceForOnboardServices:function(a){p.post({url:InFlight.makeServiceURL("/exconnect/v1/enable_device_for_onboard_services")},function(b,c){if(b)a(b);else{if(c.body){var d=
k.parse(c.body);if(d&&d.error){a(d.error);return}if(d&&d.data){a(null);return}}a({code:500,text:"exconnect/v1: unknown error"})}})},checkCAPTCHARequirement:function(a,b){p.get({url:InFlight.makeServiceURL("/exconnect/v1/check_captcha_requirement"),query:{url:a}},function(a,c){if(a)b(a,null);else{var n;try{n=k.parse(c.body)}catch(d){b({code:500,text:""},null);return}if(200!==c.code)b(n,null);else switch(n.captcha_required){case "NOT_FOUND":b({code:404,text:""},null);break;case "YES":b(null,!0);break;
case "NO":b(null,!1);break;default:b({code:500,text:""},null)}}})},addEventListener:function(g,h){switch(g){case a.Events.GLOBAL_CONN_ENABLED_CHANGE:d(h);break;case a.Events.TIME_UNTIL_COVERAGE_CHANGE_CHANGE:q(h);break;case a.Events.TOTAL_COVERAGE_REMAINING_CHANGE:c(h);break;case a.Events.INTERNET_CONNECTIVITY_STATUS_CHANGE:b(h);break;default:throw Error("exconnect/v1: Unknown event name: '"+g+"'");}},getTimeUntilCoverageChange:function(a){g("time_until_coverage_change",function(b,c){b?a(b,null):
a(null,c)})},getTotalCoverageRemaining:function(a){g("total_coverage_remaining",function(b,c){b?a(b,null):a(null,c)})},getGlobalConnEnabled:function(a){g("global_conn_enabled",function(b,c){b?a(b,null):a(null,c)})}};InFlight.define("exconnect/v1",["sdk/v1/event","sdk/v1/http","sdk/v1/json2"],function(b,c,d){l=b;p=c;k=window.JSON||d;return a});a.getWISP=function(a,b){a&&a.lang?p.get({url:InFlight.makeServiceURL("/exconnect/v1/wisp"),query:a},function(a,c){if(a)b(a);else{var n;if(200!==c.code)try{n=
k.parse(c.body),b(n)}catch(d){b({code:500,text:""})}else{try{n=k.parse(c.body)}catch(g){b({code:500,text:""},null);return}b(null,n)}}}):b({code:400,text:""})};a.getWISPProductList=function(a,b){var c="";a.lang&&(c=a.lang);p.get({url:InFlight.makeServiceURL("/exconnect/v1/wisp_product_info"),query:{lang:c}},function(a,c){if(a||200!==c.code)b({code:c.code,text:""},null);else{var d;try{d=k.parse(c.body),d.error?b({code:d.error.code,text:""},null):d.data&&b(null,d.data)}catch(g){b({code:500,text:""},
null)}}})};a.getDeviceState=function(a){p.get({url:InFlight.makeServiceURL("/exconnect/v1/device_state")},function(b,c){if(b)a(b);else{var d;if(200!==c.code)try{d=k.parse(c.body),a(d)}catch(n){a({code:500,text:""})}else{try{d=k.parse(c.body)}catch(g){a({code:500,text:"",response:c},null);return}a(null,d)}}})}})();(function(){InFlight.define("extv_metadata/v1",["extv/metadata/v1"],function(l){return l})})();
(function(){var l=null,p=null,k=null,h=window.JSON,m=null,g=null,d=null,c=!1,q=[],b={lat:null,lon:null},a=function(e,a){q.push({key:e,callback:a});c||(c=!0,l.getJSON({url:InFlight.makeServiceURL("/flightdata/v1/flightdata")},function(e,a){if(e)d=e;else{g=a.body;for(var b=0;b<q.length;b++){var r=g,n=q[b].key,h=q[b].callback;d?h(d,null):r.hasOwnProperty(n)?h(null,r[n]):h({code:400,text:""},null)}q=[];c=!1}}))},w=function(e,b){a(e,function(e,a){e?b(e,null):b(null,"1"===a)})},x=function(e,b){a(e,function(e,
a){if(e)return b(e,null);var c=parseInt(a.slice(1),10);isNaN(c)?b({code:500,text:""},null):("8"===a[0]&&(c*=-1),b(null,c))})},v=function(e,b){a(e,function(a,c){if(a)return b(a,null);var n=parseInt(c,10);e===u.TD_ID_X2_PA_STATE&&isNaN(n)&&(n=0);isNaN(n)?b({code:500,text:""},null):b(null,n)})},t=function(e,b){a(e,function(e,a){if(e)return b(e,null);""===a?b({code:500,text:""}):u.dateTimeUTC(function(e,c){if(e)return b(e,null);var d=n(a),g=new k(c.getTime());g.setTimezoneOffset(-1*d);b(null,g)})})},
n=function(e){var a=e.substr(1),b=parseFloat(a),a=Math.floor(b),b=Math.round(60*(b-a));return("8"===e.substring(0,1)?-1:1)*(60*a+b)},z=function(e,b,c){a(e,function(e,n){if(e)return c(e,null);a(b,function(e,a){if(e)return c(e,null);c(null,{lat:y(n),lon:y(a)})})})},y=function(e){var a=parseFloat(e.slice(1,5)),a=a+parseFloat(e.slice(5,7))/60,a=a+parseFloat(e.slice(7))/600;"8"===e[0]&&(a*=-1);return a},u={OPEN_FLIGHT:"open_flight",TD_ID_AIRFRAME_TAIL_NUMBER:"td_id_airframe_tail_number",TD_ID_DECOMPRESSION:"td_id_decompression",
TD_ID_FLIGHT_PHASE:"td_id_flight_phase",TD_ID_FLTDATA_ALTITUDE:"td_id_fltdata_altitude",TD_ID_FLTDATA_DATE:"td_id_fltdata_date",TD_ID_FLTDATA_DEPARTURE_BAGGAGE_ID:"td_id_fltdata_departure_baggage_id",TD_ID_FLTDATA_DEPARTURE_LATITUDE:"td_id_fltdata_departure_latitude",TD_ID_FLTDATA_DEPARTURE_LONGITUDE:"td_id_fltdata_departure_longitude",TD_ID_FLTDATA_DESTINATION_BAGGAGE_ID:"td_id_fltdata_destination_baggage_id",TD_ID_FLTDATA_DESTINATION_LATITUDE:"td_id_fltdata_destination_latitude",TD_ID_FLTDATA_DESTINATION_LONGITUDE:"td_id_fltdata_destination_longitude",
TD_ID_FLTDATA_DISTANCE_FROM_ORIGIN:"td_id_fltdata_distance_from_origin",TD_ID_FLTDATA_DISTANCE_TO_DESTINATION:"td_id_fltdata_distance_to_destination",TD_ID_FLTDATA_FLIGHT_NUMBER:"td_id_fltdata_flight_number",TD_ID_FLTDATA_GMT:"td_id_fltdata_gmt",TD_ID_FLTDATA_GROUND_SPEED:"td_id_fltdata_ground_speed",TD_ID_FLTDATA_HEAD_WIND_SPEED:"td_id_fltdata_head_wind_speed",TD_ID_FLTDATA_MACH:"td_id_fltdata_mach",TD_ID_FLTDATA_OUTSIDE_AIR_TEMP:"td_id_fltdata_outside_air_temp",TD_ID_FLTDATA_PRESENT_POSITION_LATITUDE:"td_id_fltdata_present_position_latitude",
TD_ID_FLTDATA_PRESENT_POSITION_LONGITUDE:"td_id_fltdata_present_position_longitude",TD_ID_FLTDATA_TIME_TO_DESTINATION:"td_id_fltdata_time_to_destination",TD_ID_FLTDATA_TRUE_HEADING:"td_id_fltdata_true_heading",TD_ID_FLTDATA_WIND_DIRECTION:"td_id_fltdata_wind_direction",TD_ID_FLTDATA_WIND_SPEED:"td_id_fltdata_wind_speed",TD_ID_GMT_OFFSET_DEPARTURE:"td_id_gmt_offset_departure",TD_ID_GMT_OFFSET_DESTINATION:"td_id_gmt_offset_destination",TD_ID_PDI_FLTDATA_DEPARTURE_IATA:"td_id_pdi_fltdata_departure_iata",
TD_ID_ROUTE_ID:"td_id_route_id",TD_ID_WEIGHT_ON_WHEELS:"td_id_weight_on_wheels",TD_ID_X2_PA_STATE:"td_id_x2_pa_state",TD_ID_ALL_DOORS_CLOSED:"td_id_all_doors_closed",TD_ID_FLTDATA_ESTIMATED_ARRIVAL_TIME:"td_id_fltdata_estimated_arrival_time",TD_ID_FLTDATA_TIME_AT_ORIGIN:"td_id_fltdata_time_at_origin",TD_ID_FLTDATA_TIME_AT_DESTINATION:"td_id_fltdata_time_at_destination",FlightPhase:{UNKNOWN:0,POWER_UP:1,ENGINES_START:2,TAKE_OFF_POWER:3,ACCELERATING:4,LIFT_OFF:5,CLIMB:6,CRUISING:7,DESCENDING:8,APPROACH:9,
GO_AROUND:10,FLARE:11,TOUCHDOWN:12,TAXI_TO_STOP:13,ENGINES_STOP:14,MAINTENANCE:15}},C={ALTITUDE_FEET:"altitude_feet",CURRENT_COORDINATES:"current_coordinates",DISTANCE_FROM_DEPARTURE_NAUTICAL_MILES:"distance_from_departure_nautical_miles",DISTANCE_TO_DESTINATION_NAUTICAL_MILES:"distance_to_destination_nautical_miles",GROUND_SPEED_KNOTS:"ground_speed_knots",FLIGHT_SPEED_MACH:"flight_speed_mach",TIME_TO_DESTINATION_MINUTES:"time_to_destination_minutes",OUTSIDE_AIR_TEMP_CELSIUS:"outside_air_temp_celsius",
ALL_DOORS_CLOSED:"all_doors_closed",WEIGHT_ON_WHEELS:"weight_on_wheels",HEAD_WIND_SPEED:"head_wind_speed_knots"};u.Events=C;u.addEventListener=function(e,a){m.register({event_name:e,namespace:"core.flightdata",callback:function(c){e===C.CURRENT_COORDINATES?(c=h.parse("{"+c.argv[0]+"}"),b.lat=c.current_coordinates.latitude,b.lon=c.current_coordinates.longitude,a({type:"core.flightdata."+e,data:b})):a({type:"core.flightdata."+e,data:c.argv[0]})}})};u.altitude=function(e){x("td_id_fltdata_altitude",
e)};u.currentCoordinates=function(e){z("td_id_fltdata_present_position_latitude","td_id_fltdata_present_position_longitude",e)};u.dateTimeUTC=function(e){a("td_id_fltdata_gmt",function(b,c){if(b)return e(b,null);""===c?e({code:500,text:""}):a("td_id_fltdata_date",function(a,b){if(a)return e(a,null);if(""===b)e({code:500,text:""});else{var r=parseInt(b.slice(6,8),10)+2E3,n=parseInt(b.slice(4,6),10)-1,d=parseInt(b.slice(2,4),10),g=parseInt(c.slice(0,2),10),q=parseInt(c.slice(2,4),10),h=new k;h.setUTCFullYear(r,
n,d);h.setUTCHours(g,q,0);e(null,h)}})})};u.decompressionState=function(e){w("td_id_decompression",e)};u.destinationCoordinates=function(e){z("td_id_fltdata_destination_latitude","td_id_fltdata_destination_longitude",e)};u.destinationIATA=function(e){a("td_id_fltdata_destination_baggage_id",e)};u.destinationICAO=function(e){a("td_id_fltdata_destination_id",e)};u.distanceToDestination=function(e){v("td_id_fltdata_distance_to_destination",e)};u.distanceToOrigin=function(e){v("td_id_fltdata_distance_from_origin",
e)};u.flightNumber=function(e){a("td_id_fltdata_flight_number",e)};u.flightPhase=function(e){a("td_id_flight_phase",function(a,b){if(a)return e(a,null);""===b?e(a,u.FlightPhase.UNKNOWN):e(a,parseInt(b,10))})};u.groundSpeed=function(e){x("td_id_fltdata_ground_speed",e)};u.headWindSpeed=function(e){x("td_id_fltdata_head_wind_speed",e)};u.machNumber=function(e){v("td_id_fltdata_mach",function(a,b){if(a)return e(a,null);e(null,b/1E3)})};u.headingAngleTrue=function(e){v("td_id_fltdata_true_heading",e)};
u.originIATA=function(e){a("td_id_fltdata_departure_baggage_id",e)};u.originICAO=function(e){a("td_id_fltdata_departure_id",e)};u.originCoordinates=function(e){z("td_id_fltdata_departure_latitude","td_id_fltdata_departure_longitude",e)};u.outsideAirTemperature=function(e){x("td_id_fltdata_outside_air_temp",e)};u.paState=function(e){v("td_id_x2_pa_state",e)};u.routeID=function(e){v("td_id_route_id")};u.scheduledDepartureTime=function(e){a("td_id_pdi_fltdata_departure_time_scheduled",function(b,c){b?
e(b,null):c?a("td_id_gmt_offset_departure",function(a,b){if(a)e(a,null);else{b||e({code:503,text:""},null);var r=c.split(" "),d=r[0].split("-"),g=r[1].split(":"),r=parseInt(d[0],10),q=parseInt(d[1],10),d=parseInt(d[2],10),h=parseInt(g[0],10),z=parseInt(g[1],10),g=parseInt(g[2],10);--q;-1===q&&(q=11);var u=new k;u.setUTCFullYear(r,q,d);u.setUTCHours(h,z,g);u.setTimezoneOffset(-1*n(b));e(null,u)}}):e({code:503,text:""},null)})};u.tailNumber=function(e){a("td_id_airframe_tail_number",e)};u.timeAtOrigin=
function(e){t("td_id_gmt_offset_departure",e)};u.timeAtDestination=function(e){t("td_id_gmt_offset_destination",e)};u.timeToDestination=function(e){v("td_id_fltdata_time_to_destination",e)};u.waypoints=function(e,a){"function"===typeof e&&(a=e);var b=e.numPoints?e.numPoints:32;2>b&&(b=2);64<b&&(b=64);u.originCoordinates(function(e,c){if(e)return a(e,null);u.destinationCoordinates(function(e,n){if(e)return a(e,null);var d=p.greatCircleWaypoints(c,n,b-1);a(null,d)})})};u.weightOnWheels=function(e){w("td_id_weight_on_wheels",
e)};u.windDirectionTrue=function(e){v("td_id_fltdata_wind_direction",e)};u.windSpeed=function(e){v("td_id_fltdata_wind_speed",e)};u.doorsClosed=function(e){a("td_id_all_doors_closed",e)};u.estimatedArrivalTime=function(e){a("td_id_fltdata_estimated_arrival_time",e)};u.timeAtOriginWithDST=function(e){a("td_id_fltdata_time_at_origin",e)};u.timeAtDestinationWithDST=function(e){a("td_id_fltdata_time_at_destination",e)};var F=["sdk/v1/http","sdk/v1/event","sdk/v1/geo","sdk/v1/localdate"];h||F.push("sdk/v1/json2");
InFlight.define("flightdata/v1",F,function(e,a,b,c,n){l=e;p=b;k=c;n&&(h=n);m=a;return u})})();
(function(){var l=null,p=window.JSON,k=null,h=null,m=null,g=null,d=null,c=null,q=!1,b=[],a=function(a,e){b.push({key:a,callback:e});g.debug("Request - "+a);q||(q=!0,l.getJSON({url:InFlight.makeServiceURL("/flightdata/v2/flightdata")},function(e,a){if(e)c=e;else{d=a.body;for(var n=0;n<b.length;n++){var h=c,z=d,k=b[n].key,u=b[n].callback;h?u(h,null):z.hasOwnProperty(k)?(g.debug(z[k]),u(null,z[k])):(h="Missing key ("+k+") in Flight Data object",u({code:400,text:h},null),g.error("Missing key ("+k+") in Flight Data object"))}b=
[];q=!1}}))},w=function(b,e){a(b,function(a,c){if(a)return e(a,null);if(null===c)e(null,null);else{var n=parseInt(c,10);isNaN(n)?e({code:500,text:"Invalid Flight Data integer value for label '"+b+"': '"+c+"'"},null):e(null,n)}})},x=function(b,e){a(b,function(a,c){if(a)return e(a,null);if(null===c)e(null,null);else{var n=parseFloat(c);isNaN(n)?e({code:500,text:"Invalid Flight Data float value for label '"+b+"': '"+c+"'"},null):e(null,n)}})},v=function(b,e){a(b,function(a,c){if(a)return e(a,null);null!==
c&&"string"!==typeof c?e({code:500,text:"Invalid string Flight Data for label '"+b+"': '"+c+"'"},null):e(null,c)})},t=function(b,e){a(b,function(a,c){if(a)return e(a,null);null!==c&&"object"!==typeof c?e({code:500,text:"Invalid Object Flight Data for label '"+b+"': '"+c+"'"},null):(c=new m(c.latitude,c.longitude),e(null,c))})},n=function(b,e){a(b,function(a,c){if(a)return e(a,null);if(null===c)e(null,null);else{var n;(n=h.createTime(c))?e(null,n):e({code:500,text:"Invalid time string Flight Data for label '"+
b+"': '"+c+"'"},null)}})},z=function(b,e,c){a(b,function(n,d){if(n)return c(n,null);a(e,function(a,n){if(a)return c(a,null);if(null===d&&null===n)c(null,null);else{var g;(g=h.createDateTime(d+"T"+n))?c(null,g):c({code:500,text:"Invalid Flight Data date string for label '"+b+"' & '"+e+"': '"+d+"' '"+n+"'"},null)}})})},y=function(b,e){a(b,function(a,c){if(a)return e(a,null);if(null===c)e(null,null);else{var n;(n=h.createDateTime(c))?e(null,n):e({code:500,text:"Invalid Flight Data date string for label '"+
b+"': '"+c+"'"},null)}})},u={FlightPhase:{UNKNOWN:0,POWER_UP:1,ENGINES_START:2,TAKE_OFF_POWER:3,ACCELERATING:4,LIFT_OFF:5,CLIMB:6,CRUISING:7,DESCENDING:8,APPROACH:9,GO_AROUND:10,FLARE:11,TOUCHDOWN:12,TAXI_TO_STOP:13,ENGINES_STOP:14,MAINTENANCE:15},Events:{ALTITUDE_FEET:"altitude_feet",CURRENT_COORDINATES:"current_coordinates",DISTANCE_TRAVELED_NAUTICAL_MILES:"distance_traveled_nautical_miles",DISTANCE_FROM_DEPARTURE_NAUTICAL_MILES:"distance_from_departure_nautical_miles",DISTANCE_TO_DESTINATION_NAUTICAL_MILES:"distance_to_destination_nautical_miles",
GROUND_SPEED_KNOTS:"ground_speed_knots",FLIGHT_SPEED_MACH:"flight_speed_mach",TIME_TO_DESTINATION_MINUTES:"time_to_destination_minutes",OUTSIDE_AIR_TEMP_CELSIUS:"outside_air_temp_celsius",ALL_DOORS_CLOSED:"all_doors_state",WEIGHT_ON_WHEELS:"weight_on_wheels_state",WIND_SPEED:"wind_speed_knots",HEAD_WIND_SPEED:"head_wind_speed_knots",TRUE_HEADING:"true_heading_degree",DISTANCE_COVERED_PERCENTAGE:"distance_covered_percentage",FLIGHT_ID:"flight_id",AIRCRAFT_TYPE:"aircraft_type",DESTINATION_IATA:"destination_iata",
DEPARTURE_IATA:"departure_iata",DESTINATION_ICAO:"destination_icao",DEPARTURE_ICAO:"departure_icao"},addEventListener:function(a,e){k.register({event_name:a,namespace:"core.flightdata",callback:function(b){a===u.Events.CURRENT_COORDINATES?(b=p.parse("{"+b.argv[0]+"}"),b=new m(b.current_coordinates.latitude,b.current_coordinates.longitude)):b=a===u.Events.WEIGHT_ON_WHEELS?"ground"===b.argv[0]?!0:"air"===b.argv[0]?!1:null:a===u.Events.ALL_DOORS_CLOSED?"close"===b.argv[0]?!0:"open"===b.argv[0]?!1:null:
b.argv[0];e({type:"core.flightdata."+a,data:b})}})},altitude:function(a){w("altitude_feet",a)},currentCoordinates:function(a){t("current_coordinates",a)},currentDateTimeUTC:function(a){z("current_utc_date","current_utc_time",a)},destinationCoordinates:function(a){t("destination_coordinates",a)},destinationIATA:function(a){v("destination_iata",a)},destinationICAO:function(a){v("destination_icao",a)},distanceTraveled:function(a){w("distance_traveled_nautical_miles",a)},distanceToDestination:function(a){w("distance_to_destination_nautical_miles",
a)},distanceToOrigin:function(a){w("distance_from_departure_nautical_miles",a)},flightNumber:function(a){v("flight_number",a)},flightId:function(a){v("flight_id",a)},aircraftType:function(a){v("aircraft_type",a)},flightPhase:function(a){v("flight_phase",function(e,b){if(e)return a(e,null);null===b||""===b?a(e,u.FlightPhase.UNKNOWN):a(e,b)})},groundSpeed:function(a){w("ground_speed_knots",a)},headWindSpeed:function(a){w("head_wind_speed_knots",a)},machSpeed:function(a){x("flight_speed_mach",a)},trueHeading:function(a){w("true_heading_degree",
a)},originIATA:function(a){v("departure_iata",a)},originICAO:function(a){v("departure_icao",a)},originCoordinates:function(a){t("departure_coordinates",a)},outsideAirTemperature:function(a){w("outside_air_temp_celsius",a)},tailNumber:function(a){v("tail_number",a)},timeToDestination:function(a){w("time_to_destination_minutes",a)},weightOnWheels:function(a){v("weight_on_wheels_state",function(e,b){e&&a(e,null);"ground"===b?a(null,!0):"air"===b?a(null,!1):a(null,null)})},windDirection:function(a){w("wind_direction_degree",
a)},windSpeed:function(a){w("wind_speed_knots",a)},doorsClosed:function(a){v("all_doors_state",function(e,b){e&&a(e,null);"close"===b?a(null,!0):"open"===b?a(null,!1):a(null,null)})},flightState:function(a){v("flight_state",function(e,b){e&&a(e,null);"close"===b?a(null,!1):"open"===b?a(null,!0):a(null,null)})},estimatedArrivalTime:function(a){n("estimated_arrival_time_utc",a)},takeOffDateTime:function(a){y("takeoff_time_utc",a)},timeAtOrigin:function(a){n("time_at_origin",a)},timeAtDestination:function(a){n("time_at_destination",
a)},percentageComplete:function(a){w("distance_covered_percentage",a)}},C=["sdk/v1/http","sdk/v1/event","sdk/v1/logger","sdk/v1/datefactory","sdk/v1/coordinates"];p||C.push("sdk/v1/json2");InFlight.define("flightdata/v2",C,function(a,e,b,c,n,d){l=a;k=e;g=b.createLogger("flightdata/v2","api");h=c;m=n;d&&(p=d);return u})})();
(function(){var l=null,p=null,k=window.JSON,h={cache:{},Events:{UPDATE:"update"},FeedTypes:{CUSTOM:"custom",RSS:"rss"},Condition:{UNKNOWN:0,NO_REPORT:1,SUNNY:1001,CLEAR:1002,MOSTLY_SUNNY:1003,MOSTLY_CLEAR:1004,MORE_SUN_THAN_CLOUDS:1005,PARTLY_SUNNY:1006,BREAKS_OF_SUN_LATE:1007,HAZY_SUNSHINE:2001,HAZE:2002,LOW_LEVEL_HAZE:2003,PASSING_CLOUDS:3001,SCATTERED_CLOUDS:3002,PARTLY_CLOUDY:3003,A_MIXTURE_OF_SUN_AND_CLOUDS:3004,HIGH_LEVEL_CLOUDS:3005,MORE_CLOUDS_THAN_SUN:3006,BROKEN_CLOUDS:3007,MOSTLY_CLOUDY:3008,
CLOUDY:3009,OVERCAST:3010,LOW_CLOUDS:3011,INCREASING_CLOUDINESS:3012,DECREASING_CLOUDINESS:3013,CLEARING_SKIES:3014,AFTERNOON_CLOUDS:3015,MORNING_CLOUDS:3016,LIGHT_FOG:4001,FOG:4002,DENSE_FOG:4003,ICE_FOG:4004,EARLY_FOG_FOLLOWED_BY_SUNNY_SKY:4005,SANDSTORM:5001,DUSTSTORM:5002,SMOKE:6001,DRIZZLE:7001,SPRINKLES:7002,SCATTERED_SHOWERS:7003,A_FEW_SHOWERS:7004,LIGHT_SHOWERS:7005,PASSING_SHOWERS:7006,NUMEROUS_SHOWERS:7007,SHOWERY:7008,LIGHT_FREEZING_RAIN:7009,SPRINKLES_EARLY:7010,SHOWERS_EARLY:7011,LIGHT_RAIN_EARLY:7012,
SPRINKLES_LATE:7013,SHOWERS_LATE:7014,LIGHT_RAIN_LATE:7015,LIGHT_RAIN:7016,RAIN_SHOWERS:8001,RAIN:8002,HEAVY_RAIN:8003,LOTS_OF_RAIN:8004,TONS_OF_RAIN:8005,LIGHT_MIXTURE_OF_PRECIP:8006,MIXTURE_OF_PRECIP:8007,HEAVY_MIXTURE_OF_PRECIP:8008,RAIN_EARLY:8009,HEAVY_RAIN_EARLY:8010,RAIN_LATE:8011,HEAVY_RAIN_LATE:8012,FLASH_FLOODS:9001,WIDELY_SCATTERED_THUNDERSTORMS:10001,ISOLATED_THUNDERSTORMS:10002,A_FEW_THUNDERSTORMS:10003,THUNDERSHOWERS:10004,THUNDERSTORMS:10005,STRONG_THUNDERSTORMS:10006,SEVERE_THUNDERSTORMS:10007,
TROPICAL_STORM:10008,THUNDERSTORMS_EARLY:10009,ISOLATED_THUNDERSTORMS_LATE:10010,SCATTERED_THUNDERSTORMS_LATE:10011,THUNDERSTORMS_LATE:10012,ICY_MIX:11001,SNOW_CHANGING_TO_AN_ICY_MIX:11002,AN_ICY_MIX_CHANGING_TO_SNOW:11003,AN_ICY_MIX_CHANGING_TO_RAIN:11004,RAIN_CHANGING_TO_AN_ICY_MIX:11005,LIGHT_ICY_MIX_EARLY:11006,ICY_MIX_EARLY:11007,ICY_MIX_LATE:11008,FREEZING_RAIN:12001,SNOW_CHANGING_TO_RAIN:12002,RAIN_CHANGING_TO_SNOW:12003,LIGHT_SNOW_SHOWERS:12004,SNOW_SHOWERS:12005,LIGHT_SNOW:12006,SNOW:12007,
MODERATE_SNOW:12008,HEAVY_SNOW:12009,SNOWSTORM:12010,SNOW_SHOWERS_EARLY:12011,LIGHT_SNOW_EARLY:12012,SNOW_EARLY:12013,HEAVY_SNOW_EARLY:12014,SNOW_SHOWERS_LATE:12015,LIGHT_SNOW_LATE:12016,SNOW_LATE:12017,HEAVY_SNOW_LATE:12018,LIGHT_ICY_MIX_LATE:12019,SCATTERED_FLURRIES:13001,SNOW_FLURRIES:13002,FLURRIES_EARLY:13003,FLURRIES_LATE:13004,HAIL:14001,TORNADO:15001,HURRICANE:16001,SLEET:17001,BLIZZARD:18001},Icon:{NO_REPORT:"",SUNNY:"icon_weather_sunny.png",HAZE:"icon_weather_haze.png",CLOUDS:"icon_weather_clouds.png",
FOG:"icon_weather_fog.png",DUST:"icon_weather_dust.png",SMOKE:"icon_weather_smoke.png",LIGHT_RAIN:"icon_weather_lightrain.png",RAIN:"icon_weather_rain.png",FLOOD:"icon_weather_flood.png",THUNDERSTORM:"icon_weather_tstorm.png",ICY:"icon_weather_icy.png",SNOW:"icon_weather_snow.png",FLURRIES:"icon_weather_flurries.png",HAIL:"icon_weather_hail.png",TORNADO:"icon_weather_tornado.png",HURRICANE:"icon_weather_hurricane.png",SLEET:"icon_weather_sleet.png",BLIZZARD:"icon_weather_blizzard.png"}},m=function(c,
b){for(var a={},d=c.length,g=0;g<d;g++){var h=c[g];h.sequence_num=g+1;a[h[b]]=h}return a},g=function(c){var b=function(){c();setTimeout(b,9E5)};setTimeout(b,9E5);p.register({event_name:"td_id_ltn_last_update_time",namespace:"core.flightdata",callback:function(a){c({event:h.Events.UPDATE})}})};h.addEventListener=function(c,b){c===h.Events.UPDATE&&g(b)};h.providers=function(c){l.get({url:InFlight.makeServiceURL("/livetextnews/v1/providers"),headers:{Accept:"application/json"}},function(b,a){d(b,a,c,
function(a){for(var b=a.length,c={langs:{}},d=0;d<b;d++){var n=a[d],g=n.lang;c.langs.hasOwnProperty(g)||(c.langs[g]={providers:{}});c.langs[g].providers[n.id]=n}return c})})};h.categories=function(c,b){l.get({url:InFlight.makeServiceURL("/livetextnews/v1/categories"),headers:{Accept:"application/json"},query:c},function(a,c){d(a,c,b,function(a){for(var b=0;b<a.length;b++){var c=a[b];if(InFlight.customHost)for(var n=0;n<c.articles.length;n++){var d=c.articles[n];d.image_url=d.image_url;d.url=d.url}c.articles=
m(c.articles,"id")}return m(a,"id")})})};h.article=function(c,b){l.get({url:InFlight.makeServiceURL("/livetextnews/v1/article"),headers:{Accept:"application/json"},query:c},function(a,c){d(a,c,b,function(a){if(InFlight.customHost){a.body=!0;for(var b=0;b<a.images.length;b++)a.images[b].url=a.images[b].url}return a})})};h.currentWeather=function(c){l.get({url:InFlight.makeServiceURL("/livetextnews/v1/current_weather"),headers:{Accept:"application/json"}},function(b,a){d(b,a,c,function(a){for(var b=
{regions:{}},c=a.length,d=0;d<c;d++){var n=a[d];b.regions.hasOwnProperty(n.region_id)||(b.regions[n.region_id]={name:n.region_name,cities:[]});n.forecast_weather_url=n.forecast_weather_url;b.regions[n.region_id].cities[n.icao_code]=n}return b})})};h.forecastWeather=function(c,b){var a=null,g=typeof c.days;if("undefined"!==g){if(""===c.days)a=null;else if("number"===g)a=c.days;else if(a=parseInt(c.days,10),isNaN(a))throw Error('livetextnews/v1: "days" argument must be a number, got: '+c.days);if("number"===
typeof a&&1>a)throw Error('livetextnews/v1: "days" argument must be > 0, got: '+a);}l.get({url:InFlight.makeServiceURL("/livetextnews/v1/forecast_weather"),headers:{Accept:"application/json"},query:c},function(c,g){d(c,g,b,function(b){return null!==a?b.slice(0,a+1):b})})};var d=function(c,b,a,d){if(c||200!==b.code){try{var g=k.parse(b.body)}catch(h){a({code:500,text:""},null);return}a(g,null)}else{try{var m=k.parse(b.body)}catch(n){a({code:500,text:""},null);return}d?a(null,d(m)):a(null,m)}},c=["sdk/v1/http",
"sdk/v1/event"];window.JSON||c.push("sdk/v1/json2");InFlight.define("livetextnews/v1",c,function(c,b,a){l=c;p=b;a&&(k=a);return h})})();
InFlight.define("maps/v1",["sdk/v1/http","sdk/v1/event","sdk/v1/json2","sdk/v1/util"],function(l,p,k,h){var m=window.JSON||k,g={getFlightMaps:function(d){l.get({url:InFlight.makeServiceURL("/maps/v1/flight_map")},function(c,g){if(c)d(c,null);else{var b;try{b=m.parse(g.body)}catch(a){d({code:500,text:""},null);return}b.code&&200!==b.code?d(b,null):d(null,b.images)}})},getFlightMapBySize:function(d,c){d?d.width||d.height?g.getFlightMaps(function(g,b){if(g)c(g,null);else{var a=null,h;for(h in b)if("number"===
typeof d.width&&"number"===typeof d.height?d.width===b[h].width&&d.height===b[h].height&&(a=b[h]):"number"===typeof d.width?d.width===b[h].width&&(a=b[h]):"number"===typeof d.height&&d.height===b[h].height&&(a=b[h]),a){c(null,a);return}c(null,null)}}):c({code:400,text:""}):c({code:400,text:""})},onFlightMapUpdate:function(d,c){p.register({event_name:"map_update",namespace:"core.maps",callback:function(g){g=m.parse(g.data.images||g.argv[0]);if("function"===typeof d)c(g);else for(var b in g){var a=
g[b];if(d.width===a.width&&d.height===a.height){c(a);break}}}})}};return g});
(function(){function l(a){0==d.length?c?d.push(a):k(a):c&&(bumped=d.shift(),d.push(a))}function p(){c=!1;0<d.length&&k(d.shift());return!1}function k(a){c=!0;var b=a.callback;v(function(){h.get({url:InFlight.makeServiceURL("/metadata/v1/search"),query:a.data},function(a,c){var n;if(a||200!==c.code)try{var d=m.parse(c.body);p()||b(d.code,null)}catch(e){p()||b({code:500,text:""},null)}else try{if(n=m.parse(c.body),"object"===typeof n.error&&null!==n.error)p()||b({code:n.error.code,text:""},null);else if("object"===
typeof n.data&&null!==n.data){for(d=0;d<n.data.length;d++)x(n.data[d]);b(a,n.data);p()}}catch(r){p()||b({code:500,text:""},null)}})})}var h=null,m=window.JSON,g={cache:{}},d=[],c=!1,q=null,b=function(a,b){for(var c={},d=a.length,g=0;g<d;g++){var h=a[g];h.sequence_num=g+1;c[h[b]]=h}return c},a=function(a,b){if(!InFlight.customHost)return a;for(var c=0;c<a.length;c++)a[c]=w(a[c],b);return a},w=function(a,b){if(!InFlight.customHost)return a;for(var c=0;c<b.length;c++)switch(typeof a[b[c]]){case "object":for(var d in a[b[c]])a[b[c]][d]=
InFlight.host;break;case "string":a[b[c]]=a[b[c]].InFlight.host}return a},x=function(a){var b=a.child_key_types||[];a.key_type&&b.push(a.key_type);var c;c=q&&q.getPlayableStatus?q.getPlayableStatus(b):"playable.no";a.playable=c;a:if(q&&q.isDRM){for(c=0;c<b.length;c++)if(q.isDRM(b[c])){b=!0;break a}b=!1}else b=null;a.drm_protected=b;void 0!==a.key_type&&delete a.key_type;void 0!==a.child_key_types&&delete a.child_key_types},v=function(a){InFlight.initService("avod/v1",function(b){q||(q=b.getEncryptionSupport());
a(b)},function(){a(null)})};g.searchMedia=function(a,b,c){if(a){var d={};d.text=a;"undefined"!==typeof b&&null!==b&&("undefined"!==typeof b.lang&&null!==b.lang&&(d.lang=b.lang),"undefined"!==typeof b.exact_match&&null!==b.exact_match&&(d.exact_match=b.exact_match),"undefined"!==typeof b.seat_class&&null!==b.seat_class&&(d.seat_class=b.seat_class));l({data:d,callback:c})}else c({code:400,text:""})};g.searchMediaByField=function(a,b,c){if(a){var d={};a.media_type&&(d.mediatype=a.media_type);a.title&&
(d.title=a.title);a.genre&&(d.genre=a.genre);a.year&&(d.year=a.year);a.cast&&(d.cast=a.cast);a.director&&(d.director=a.director);a.rating&&(d.rating=a.rating);0==d.length?c({code:400,text:""}):("undefined"!==typeof b&&null!==b&&("undefined"!==typeof b.lang&&null!==b.lang&&(d.lang=b.lang),"undefined"!==typeof b.exact_match&&null!==b.exact_match&&(d.exact_match=b.exact_match),"undefined"!==typeof b.seat_class&&null!==b.seat_class&&(d.seat_class=b.seat_class)),l({data:d,callback:c}))}else c({code:400,
text:""})};g.MediaTypes={MOVIE:"movie",TV_EPISODE:"tv",ALBUM:"album"};g.getRequiredSoftwareForMedia=function(a,b){v(function(c){c?h.get({url:InFlight.makeServiceURL("/metadata/v1/media_keytype_count"),headers:{Accept:"application/json"},query:a},function(a,d){if(a||200!==d.code){var n;try{n=m.parse(d.body)}catch(e){b({code:500,text:""},null);return}b(n,null)}else{var r;try{r=m.parse(d.body)}catch(g){b({code:500,text:""},null);return}n=[];for(var h in r)switch(r[h]){case 0:n.push("Unencrypted_HLS");
break;case 1:n.push("AES_HLS");break;case 2:n.push("AES_HLS_Marlin");break;case 3:n.push("AES_DASH_Widevine");break;case 4:n.push("AES_DASH_Widevine_HLS_FairPlay")}r=c.getRequiredSoftware(n);b(null,r)}}):b(null,null)})};g.bundles=function(b,c){h.get({url:InFlight.makeServiceURL("/metadata/v1/bundles"),headers:{Accept:"application/json"},query:b},function(b,d){if(b||200!==d.code){var n;try{n=m.parse(d.body)}catch(g){c({code:500,text:""},null);return}c(n,null)}else{var e;try{e=m.parse(d.body),e=a(e,
["poster_url","synopsis_url"])}catch(r){c({code:500,text:""},null);return}c(null,e)}})};g.categories=function(c,d){h.get({url:InFlight.makeServiceURL("/metadata/v1/categories"),headers:{Accept:"application/json"},query:c},function(c,n){if(c||200!==n.code){var g;try{g=m.parse(n.body)}catch(h){d({code:500,text:""},null);return}d(g,null)}else{var e;try{e=m.parse(n.body),e=a(e,["poster_url","synopsis_url"])}catch(r){d({code:500,text:""},null);return}d(null,b(e,"id"))}})};g.CategoryRootType={MOVIES:"movies",
MUSIC:"music",TV:"tv",RADIO:"radio",AUDIOBOOKS:"audiobooks",MUSICVIDEOS:"musicvideos",FEATURED:"featured",SHOWCASE:"showcase",KIDS_MOVIES:"kids_movies",KIDS_MUSIC:"kids_music",KIDS_TV:"kids_tv",KIDS_RADIO:"kids_radio",KIDS_FEATURED:"kids_featured",KIDS_SHOWCASE:"kids_showcase"};g.categoryMedia=function(c,d){v(function(){h.get({url:InFlight.makeServiceURL("/metadata/v1/category_media"),headers:{Accept:"application/json"},query:c},function(g,h){if(g||200!==h.code){var q;try{q=m.parse(h.body)}catch(k){d({code:500,
text:""},null);return}d(q,null)}else{var e;try{for(e=m.parse(h.body),e=a(e,["poster_url","synopsis_url","metadata_url"]),q=0;q<e.length;q++){x(e[q]);var r;if(r=c.filter){var t;a:{for(var l=c.filter,p=l.length;p--;)if(l[p]===e[q].playable){t=!0;break a}t=!1}r=!t}r&&(e.splice(q,1),q--)}}catch(w){d({code:500,text:""},null);return}d(null,b(e,"media_uri"))}})})};g.ContentType={MOVIE:"movie",TV_EPISODE:"tvepisode",TV_SEASON:"tvseason",TV_SERIES:"tvseries",ALBUM:"album",TRACK:"track",TRAILER:"trailer",ALBUM_AUDIO_BOOK:"album_audio_book",
EBOOK:"ebook",TRACK_AUDIO_BOOK_CHAPTER:"track_audio_book_chapter",BUNDLE:"bundle"};g.mediaMetadata=function(a,b){"undefined"===typeof a&&(a={});v(function(){h.get({url:InFlight.makeServiceURL("/metadata/v1/media_metadata"),headers:{Accept:"application/json"},query:a},function(a,c){if(a||200!==c.code){var d;try{d=m.parse(c.body)}catch(n){b({code:500,text:""},null);return}b(d,null)}else{var e;try{e=m.parse(c.body),e=w(e,["poster_url","synopsis_url"]),x(e)}catch(g){b({code:500,text:""},null);return}b(null,
e)}})})};g.childMedia=function(c,d){"undefined"===typeof c&&(c={});h.get({url:InFlight.makeServiceURL("/metadata/v1/child_media"),headers:{Accept:"application/json"},query:c},function(c,n){if(c||200!==n.code){var g;try{g=m.parse(n.body)}catch(h){d({code:500,text:""},null);return}d(g,null)}else{var e;try{e=m.parse(n.body),e=a(e,["poster_url","synopsis_url"])}catch(r){d({code:500,text:""},null);return}d(null,b(e,"media_uri"))}})};g.isHTML5=function(a){v(function(b){b?h.get({url:InFlight.makeServiceURL("/metadata/v1/media_keytype_count"),
headers:{Accept:"application/json"}},function(b,c){if(b||200!==c.code){var d;try{d=m.parse(c.body)}catch(g){a({code:500,text:""},null);return}a(d,null)}else{var e;d=!1;try{e=m.parse(c.body)}catch(r){a({code:500,text:""},null);return}var h=[],q;for(q in e)switch(e[q]){case 0:h.push("Unencrypted_HLS");break;case 1:h.push("AES_HLS");break;case 2:h.push("AES_HLS_Marlin");break;case 3:h.push("AES_DASH_Widevine");break;case 4:h.push("AES_DASH_Widevine_HLS_FairPlay")}if(-1!==h.indexOf("AES_HLS_Marlin"))d=
!1;else if(-1!==h.indexOf("AES_DASH_Widevine")||-1!==h.indexOf("AES_DASH_Widevine_HLS_FairPlay"))d=!0;a(null,d)}}):a(null,null)})};var t=["sdk/v1/http"];window.JSON||t.push("sdk/v1/json2");InFlight.define("metadata/v1",t,function(a,b){h=a;b&&(m=b);return g})})();(function(){InFlight.define("one_media/v1",["advertising/v1"],function(l){return l})})();
(function(){var l,p,k,h,m={Events:{RATING_UPDATE:"core.parental_control.rating_update"}},g=function(d){l.register({namespace:"core.parental_control",event_name:"rating_update",callback:function(c){var g,b;c.data.rating&&(g=c.data.rating);c.data.description&&(b=c.data.description);d({event:m.Events.RATING_UPDATE,rating:g,description:b})}})};m.addEventListener=function(d,c){switch(d){case m.Events.RATING_UPDATE:g(c);break;default:throw Error("parental_control/v1: Unknown event name: '"+d+"'");}};m.getRatings=
function(d){p.get({url:InFlight.makeServiceURL("/parental_control/v1/ratings",!0),headers:{Accept:"application/json"}},function(c,g){if(c||200!==g.code){var b;try{b=k.parse(g.body)}catch(a){d({code:500,text:""},null);return}d(b,null)}else{var h,m;try{h=k.parse(g.body),m=h.data}catch(l){d({code:500,text:""},null);return}d(null,m)}})};m.getDeviceRating=function(d){p.get({url:InFlight.makeServiceURL("/parental_control/v1/rating",!0),headers:{Accept:"application/json"}},function(c,g){if(c||200!==g.code){var b;
try{b=k.parse(g.body)}catch(a){d({code:500,text:""},null);return}d(b,null)}else{var h,m;try{h=k.parse(g.body),m=h.data}catch(l){d({code:500,text:""},null);return}d(null,m)}})};m.setDeviceRating=function(d,c){if(d.password){var g={},b=h.SHA256(d.password);g.passcode=b.toString(h.enc.Hex);"undefined"!==typeof d.rating&&null!==d.rating&&(g.rating=d.rating);g={params:g};g={url:InFlight.makeServiceURL("/parental_control/v1/rating",!0),data:k.stringify(g)};p.postJSON(g,function(a,b){var d;if(a||200!==b.code)try{var g=
k.parse(b.body);c(g.code,null)}catch(h){c({code:500,text:""},null)}else try{d=b.body,"object"===typeof d.error&&null!==d.error?c({code:d.error.code,text:""},null):"object"===typeof d.data&&null!==d.data&&c(a,d.data)}catch(n){c({code:500,text:""},null)}})}else c({code:400,text:""})};m.resetDeviceRating=function(d,c){if(d.password){var g={},b=h.SHA256(d.password);g.crew_passcode=b.toString(h.enc.Hex);g={params:g};g={url:InFlight.makeServiceURL("/parental_control/v1/reset_rating",!0),data:k.stringify(g)};
p.postJSON(g,function(a,b){var d;if(a||200!==b.code)try{var g=k.parse(b.body);c(g.code,null)}catch(h){c({code:500,text:""},null)}else try{d=b.body,"object"===typeof d.error&&null!==d.error?c({code:d.error.code,text:""},null):"object"===typeof d.data&&null!==d.data&&c(a,d.data)}catch(n){c({code:500,text:""},null)}})}else c({code:400,text:""})};InFlight.define("parental_control/v1",["sdk/v1/event","sdk/v1/http","sdk/v1/json2","parental_control/v1/sha256"],function(d,c,g,b){l=d;p=c;k=window.JSON||g;
h=b;return m})})();
InFlight.define("ppv/v1",["ppv/v2","sdk/v1/logger"],function(l,p){var k={},h={};k.checkPaymentRequirement=function(k,g){var d=p.createLogger("ppv/v1","checkPaymentRequirement"),c={};k.media_uris?(k.media_uris instanceof Array&&(c.media_uri=k.media_uris[0]),"string"===typeof k.media_uris&&(c.media_uri=k.media_uris),d.debug("retrieve purchasable media items for mid ["+c.media_uri+"]"),l.requestPurchaseInfo(c,function(k,b){if(k)d.error("Error: purchasable media item, mid ["+c.media_uri+"]",k),g(k,null);
else if(b){if(b.purchasable_media_items)if(1==b.purchasable_media_items.length&&c.media_uri!=b.purchasable_media_items[0].media_uri)d.debug("cache purchasable bundle media item for mid ["+c.media_uri+"]"),h[c.media_uri]=b.purchasable_media_items[0];else for(var a=0;a<b.purchasable_media_items.length;a++)d.debug("cache purchasable media item for mid ["+b.purchasable_media_items[a].media_uri+"]"),h[b.purchasable_media_items[a].media_uri]=b.purchasable_media_items[a];g(null,b.purchase_required)}else g({code:500,
text:""},null)})):g({code:400,text:""},null)};k.initiatePayment=function(k,g){var d=p.createLogger("ppv/v1","initiatePayment"),c;if(k.media_uris)if(k.media_uris instanceof Array&&(c=k.media_uris[0]),"string"===typeof k.media_uris&&(c=k.media_uris),h.hasOwnProperty(c)){var q={};d.debug("retrieve purchasable media item for mid ["+c+"]");q.purchasable_media_item=h[c];k.theme_id&&(q.theme_id=k.theme_id);k.lang&&(q.lang=k.lang);d.debug("startPaymentTransaction for media_uri ["+q.purchasable_media_item.media_uri+
"]");l.startPaymentTransaction(q,function(b,a){var c={currency:null,pay_type:null,charge_amount:null,purchase_required:!0};b?401==b.code?(c.purchase_required=!1,g(null,c)):g(b,null):(null!==a.purchasable_media_item&&(c.charge_amount=a.purchasable_media_item.price[0].amount,c.currency=a.purchasable_media_item.price[0].currency,d.debug("found purchasable item details: amount ["+c.charge_amount+"], currency ["+c.currency+"]")),d.debug("purchase required ["+c.purchase_required+"]"),g(null,c))})}else d.error("checkPaymentRequirement must first be called for mid ["+
c+"]"),g({code:400,text:""},null);else g({code:400,text:""},null)};k.purchase=function(h,g){var d=p.createLogger("ppv/v1","purchase"),c={};h.media_uris?(h.media_uris instanceof Array&&(c.media_uri=h.media_uris[0]),"string"===typeof h.media_uris&&(c.media_uri=h.media_uris),l.requestPurchaseInfo(c,function(c,b){var a={};c||!b.purchase_required?(d.error("return 503 error for backwards compatibility"),g({code:503,text:""},null)):(a.purchasable_media_item=b.purchasable_media_items[0],d.debug("complete payment transaction for media_uri ["+
a.purchasable_media_item.media_uri+"]"),l.completePaymentTransaction(a,function(a,b){if(a)d.error("failed to complete transaction error code ["+a.code+"]"),g(a,null);else{var c={};c.amount_charged=b.purchasable_media_item.price[0].amount;c.code=200;c.message=b.message?b.message:null;g(null,c)}}))})):g({code:400,text:""},null)};return k});
InFlight.define("ppv/v2","payment/v1/token sdk/v1/http sdk/v1/event sdk/v1/devicestorage sdk/v1/util sdk/v1/json2 sdk/v1/logger".split(" "),function(l,p,k,h,m,g,d){var c=window.JSON||g,q=null,b=null,a=function(){return h.getData("ppv.ppv_token")},w=function(a){this.media_uri=a.media_uri;this.price=a.price},x=function(a){var b=null;if(void 0!==a&&null!==a&&0<a.length)for(var b=[],c=0;c<a.length;c++)b.push(new w(a[c]));return b};k={};var v=function(b,g){var h=d.createLogger("ppv/v2","check_payment_requirement");
if(b&&b.media_uri){var k={params:{ppv_token:a(),media_uri:b.media_uri}},q={url:InFlight.makeServiceURL("/ppv/v2/check_payment_requirement",!0),data:c.stringify(k),headers:{"Content-Type":"application/json"}};h.trace("request: media_uri ["+k.params.media_uri+"]");p.postJSON(q,function(a,e){var b={};if(a)h.trace("Error: processing HTTP request",a),b.code=a.code,b.text="",g(b,null);else if(200!==e.code)h.trace("Error: HTTP status code != 200",e),b.code=e.code,b.text="",g(b,null);else if(e.body.error)412==
e.body.error.code&&(h.trace("Error: code 412",e),b.purchasable_media_items=x(e.body.error.purchasable_media_uris)),b.code=e.body.error.code,b.text="",h.trace("Error returned from service:",b),g(b,null);else{var d=x(e.body.data.purchasable_media_uris);b.purchase_required=e.body.data.payment_required;b.purchasable_media_items=d;h.trace("response: "+c.stringify(b));g(null,b)}})}else h.error("invalid arguments: "+c.stringify(b)),g({code:400,text:""})},t=function(a,b){var g=d.createLogger("ppv/v2","check_purchase_requirement");
if(a&&a.media_uri){var k={params:{payment_token:q,media_uri:a.media_uri}},t={url:InFlight.makeServiceURL("/ppv/v2/check_purchase_requirement",!0),data:c.stringify(k),headers:{"Content-Type":"application/json"}};g.trace("request: media_uri ["+k.params.media_uri+"]");p.postJSON(t,function(a,e){var d={};a?(g.trace("Error: processing HTTP request",a),d.code=a.code,d.text="",b(d,null)):200!==e.code?(g.trace("Error: HTTP status code != 200",e),d.code=e.code,d.text="",b(d,null)):e.body.error?(412==e.body.error.code&&
(g.trace("Error: code 412: ",e),d.purchasable_media_items=x(e.body.error.purchasable_media_uris)),d.code=e.body.error.code,d.text="",g.trace("Error returned from service: ",d),b(d,null)):(d.purchasable_media_items=x(e.body.data.purchasable_media_uris),d.purchase_required=e.body.data.purchase_required,!1===d.purchase_required&&void 0!==e.body.data.ppv_token&&h.setData("ppv.ppv_token",e.body.data.ppv_token),g.trace("response: "+c.stringify(d)),b(null,d))})}else g.error("invalid arguments: "+c.stringify(a)),
b({code:400,text:""})};k.requestPurchaseInfo=function(b,g){var h=d.createLogger("ppv/v2","requestPurchaseInfo");if(b&&b.media_uri){var k=function(a,b){a?412===a.code?g(null,{purchase_required:!0,purchasable_media_items:a.purchasable_media_items}):g(a,null):(h.debug("payment required ["+b.purchase_required+"]"),g(null,{purchase_required:b.purchase_required,purchasable_media_items:b.purchasable_media_items}))};null!==a()?(h.debug("ppv token is available, use checkPaymentRequirement"),v(b,k)):(h.debug("ppv token is NOT available, use checkPurchaseRequirement"),
t(b,k))}else h.error("invalid arguments: "+c.stringify(b)),g({code:400,text:""})};k.startPaymentTransaction=function(a,g){var h=d.createLogger("ppv/v2","startPaymentTransaction");if(a&&a.purchasable_media_item instanceof w){var k={media_uri:a.purchasable_media_item.media_uri,app_id:"PPV",theme_id:a.theme_id?a.theme_id:"default",lang:a.lang?a.lang:"eng"};h.trace("open payment form");l.requestPaymentToken(k,function(d,k){h.trace("payment form closed");if(d){var e={};404==d.code?(h.error("payment canceled"),
e.code=499):(h.error("payment token request failed with code ["+d.code+"]"),e.code=d.code);e.text="";g(e,null)}else q=k.payment_token,t({media_uri:a.purchasable_media_item.media_uri},function(e,d){e?(h.error("failed to get purchasable media for mid: "+c.stringify(e)),g(e,null)):!1===d.purchase_required?(h.error("Media has already been purchased. Tab has not been charged. Fail with error."),g({code:401,text:""},null)):(b=a.purchasable_media_item,h.debug("successfully retrieved payment information"),
g(null,{purchasable_media_item:b}))})})}else h.error("invalid arguments: "+c.stringify(a)),g({code:400,text:""})};k.cancelPaymentTransaction=function(a){var c=d.createLogger("ppv/v2","cancelPaymentTransaction");null!==b?(c.error("Failed to cancel transaction.  Transaction hasn't been initiated"),a({code:400,text:""},null)):(c.error("Transaction canceled"),b=null,a(null,null))};k.completePaymentTransaction=function(g,k){var t=d.createLogger("ppv/v2","completePaymentTransaction");if(void 0!==g.purchasable_media_item&&
g.purchasable_media_item instanceof w)if(null===q||b.media_uri!==g.purchasable_media_item.media_uri)k({code:402,text:""},null);else{var m={params:{payment_token:q,ppv_token:a(),media_uri:g.purchasable_media_item.media_uri}},m={url:InFlight.makeServiceURL("/ppv/v2/purchase",!0),data:c.stringify(m),headers:{"Content-Type":"application/json"}};p.postJSON(m,function(a,c){var e={};a?(e.code=a.code,e.text=a.text,k(a,e)):200!==c.code?(e.code=c.code,e.text="",k(e,null)):c.body.error?(e.code=c.body.error.code,
e.text="",e.purchasable_media_items=x(c.body.error.purchasable_media_uris),k(e,null)):(h.setData("ppv.ppv_token",c.body.data.ppv_token),!1===c.body.data.purchase_required?(t.error("Media has already been purchased. Tab has not been charged. Fail with error."),k({code:401,text:""},null)):(e.purchasable_media_item=b,b=null,t.debug("Successfully purchased media"),k(null,e)))})}else k({code:400,text:""},null)};return k});
(function(){var l=null,p=window.JSON,k={getServices:function(h){l.getJSON({url:InFlight.makeServiceURL("/service_discovery/v1/services")},function(g,d){g?h({code:g.code,text:""},null):200!=d.code?h({code:d.code,text:""},null):h(null,d.body.data)})}},h=["sdk/v1/http","sdk/v1/event","sdk/v1/logger"];p||h.push("sdk/v1/json2");InFlight.define("service_discovery/v1",h,function(h,g,d,c){l=h;d.createLogger("service_discovery/v1","api");c&&(p=c);return k})})();
(function(){function l(e){var a,b;"undefined"!==typeof document.hidden?(a="hidden",b="visibilitychange"):"undefined"!==typeof document.mozHidden?(a="mozHidden",b="mozvisibilitychange"):"undefined"!==typeof document.msHidden?(a="msHidden",b="msvisibilitychange"):"undefined"!==typeof document.webkitHidden&&(a="webkitHidden",b="webkitvisibilitychange");window.addEventListener&&(window.addEventListener("pageshow",e,!1),document.addEventListener(b,function(){document[a]||e()},!1));InFlight.addEventListener("inflight.app.wakeup",
e)}var p={Events:{DECOMPRESSION:"DECOMPRESSION",WEIGHT_ON_WHEELS:"WEIGHT_ON_WHEELS",PA_STATE:"PA_STATE",NET_STATE_CHANGE:"NET_STATE_CHANGE"},PAState:{OFF:0,ON:1,AUDIO:1,VIDEO:2,VIDEO_ANNOUNCEMENT:4,OTHER:8}};p.DECOMPRESSION=p.Events.DECOMPRESSION;p.WEIGHT_ON_WHEELS=p.Events.WEIGHT_ON_WHEELS;p.PA_STATE=p.Events.PA_STATE;p.NET_STATE_CHANGE=p.Events.NET_STATE_CHANGE;var k=null,h=window.JSON,m=null,g=null,d=null,c=[],q=[],b=[],a=null,w=!1,x=!1,v=!1,t=function(e){var a,c=!1,d=null;if("string"==typeof e)try{d=
h.parse(e),void 0===d.data||void 0===d.data.decompression||isNaN(d.data.decompression)||(c=d.data.decompression)}catch(g){InFlight.console.warn("Unable to parse native app decompression event")}else"0"!==e.data&&"1"!==e.data&&InFlight.console.warn("system/v1.addEventListener(System.Events.DECOMPRESSION): Expected '0' or '1' for TD_ID_DECOMPRESSION event data. Got '"+e.data+"'"),c="1"===e.data;for(a in b)if("function"===typeof b[a])b[a]({data:{decompression_state:c}})},n=function(e){var a=!1;if(!v){if(d.getBridgeType()!=
d.BridgeTypes.NONE&&d.getBridgeType()!=d.BridgeTypes.ANDROID){var c={event:"inflight.app.decompression"};try{a=h.parse(d.call("ifapi.hasEventSupport",c))}catch(g){InFlight.console.warn("Unable to detect native app decompression event support")}}a?InFlight.addEventListener("inflight.app.decompression",t):m.addEventListener(m.TD_ID_DECOMPRESSION,t);v=!0}b[b.length]=e;m.decompressionState(function(a,b){null!==a?InFlight.console.warn("system/v1.onDecompression: error while fetching state.",a):e({data:{decompression_state:b}})})},
z=function(e){var a,b=!1,c=null;if("string"==typeof e)try{c=h.parse(e),void 0===c.data||void 0===c.data.weight_on_wheels||isNaN(c.data.weight_on_wheels)||(b=c.data.weight_on_wheels)}catch(d){InFlight.console.warn("Unable to parse native app WOW event")}else"0"!==e.data&&"1"!==e.data&&InFlight.console.warn("system/v1.onWeightOnWheels:","Expected '0' or '1' for TD_ID_WEIGHT_ON_WHEELS event data.","Got '"+e.data+"'"),b="1"===e.data;for(a in q)if("function"===typeof q[a])q[a]({data:{weight_on_wheels:b}})},
y=function(e){var a=!1;if(!x){if(d.getBridgeType()!=d.BridgeTypes.NONE&&d.getBridgeType()!=d.BridgeTypes.ANDROID){var b={event:"inflight.app.weight_on_wheels"};try{a=h.parse(d.call("ifapi.hasEventSupport",b))}catch(c){InFlight.console.warn("Unable to detect native app WOW event support")}}a?InFlight.addEventListener("inflight.app.weight_on_wheels",z):m.addEventListener(m.TD_ID_WEIGHT_ON_WHEELS,z);x=!0}q[q.length]=e;m.weightOnWheels(function(a,b){null!==a?InFlight.console.warn("system/v1.onWeightOnWheels: error while fetching state.",
a):e({data:{weight_on_wheels:b}})})},u=function(e){var b,d=null,g=null;if("string"==typeof e)try{g=h.parse(e),void 0===g.data||void 0===g.data.pa_state||isNaN(g.data.pa_state)||(d=parseInt(g.data.pa_state,10))}catch(n){InFlight.console.warn("Unable to parse native app PA event")}else void 0===e.data||isNaN(e.data)||(d=parseInt(e.data,10));d=isNaN(d)||0==d?p.PAState.OFF:p.PAState.ON;if(d!=a){for(b in c)if("function"===typeof c[b])c[b]({data:{pa_state:d}});a=d}},C=function(e){var b=!1;if(!w){if(d.getBridgeType()!=
d.BridgeTypes.NONE&&d.getBridgeType()!=d.BridgeTypes.ANDROID){var n={event:"inflight.app.pa_state"};try{b=h.parse(d.call("ifapi.hasEventSupport",n))}catch(q){InFlight.console.warn("Unable to detect native app PA event support")}}b?InFlight.addEventListener("inflight.app.pa_state",u):m.addEventListener(m.TD_ID_X2_PA_STATE,u);w=!0}c[c.length]=e;m.paState(function(b,c){null!==b?InFlight.console.warn("system/v1.onPAState: error while fetching state.",b):(a=c,e({data:{pa_state:c}}))});g.onStateChange(function(e){e.online&&
m.paState(function(e,a){null!==e?InFlight.console.warn("system/v1.onPAState: error while fetching state.",e):u({data:a})})});k.onConnect(function(){m.paState(function(e,a){null!==e?InFlight.console.warn("system/v1.onPAState: error while fetching state.",e):u({data:a})})});l(function(){m.paState(function(e,a){null!==e?InFlight.console.warn("system/v1.onPAState: error while fetching state.",e):u({data:a})})})};p.addEventListener=function(e,a){switch(e){case p.Events.DECOMPRESSION:n(a);break;case p.Events.WEIGHT_ON_WHEELS:y(a);
break;case p.Events.PA_STATE:C(a);break;case p.Events.NET_STATE_CHANGE:g.onStateChange(a);break;default:throw"Unknown event name: '"+e+"'";}};var F=["flightdata/v1","sdk/v1/event","sdk/v1/network","sdk/v1/app_bridge"];h||F.push("sdk/v1/json2");InFlight.define("system/v1",F,function(e,a,b,c,n){m=e;k=a;g=b;d=c;n&&(h=n);return p})})();InFlight.define("catalogs/hospitality/v1",["catalogs/v1"],function(l){return new l("hospitality","catalogs/hospitality")});
InFlight.define("catalogs/shopping/v1",["catalogs/v1"],function(l){return new l("shopping","catalogs/shopping")});
(function(){var l=null,p,k=window.JSON,h=function(d){InFlight.initService("avod/v1",d,function(){d(null)})},m={isCommissioned:function(d){l.get({url:InFlight.makeServiceURL("/extv_metadata/v1/commissioning_status")},function(c,g){if(c)d(c,null);else{var b;try{b=k.parse(g.body)}catch(a){d({code:500,text:""});return}200!==g.code?d({code:b.code,text:""}):"Successful"===b.commissioning_status?d(null,!0):(InFlight.console.log("extv_metadata/v1: isCommissioned returned "+b.commissioning_status),d(null,
!1))}})},stations:function(d){l.get({url:InFlight.makeServiceURL("/extv_metadata/v1/stations"),headers:{Accept:"application/json"}},function(c,g){a:if(c||200!==g.code){var b=null;try{b=k.parse(g.body)}catch(a){d({code:500,text:""},null);break a}d(b,null)}else{b=null;try{b=k.parse(g.body)}catch(h){d({code:500,text:""},null);break a}if(InFlight.customHost)for(var m=0;m<b.length;m++){var l=b[m];l.station_status_url=l.station_status_url;for(var t in b[m].poster_url)b[m].poster_url[t]=b[m].poster_url[t]}m=
{};l=b.length;for(t=0;t<l;t++){var n=b[t];n.sequence_num=t+1;m[n.id]=n}d(null,m)}})},stationStatus:function(d,c){d&&d.id?l.get({url:InFlight.makeServiceURL("/extv_metadata/v1/station_status"),headers:{Accept:"application/json"},query:d},function(d,b){try{var a=k.parse(b.body)}catch(g){c({code:500,text:""},null);return}d||200!==b.code?c(a,null):c(null,a)}):c({code:400,text:""})},onStationsChanged:function(d){p.register({event_name:"stations_changed",namespace:"core.extv_metadata",callback:function(c){d()}})},
getRequiredSoftwareForMedia:function(d,c){h(function(d){d?(requiredSoftware=d.getRequiredSoftware(["unencrypted_hls"]),c(null,requiredSoftware)):c(null,null)})}},g=["sdk/v1/http","sdk/v1/event"];window.JSON||g.push("sdk/v1/json2");InFlight.define("extv/metadata/v1",g,function(d,c,g){l=d;p=c;g&&(k=g);return m})})();
InFlight.define("parental_control/v1/sha256",[],function(){var l=l||function(l,k){var h={},m=h.lib={},g=function(){},d=m.Base={extend:function(a){g.prototype=this;var b=new g;a&&b.mixIn(a);b.hasOwnProperty("init")||(b.init=function(){b.$super.init.apply(this,arguments)});b.init.prototype=b;b.$super=this;return b},create:function(){var a=this.extend();a.init.apply(a,arguments);return a},init:function(){},mixIn:function(a){for(var b in a)a.hasOwnProperty(b)&&(this[b]=a[b]);a.hasOwnProperty("toString")&&
(this.toString=a.toString)},clone:function(){return this.init.prototype.extend(this)}},c=m.WordArray=d.extend({init:function(a,b){a=this.words=a||[];this.sigBytes=b!=k?b:4*a.length},toString:function(a){return(a||b).stringify(this)},concat:function(a){var b=this.words,c=a.words,d=this.sigBytes;a=a.sigBytes;this.clamp();if(d%4)for(var g=0;g<a;g++)b[d+g>>>2]|=(c[g>>>2]>>>24-g%4*8&255)<<24-(d+g)%4*8;else if(65535<c.length)for(g=0;g<a;g+=4)b[d+g>>>2]=c[g>>>2];else b.push.apply(b,c);this.sigBytes+=a;return this},
clamp:function(){var a=this.words,b=this.sigBytes;a[b>>>2]&=4294967295<<32-b%4*8;a.length=l.ceil(b/4)},clone:function(){var a=d.clone.call(this);a.words=this.words.slice(0);return a},random:function(a){for(var b=[],d=0;d<a;d+=4)b.push(4294967296*l.random()|0);return new c.init(b,a)}}),q=h.enc={},b=q.Hex={stringify:function(a){var b=a.words;a=a.sigBytes;for(var c=[],d=0;d<a;d++){var g=b[d>>>2]>>>24-d%4*8&255;c.push((g>>>4).toString(16));c.push((g&15).toString(16))}return c.join("")},parse:function(a){for(var b=
a.length,d=[],g=0;g<b;g+=2)d[g>>>3]|=parseInt(a.substr(g,2),16)<<24-g%8*4;return new c.init(d,b/2)}},a=q.Latin1={stringify:function(a){var b=a.words;a=a.sigBytes;for(var c=[],d=0;d<a;d++)c.push(String.fromCharCode(b[d>>>2]>>>24-d%4*8&255));return c.join("")},parse:function(a){for(var b=a.length,d=[],g=0;g<b;g++)d[g>>>2]|=(a.charCodeAt(g)&255)<<24-g%4*8;return new c.init(d,b)}},w=q.Utf8={stringify:function(b){try{return decodeURIComponent(escape(a.stringify(b)))}catch(c){throw Error("Malformed UTF-8 data");
}},parse:function(b){return a.parse(unescape(encodeURIComponent(b)))}},x=m.BufferedBlockAlgorithm=d.extend({reset:function(){this._data=new c.init;this._nDataBytes=0},_append:function(a){"string"==typeof a&&(a=w.parse(a));this._data.concat(a);this._nDataBytes+=a.sigBytes},_process:function(a){var b=this._data,d=b.words,g=b.sigBytes,h=this.blockSize,k=g/(4*h),k=a?l.ceil(k):l.max((k|0)-this._minBufferSize,0);a=k*h;g=l.min(4*a,g);if(a){for(var q=0;q<a;q+=h)this._doProcessBlock(d,q);q=d.splice(0,a);b.sigBytes-=
g}return new c.init(q,g)},clone:function(){var a=d.clone.call(this);a._data=this._data.clone();return a},_minBufferSize:0});m.Hasher=x.extend({cfg:d.extend(),init:function(a){this.cfg=this.cfg.extend(a);this.reset()},reset:function(){x.reset.call(this);this._doReset()},update:function(a){this._append(a);this._process();return this},finalize:function(a){a&&this._append(a);return this._doFinalize()},blockSize:16,_createHelper:function(a){return function(b,c){return(new a.init(c)).finalize(b)}},_createHmacHelper:function(a){return function(b,
c){return(new v.HMAC.init(a,c)).finalize(b)}}});var v=h.algo={};return h}(Math);(function(p){for(var k=l,h=k.lib,m=h.WordArray,g=h.Hasher,h=k.algo,d=[],c=[],q=function(a){return 4294967296*(a-(a|0))|0},b=2,a=0;64>a;){var w;a:{w=b;for(var x=p.sqrt(w),v=2;v<=x;v++)if(!(w%v)){w=!1;break a}w=!0}w&&(8>a&&(d[a]=q(p.pow(b,.5))),c[a]=q(p.pow(b,1/3)),a++);b++}var t=[],h=h.SHA256=g.extend({_doReset:function(){this._hash=new m.init(d.slice(0))},_doProcessBlock:function(a,b){for(var d=this._hash.words,g=d[0],
h=d[1],k=d[2],e=d[3],r=d[4],q=d[5],m=d[6],l=d[7],p=0;64>p;p++){if(16>p)t[p]=a[b+p]|0;else{var x=t[p-15],v=t[p-2];t[p]=((x<<25|x>>>7)^(x<<14|x>>>18)^x>>>3)+t[p-7]+((v<<15|v>>>17)^(v<<13|v>>>19)^v>>>10)+t[p-16]}x=l+((r<<26|r>>>6)^(r<<21|r>>>11)^(r<<7|r>>>25))+(r&q^~r&m)+c[p]+t[p];v=((g<<30|g>>>2)^(g<<19|g>>>13)^(g<<10|g>>>22))+(g&h^g&k^h&k);l=m;m=q;q=r;r=e+x|0;e=k;k=h;h=g;g=x+v|0}d[0]=d[0]+g|0;d[1]=d[1]+h|0;d[2]=d[2]+k|0;d[3]=d[3]+e|0;d[4]=d[4]+r|0;d[5]=d[5]+q|0;d[6]=d[6]+m|0;d[7]=d[7]+l|0},_doFinalize:function(){var a=
this._data,b=a.words,c=8*this._nDataBytes,d=8*a.sigBytes;b[d>>>5]|=128<<24-d%32;b[(d+64>>>9<<4)+14]=p.floor(c/4294967296);b[(d+64>>>9<<4)+15]=c;a.sigBytes=4*b.length;this._process();return this._hash},clone:function(){var a=g.clone.call(this);a._hash=this._hash.clone();return a}});k.SHA256=g._createHelper(h);k.HmacSHA256=g._createHmacHelper(h)})(Math);return l});
InFlight.define("payment/v1/token",["sdk/v1/http","sdk/v1/app_bridge","sdk/v1/platformdetection","sdk/v1/devicestorage","sdk/v1/json2"],function(l,p,k,h,m){var g=window.JSON||m;m={APP_ID:{PPV:"PPV"}};var d=InFlight.makeServiceURL("/payment/v1/form",!0),c=function(b,a){var c=screen.height,g=screen.width,h=Math.random().toString(36).substring(7),m=d+"?form_id="+h;b.payment_token&&(m=m.concat("&payment_token="+b.payment_token));b.app_id&&(m=m.concat("&app_id="+b.app_id));b.theme_id&&(m=m.concat("&theme_id="+
b.theme_id));b.lang&&(m=m.concat("&lang="+b.lang));b.form_width&&(g=b.form_width);b.form_height&&(c=b.form_height);if(k.isiOSSDK()||k.isAndroidSDK())p.callMethod("ifapi.openPopup",{url:m},function(){q(h,a)});else var n=window.open(m,"_blank","height="+c+",width="+g+",scrollbars=1"),l=setInterval(function(){if(!n||n.closed)clearInterval(l),q(h,a)},1E3)},q=function(b,a){l.get({url:InFlight.makeServiceURL("/payment/v1/get_token",!0),query:{form_id:b}},function(b,c){if(b)a(b,c);else{var d;try{d=g.parse(c.body)}catch(k){a({code:500,
text:""});return}if(200!==d.code)a(d,null);else{var n=null;d.data.pay_type&&(n=d.data.pay_type);d=d.data.payment_token;h.setData("payment.payment_token",d);a(null,{payment_token:d,pay_type:n})}}})};m.requestPaymentToken=function(b,a){h.getData("payment.payment_token")&&(b.payment_token=h.getData("payment.payment_token"));c(b,a)};return m});
(function(){var l,p,k={call:function(h,k){var g;return p.isAndroidSDK()&&window.BridgeInterface?BridgeInterface.call(l.stringify(h)):g={code:503,text:""}}};InFlight.define("sdk/v1/androidbridge",["sdk/v1/json2","sdk/v1/platformdetection"],function(h,m){window.JSON&&(l=window.JSON);l=h;p=m;return k})})();
(function(){var l,p,k,h=0,m={},g={ANDROID:"android",IOS:"ios",NONE:"none"},d=function(b,a,c){var d=null,g=null,q="function"===typeof c||!1===c?!1:!0;if(!k)return b={code:503,text:""};if(!b)return b={code:402,text:""};c=void 0===c?null:c;d=++h;g={uid:d,method:b,method_arguments:void 0===a?null:a};"function"===typeof c&&(m[d]={callback:c});return k.call(g,q)},c=function(b,a){var c=null,d=null,g=null;void 0!==m[b]&&(c=m[b].callback);if(null!==c){try{d=l.parse(a)}catch(h){g={code:500,text:""}}delete m[b];
c(g,d)}},q={};q.callMethod=d;q.call=d;q.getBridgeType=function(){return p.isAndroidSDK()?g.ANDROID:p.isiOSSDK()?g.IOS:g.NONE};q.BridgeTypes=g;InFlight.SDK=InFlight.SDK||{};InFlight.SDK.V1=InFlight.SDK.V1||{};InFlight.SDK.V1.AppBridge=InFlight.SDK.V1.AppBridge||{};InFlight.SDK.V1.AppBridge.callback=c;InFlight.SDK.V1.IOS=InFlight.SDK.V1.IOS||{};InFlight.SDK.V1.IOS.callback=c;InFlight.define("sdk/v1/app_bridge",["sdk/v1/json2","sdk/v1/platformdetection","sdk/v1/androidbridge","sdk/v1/iosbridge2"],function(b,
a,c,d){l=window.JSON?window.JSON:b;p=a;p.isAndroidSDK()?k=c:p.isiOSSDK()&&(k=d);return q})})();(function(){var l=function(l,k){this.latitude=l;this.longitude=k};InFlight.define("sdk/v1/coordinates",[],function(){return l})})();
(function(){var l={RE_ISO8601:/^(\d{4}\-\d\d\-\d\d([tT][\d:\.]*)?)([zZ]|([+\-])(\d\d)\:?(\d\d))?$/,RE_TIME:/^([0-9]{2})\:?([0-9]{2})$/,createDateTime:function(p){var k=null;l.RE_ISO8601.test(p)&&(k=new Date(p),k={raw:p,year:k.getUTCFullYear(),month:k.getUTCMonth()+1,day:k.getUTCDate(),hours:k.getUTCHours(),minutes:k.getUTCMinutes()});return k},createTime:function(p){var k=null,h=l.RE_TIME.exec(p);null!==h?k={raw:p,hours:parseInt(h[1]),minutes:parseInt(h[2])}:l.RE_ISO8601.test(p)&&(k=new Date(p),k=
{raw:p,hours:k.getUTCHours(),minutes:k.getUTCMinutes()});return k}};InFlight.define("sdk/v1/datefactory",[],function(){return l})})();
(function(){var l={},p=null;try{window.localStorage&&(window.localStorage.setItem("ifapi.test",1),window.localStorage.removeItem("ifapi.test"),p=window.localStorage)}catch(k){InFlight.console.log("sdk/v1/devicestorage: No localstorage support")}if(!p){var h={};Object.defineProperty(h,"localStorage",new function(){var h=[],g={};Object.defineProperty(g,"getItem",{value:function(d){return"string"===typeof d&&void 0!==this[d]?this[d]:null},writable:!1,configurable:!1,enumerable:!1});Object.defineProperty(g,
"key",{value:function(d){return h[d]},writable:!1,configurable:!1,enumerable:!1});Object.defineProperty(g,"setItem",{value:function(d,c){d&&(document.cookie=escape(d)+"="+escape(c)+"; expires=Tue, 19 Jan 2038 03:14:07 GMT; path=/")},writable:!1,configurable:!1,enumerable:!1});Object.defineProperty(g,"length",{get:function(){return h.length},configurable:!1,enumerable:!1});Object.defineProperty(g,"removeItem",{value:function(d){d&&(document.cookie=escape(d)+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT; path=/")},
writable:!1,configurable:!1,enumerable:!1});this.get=function(){var d,c;for(c in g)d=h.indexOf(c),-1===d?g.setItem(c,g[c]):h.splice(d,1),delete g[c];for(;0<h.length;)h.splice(0,1),g.removeItem(h[0]);for(var k=0,b=document.cookie.split(/\s*;\s*/);k<b.length;k++)d=b[k].split(/\s*=\s*/),1<d.length&&(g[c=unescape(d[0])]=unescape(d[1]),h.push(c));return g};this.configurable=!1;this.enumerable=!0});p=h.localStorage}l.setData=function(h,g){return p.setItem(h,g)};l.getData=function(h){return p.getItem(h)};
l.deleteData=function(h){return p.removeItem(h)};l.clear=function(){p.clear()};InFlight.define("sdk/v1/devicestorage",[],function(){return l})})();
(function(){(function(){for(var a=3,b=document.createElement("div"),c=b.getElementsByTagName("i");b.innerHTML="\x3c!--[if gt IE "+ ++a+"]><i></i><![endif]--\x3e",c[0];);return 4<a?a:void 0})();var l=null,p=null,k=!0,h={HIGH_PRIORITY:1,LOW_PRIORITY:0,baseURL:InFlight.makeServiceURL("/event/v1/eventstream")},m,g=null,d=[],c={},q=!1,b=!1,a=!1,w,x=function(){var a=v(),a=h.baseURL+"?event=core.event_server.nop|"+a.join("|")+"&time="+(new Date).getTime();return a+"&padding=1"},v=function(){var a=[],b;for(b in c)if(c.hasOwnProperty(b)){var d=
b,e;for(e in c[d]){var g=e;0<c[d][g]&&a.push(d+"."+g)}}return a},t=function(){var a=0,b;for(b in c)if(c.hasOwnProperty(b)){var d=b,e;for(e in c[d])a+=c[d][e]}return a},n=function(){(k||0!==h.baseURL.indexOf("https://"))&&setTimeout(function(){if(null!==g&&!q)return!0;var b=p.createLogger("sdk/v1/event","refreshEventSource");b.debug("new connection may be required");null!==g&&(b.debug("close current connection"),g.close(),g=null);0===t()?b.debug("we have no listeners, don't create a new connection"):
y(function(){b.debug("window has been loaded");if(null===g&&q){b.debug("create new connection");g=new m(x());g.onmessage=z;for(var c=v(),d=0;d<c.length;d++)g.addEventListener(c[d],z);g.addEventListener("open",function(){a||(w.emit("connect"),a=!0)});g.addEventListener("error",function(e){a&&(w.emit("disconnect"),a=!1)});q=!1}})},0)},z=function(a){var b=a.type.split("."),c=b[0]+"."+b[1],b=b[2],e=l.decodeFormURLEncoded(a.data);a.rawData=a.data;a.data=e;for(var g=[],n=1;;n++)if(e.hasOwnProperty("param"+
n))g.push(e["param"+n]);else break;a.argv=g;d[h.HIGH_PRIORITY].emit(c+"."+b,a);d[h.LOW_PRIORITY].emit(c+"."+b,a)},y=function(a){var c=p.createLogger("sdk/v1/event","onWindowLoad");if(b)c.trace("window already loaded"),a(),d=!0;else{var d=!1;if("complete"!==document.readyState||d)if(document.readyState||(c.trace("document.readyState isn't available, set 3 second load timer"),setTimeout(function(){c.trace("load timeout complete, assume page is loaded");a();d=!0},3E3)),window.addEventListener)window.addEventListener("load",
function(){c.trace("window load event fired");d||(a(),d=!0)},!1);else if(window.onload){var e=window.onload;window.onload=function(b){c.trace("window.onload event fired");d||(a(b),d=!0);e(b)}}else window.onload=a;else c.trace("document.readyState == complete"),a(),d=!0}};h.getHTTPSEventServer_Enabled=function(){return k};h.register=function(a){var b=a.event_name;if(!b)throw"Invalid event_name";var g=a.callback,e=a.namespace;a="number"===typeof a.priority?a.priority:h.LOW_PRIORITY;"undefined"===typeof c[e]&&
(c[e]={});var r=c[e];if("undefined"===typeof r[b]||0===r[b])r[b]=1,q=!0;d[a].on(e+"."+b,g);n()};h.deregister=function(a){var b=a.event_name,g=a.callback,e=a.namespace;a="number"===typeof a.priority?a.priority:h.LOW_PRIORITY;var r=c[e];--r[b];0===r[b]&&(q=!0);d[a].off(e+"."+b,g);n()};h.onConnect=function(a){w.on("connect",a)};h.onDisconnect=function(a){w.on("disconnect",a)};InFlight.define("sdk/v1/event",["sdk/v1/eventsource","sdk/v1/config","sdk/v1/eventemitter2","sdk/v1/util","sdk/v1/logger"],function(a,
c,g,e,n){if(!a)return!1;m=a;k=c.HTTPS_EVENT_SERVER_ENABLED;l=e;p=n;d[h.HIGH_PRIORITY]=new g({wildcard:!0,delimiter:"."});d[h.LOW_PRIORITY]=new g({wildcard:!0,delimiter:"."});w=new g;y(function(){b=!0});return h})})();
(function(l,p){function k(g){this._events={};g&&(g.delimiter&&(this.delimiter=g.delimiter),g.wildcard&&(this.wildcard=g.wildcard),this.wildcard&&(this.listenerTree={}))}function h(g,d,c,k){if(!c)return[];var b=[],a,m,l,p;l=d.length;p=d[k];var t=d[k+1];if(k===l&&c._listeners){if("function"===typeof c._listeners)g&&g.push(c._listeners);else for(d=0,k=c._listeners.length;d<k;d++)g&&g.push(c._listeners[d]);return[c]}if("*"===p||"**"===p||c[p]){if("*"===p){for(a in c)"_listeners"!==a&&c.hasOwnProperty(a)&&
(b=b.concat(h(g,d,c[a],k+1)));return b}if("**"===p){(p=k+1===l||k+2===l&&"*"===t)&&c._listeners&&(b=b.concat(h(g,d,c,l)));for(a in c)"_listeners"!==a&&c.hasOwnProperty(a)&&("*"===a||"**"===a?(c[a]._listeners&&!p&&(b=b.concat(h(g,d,c[a],l))),b=b.concat(h(g,d,c[a],k))):b=a===t?b.concat(h(g,d,c[a],k+2)):b.concat(h(g,d,c[a],k)));return b}b=b.concat(h(g,d,c[p],k+1))}(m=c["*"])&&h(g,d,m,k+1);if(c=c["**"])if(k<l)for(a in c._listeners&&h(g,d,c,l),c)"_listeners"!==a&&c.hasOwnProperty(a)&&(a===t?h(g,d,c[a],
k+2):a===p?h(g,d,c[a],k+1):(l={},l[a]=c[a],h(g,d,{"**":l},k+1)));else c._listeners?h(g,d,c,l):c["*"]&&c["*"]._listeners&&h(g,d,c["*"],l);return b}var m=Array.isArray?Array.isArray:function(g){return"[object Array]"===Object.prototype.toString.call(g)};k.prototype.delimiter=".";k.prototype.setMaxListeners=function(g){this._events||(this._events={});this._events.maxListeners=g};k.prototype.event="";k.prototype.once=function(g,d){this.many(g,1,d);return this};k.prototype.many=function(g,d,c){function h(){0===
--d&&b.off(g,h);c.apply(this,arguments)}var b=this;if("function"!==typeof c)throw Error("many only accepts instances of Function");h._origin=c;this.on(g,h);return b};k.prototype.emit=function(){this._events||(this._events={});var g=arguments[0];if("newListener"===g&&!this._events.newListener)return!1;if(this._all){for(var d=arguments.length,c=Array(d-1),k=1;k<d;k++)c[k-1]=arguments[k];k=0;for(d=this._all.length;k<d;k++)this.event=g,this._all[k].apply(this,c)}if("error"===g&&!(this._all||this._events.error||
this.wildcard&&this.listenerTree.error)){if(arguments[1]instanceof Error)throw arguments[1];throw Error("Uncaught, unspecified 'error' event.");}var b;this.wildcard?(b=[],d="string"===typeof g?g.split(this.delimiter):g.slice(),h.call(this,b,d,this.listenerTree,0)):b=this._events[g];if("function"===typeof b){this.event=g;if(1===arguments.length)b.call(this);else if(1<arguments.length)switch(arguments.length){case 2:b.call(this,arguments[1]);break;case 3:b.call(this,arguments[1],arguments[2]);break;
default:d=arguments.length;c=Array(d-1);for(k=1;k<d;k++)c[k-1]=arguments[k];b.apply(this,c)}return!0}if(b){d=arguments.length;c=Array(d-1);for(k=1;k<d;k++)c[k-1]=arguments[k];b=b.slice();k=0;for(d=b.length;k<d;k++)this.event=g,b[k].apply(this,c);return 0<b.length||this._all}return this._all};k.prototype.on=function(g,d){if("function"===typeof g)return this.onAny(g),this;if("function"!==typeof d)throw Error("on only accepts instances of Function");this._events||(this._events={});this.emit("newListener",
g,d);if(this.wildcard){a:{for(var c=g,c="string"===typeof c?c.split(this.delimiter):c.slice(),h=0,b=c.length;h+1<b;h++)if("**"===c[h]&&"**"===c[h+1])break a;h=this.listenerTree;for(b=c.shift();b;){h[b]||(h[b]={});h=h[b];if(0===c.length){h._listeners?"function"===typeof h._listeners?h._listeners=[h._listeners,d]:m(h._listeners)&&(h._listeners.push(d),h._listeners.warned||(c=10,"undefined"!==typeof this._events.maxListeners&&(c=this._events.maxListeners),0<c&&h._listeners.length>c&&(h._listeners.warned=
!0,InFlight.console.warn("sdk/v1/eventemitter2: possible memory leak detected. "+h._listeners.length+" listeners added. ")))):h._listeners=d;break a}b=c.shift()}}return this}this._events[g]?"function"===typeof this._events[g]?this._events[g]=[this._events[g],d]:m(this._events[g])&&(this._events[g].push(d),this._events[g].warned||(c=10,"undefined"!==typeof this._events.maxListeners&&(c=this._events.maxListeners),0<c&&this._events[g].length>c&&(this._events[g].warned=!0,InFlight.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",
this._events[g].length),InFlight.trace()))):this._events[g]=d;return this};k.prototype.onAny=function(g){this._all||(this._all=[]);if("function"!==typeof g)throw Error("onAny only accepts instances of Function");this._all.push(g);return this};k.prototype.addListener=k.prototype.on;k.prototype.off=function(g,d){if("function"!==typeof d)throw Error("removeListener only takes instances of Function");var c,k=[];if(this.wildcard)c="string"===typeof g?g.split(this.delimiter):g.slice(),k=h.call(this,null,
c,this.listenerTree,0);else{if(!this._events[g])return this;c=this._events[g];k.push({_listeners:c})}for(var b=0;b<k.length;b++){var a=k[b];c=a._listeners;if(m(c)){for(var l=-1,p=0,v=c.length;p<v;p++)if(c[p]===d||c[p].listener&&c[p].listener===d||c[p]._origin&&c[p]._origin===d){l=p;break}if(0>l)break;this.wildcard?a._listeners.splice(l,1):this._events[g].splice(l,1);0===c.length&&(this.wildcard?delete a._listeners:delete this._events[g])}else if(c===d||c.listener&&c.listener===d||c._origin&&c._origin===
d)this.wildcard?delete a._listeners:delete this._events[g]}return this};k.prototype.offAny=function(g){var d=0,c=0,h;if(g&&this._all&&0<this._all.length)for(h=this._all,d=0,c=h.length;d<c;d++){if(g===h[d]){h.splice(d,1);break}}else this._all=[];return this};k.prototype.removeListener=k.prototype.off;k.prototype.removeAllListeners=function(g){if(0===arguments.length)return this._events&&(this._events={}),this;if(this.wildcard)for(var d="string"===typeof g?g.split(this.delimiter):g.slice(),d=h.call(this,
null,d,this.listenerTree,0),c=0;c<d.length;c++)d[c]._listeners=null;else{if(!this._events[g])return this;this._events[g]=null}return this};k.prototype.listeners=function(g){if(this.wildcard){var d=[];g="string"===typeof g?g.split(this.delimiter):g.slice();h.call(this,d,g,this.listenerTree,0);return d}this._events||(this._events={});this._events[g]||(this._events[g]=[]);m(this._events[g])||(this._events[g]=[this._events[g]]);return this._events[g]};k.prototype.listenersAny=function(){return this._all?
this._all:[]};"function"===typeof InFlight.define&&InFlight.define.amd?InFlight.define("sdk/v1/eventemitter2",function(){return k}):l.EventEmitter2=k})("undefined"!==typeof process&&"undefined"!==typeof process.title&&"undefined"!==typeof exports?exports:window);
(function(l){function p(){this.listeners={};return this}function k(){}function h(b,a){function g(){var a=B.event,e=B.readyState,b=String(a.type);B=B.next;if(2!==y.readyState&&(null!==e&&(y.readyState=e),0===e&&(216E5<C&&(C=216E5),null===Z&&(Z=setTimeout(z,C),m.createLogger("sdk/v1/eventsource","onTimeout").trace("will retry connection in "+C+" ms")),C=Math.min(C+1E3,5E3)),a.target=y,y.dispatchEvent(a),("message"===b||"error"===b||"open"===b)&&"function"===typeof y["on"+b]))y["on"+b](a)}function h(a,
e){N.event=a;N.readyState=e;N=N.next={next:null,event:null,readyState:null};L?L.port2.postMessage(""):setTimeout(g,0)}function v(){var a=m.createLogger("sdk/v1/eventsource","onProgress"),b=A.responseText||"",c,d,g,n;if(!ea){try{c=A.getResponseHeader?A.getResponseHeader("Content-Type"):A.contentType}catch(k){null===Z&&(a.error("unable to getResponseHeader, reconnecting in "+C+" ms"),Z=setTimeout(z,C))}c&&/^text\/event\-stream/i.test(c)&&(h({type:"open"},1),ea=!0,C=u)}null!==e&&(window.clearTimeout(e),
e=null);if(ea){for(c=b.slice(T);-1!==(d=c.search(q));)g=b.slice(oa,T+d),d+="\r\n"===c.slice(d,d+2)?2:1,T=oa=T+d,c=c.slice(d),g?(n="",d=g.indexOf(":"),-1!==d&&(n=g.slice(d+(" "===g.slice(d+1,d+2)?2:1)),g=g.slice(0,d)),"event"===g&&(X=n),"id"===g&&(Q=n),"retry"===g&&/^\d+$/.test(n)&&(C=u=Number(n)),"heartbeatTimeout"===g&&/^\d+$/.test(n)&&(F=Number(n),F=1>F?1:216E5<F?216E5:F),"data"===g&&(J=null===J?n:J+("\n"+n))):(null!==J&&(a.trace("data received, type ["+X+"] payload ["+J+"]"),r=Q,h({type:X||"message",
lastEventId:Q,data:J},null)),J=null,X="");T=b.length}}function t(){m.createLogger("sdk/v1/eventsource","onLoad").trace("connection completed, check for new content to parse");v()}function n(){if(3===A.readyState)v();else if(4===A.readyState){m.createLogger("sdk/v1/eventsource","onReadyStateChange").trace("connection closed, call error handler");var a=m.createLogger("sdk/v1/eventsource","onError");a.trace("event stream connection error detected");a.trace("remove event listener for beforeunload event");
window.removeEventListener("beforeunload",y.close,!1);h({type:"error"},0)}}function z(){var a=m.createLogger("sdk/v1/eventsource","openConnection");a.trace("attempt to open connection");a.trace("add event listener for beforeunload event");window.addEventListener("beforeunload",y.handleCloseOnBeforeUnload,!1);if(null===A)a.warn("attempted to open connection when xhr is null");else{A.onload=A.onerror=t;A.onprogress=v;A.onreadystatechange=n;T=oa=0;ea=!1;J=null;X="";Q=r;var c;c=-1===b.indexOf("?")?b+
"?timestamp="+(new Date).getTime():b+"&timestamp="+(new Date).getTime();A.open("GET",c,!0);A.withCredentials=W;null!==Z&&(window.clearTimeout(Z),Z=null);A.setRequestHeader&&(A.setRequestHeader("Content-type","application/x-www-form-urlencoded"),A.setRequestHeader("Accept","text/event-stream"));A.send(""!==r?"Last-Event-ID="+encodeURIComponent(r):"");null!==e&&(window.clearTimeout(e),e=null);e=setTimeout(function(){null===A?a.info("connection closed while waiting for timeout"):3!==A.readyState&&1===
A.readyState&&(a.info("connection timeout"),A.abort(),z())},F)}}b=String(b);var y=this,u=1E3,C=u,F=5E3,e=null,r="",A=new c,Z=null,W=Boolean(d&&a&&a.withCredentials),oa,T,ea,J="",Q="",X="",N={next:null,event:null,readyState:null},B=N,L=null;a=null;y.url=b;y.readyState=0;y.withCredentials=W;l.MessageChannel&&(L=new l.MessageChannel,L.port1.onmessage=g);y.handleCloseOnBeforeUnload=function(){};y.close=function(){var a=m.createLogger("sdk/v1/eventsource","close");a.trace("remove event listener for beforeunload event");
window.removeEventListener("beforeunload",y.handleCloseOnBeforeUnload,!1);null!==A&&(a.info("close connection"),A.onload=A.onerror=A.onprogress=A.onreadystatechange=k,A.abort(),A=null);y.readyState=2};p.call(y);z();return y}var m=null;p.prototype={listeners:null,throwError:function(b){setTimeout(function(){throw b;},0)},invokeEvent:function(b){var a=b.eventPhase,c=this.listeners[String(b.type)];if(c)for(var a=c[1===a?0:3===a?2:1],c=a.length,d=0;d<c;){b.currentTarget=this;try{a[d]&&a[d].call(this,
b)}catch(g){this.throwError(g)}b.currentTarget=null;d+=1}},dispatchEvent:function(b){b.eventPhase=2;this.invokeEvent(b)},addEventListener:function(b,a,c){b=String(b);c=c?0:2;var d=this.listeners,g=d[b];g||(d[b]=g=[[],[],[]]);b=g[c];for(d=b.length;0<d;)if(--d,b[d]===a)return;b.push(a);g[2-c].push(null);g[1].push(a)},removeEventListener:function(b,a,c){b=String(b);var d=this.listeners,g=d[b];if(g){c=g[c?0:2];for(var h=c.length,n=[[],[],[]],k=0;k<h;)c[k]!==a&&(n[0].push(g[0][k]),n[1].push(g[1][k]),n[2].push(g[2][k])),
k+=1;0===n[0].length?delete d[b]:d[b]=n}}};var g=l.XMLHttpRequest,d=g&&l.ProgressEvent&&void 0!==(new g).withCredentials,c=d?g:l.XDomainRequest,q=/\r[\s\S]|\n/,g=new p;g.CONNECTING=0;g.OPEN=1;g.CLOSED=2;h.prototype=g;h.CONNECTING=0;h.OPEN=1;h.CLOSED=2;g=null;InFlight.define("sdk/v1/eventsource",["sdk/v1/logger"],function(b){return c?(m=b,h):!1})})(this);
(function(){var l={DEGREES_TO_RADIANS_FACTOR:.01745329252,RADIANS_TO_DEGREES_FACTOR:57.29577951308,EARTH_RADIUS_MI:3958.75,haversineDistance:function(l,k){var h=(k.lon-l.lon)*this.DEGREES_TO_RADIANS_FACTOR,m=l.lat*this.DEGREES_TO_RADIANS_FACTOR,g=k.lat*this.DEGREES_TO_RADIANS_FACTOR,h=(Math.pow(Math.sin((k.lat-l.lat)*this.DEGREES_TO_RADIANS_FACTOR/2),2)+Math.pow(Math.sin(h/2),2))*Math.cos(m)*Math.cos(g),h=2*Math.atan2(Math.sqrt(h),Math.sqrt(1-h));return this.EARTH_RADIUS_MI*h},greatCircleBearing:function(l,
k){var h=this.DEGREES_TO_RADIANS_FACTOR*l.lon,m=this.DEGREES_TO_RADIANS_FACTOR*l.lat,g=this.DEGREES_TO_RADIANS_FACTOR*k.lon,d=this.DEGREES_TO_RADIANS_FACTOR*k.lat,c=Math.cos(d)*Math.sin(g-h),h=Math.cos(m)*Math.sin(d)-Math.sin(m)*Math.cos(d)*Math.cos(g-h),m=0;if(0===c&&0===h)return 0;if(0===h)return 0>c?3*Math.PI/2:Math.PI/2;0>h?m=Math.PI:0>c&&(m=2*Math.PI);return Math.atan(c/h)+m},greatCircleWaypoint:function(l,k,h){var m=this.DEGREES_TO_RADIANS_FACTOR*l.lon,g=this.DEGREES_TO_RADIANS_FACTOR*l.lat;
l=h/this.EARTH_RADIUS_MI;h=Math.cos(l);l=Math.sin(l);var d=Math.cos(g),c=Math.sin(g),q=Math.cos(k),g={};g.lat=Math.asin(c*h+d*l*q)*this.RADIANS_TO_DEGREES_FACTOR;k=l*Math.sin(k);h=d*h-c*l*q;g.lon=0===h?m:(m+Math.atan2(k,h))*this.RADIANS_TO_DEGREES_FACTOR;-180>g.lat&&(g.lat+=360);180<g.lat&&(g.lat-=360);-180>g.lon&&(g.lon+=360);180<g.lon&&(g.lon-=360);return g},greatCircleWaypoints:function(l,k,h){var m=this.haversineDistance(l,k)/h-1;l=[l];for(var g=0;g<h-1;g++){var d=l[l.length-1],c=this.greatCircleBearing(d,
k),d=this.greatCircleWaypoint(d,c,m);l.push(d)}l.push(k);return l}};InFlight.define("sdk/v1/geo",[],function(){return l})})();
(function(){var l,p,k=0,h=function(g){for(var d=document.cookie.split(";"),c=null,h=0,b=null,h=0;h<d.length;h++)c=d[h].split("="),c[0]=c[0].replace(/^\s+|\s+$/g,""),2==c.length&&c[0]===g&&(b=c[1]);return b},m={call:function(g,d,c){var m=!1,b="",a=null,w=a=null,x="",a=null,v=0,w=null;if(!p.isiOSSDK())return b={code:503,text:""};v=(new Date).getTime();c=void 0===c?null:c;a=++k;x="ios."+g+"."+a+".response";w={uid:a,cookie_name:x,method:g,method_arguments:void 0===d?null:d};if(null!==c||!1===c)m=!0,"function"!==
typeof c&&!1===c&&delete w.cookie_name;a=document.createElement("IFRAME");a.setAttribute("src","inflightjs://"+encodeURIComponent(l.stringify(w)));document.documentElement.appendChild(a);for(a.parentNode.removeChild(a);!1===m;)w=(new Date).getTime(),a=h(x),g=x,d=void 0,null!==h(g)&&(d=g+"=",d+=";path=/",d+=";expires=Thu, 01-Jan-1970 00:00:01 GMT",document.cookie=d),null!==a?(b=a,m=!0):250<=w-v&&(b="error",m=!0);return b}};InFlight.define("sdk/v1/iosbridge",["sdk/v1/json2","sdk/v1/platformdetection"],
function(g,d){window.JSON&&(l=window.JSON);l=g;p=d;return m})})();
(function(){var l,p,k,h=function(d,b){var a;d.async=!b;var g={url:"http://127.0.0.1:"+c+"/bridge/call",data:l.stringify(d),headers:{"Content-Type":"application/json"},synchronous:!0,timeout:500};if(!p.isiOSSDK())return a={code:503,text:""};k.post(g,function(c,d){!c&&200==d.code&&b&&(a=d.body)});return a},m=function(c){for(var b=document.cookie.split(";"),a=null,d=0,g=null,d=0;d<b.length;d++)a=b[d].split("="),a[0]=a[0].replace(/^\s+|\s+$/g,""),2==a.length&&a[0]===c&&(g=a[1]);return g},g=function(d){var b=
null;try{b=l.parse(d),void 0===b.data||void 0===b.data.port||isNaN(b.data.port)||(c=b.data.port)}catch(a){}},d={call:function(c,b){var a=!1,d,g=null,h="",g=null,k=0,n=null;if(!p.isiOSSDK())return d={code:503,text:""};b?(k=(new Date).getTime(),h="ios."+c.method+"."+c.uid+".response",c.cookie_name=h):a=!0;g=document.createElement("IFRAME");g.setAttribute("src","inflightjs://"+encodeURIComponent(l.stringify(c)));document.documentElement.appendChild(g);for(g.parentNode.removeChild(g);!1===a;){var n=(new Date).getTime(),
g=m(h),z=h,y=void 0;null!==m(z)&&(y=z+"=",y+=";path=/",y+=";expires=Thu, 01-Jan-1970 00:00:01 GMT",document.cookie=y);null!==g?(d=g,a=!0):250<=n-k&&(d={code:403,text:""},a=!0)}return d}},c=m("ios.bridge.httpd.port");null===c||isNaN(c)||(d.call=h,InFlight.addEventListener("inflight.app.bridge_port_change",g));InFlight.define("sdk/v1/iosbridge2",["sdk/v1/json2","sdk/v1/platformdetection","sdk/v1/http"],function(c,b,a){window.JSON&&(l=window.JSON);l=c;p=b;k=a;return d})})();
(function(){function l(a){return 10>a?"0"+a:a}function p(a){g.lastIndex=0;return g.test(a)?'"'+a.replace(g,function(a){var b=q[a];return"string"===typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function k(a,g){var h,l,m,n,q=d,y,u=g[a];u&&"object"===typeof u&&"function"===typeof u.toJSON&&(u=u.toJSON(a));"function"===typeof b&&(u=b.call(g,a,u));switch(typeof u){case "string":return p(u);case "number":return isFinite(u)?String(u):"null";case "boolean":case "null":return String(u);
case "object":if(!u)return"null";d+=c;y=[];if("[object Array]"===Object.prototype.toString.apply(u)){n=u.length;for(h=0;h<n;h+=1)y[h]=k(h,u)||"null";m=0===y.length?"[]":d?"[\n"+d+y.join(",\n"+d)+"\n"+q+"]":"["+y.join(",")+"]";d=q;return m}if(b&&"object"===typeof b)for(n=b.length,h=0;h<n;h+=1)"string"===typeof b[h]&&(l=b[h],(m=k(l,u))&&y.push(p(l)+(d?": ":":")+m));else for(l in u)Object.prototype.hasOwnProperty.call(u,l)&&(m=k(l,u))&&y.push(p(l)+(d?": ":":")+m);m=0===y.length?"{}":d?"{\n"+d+y.join(",\n"+
d)+"\n"+q+"}":"{"+y.join(",")+"}";d=q;return m}}var h={};"function"!==typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(a){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+l(this.getUTCMonth()+1)+"-"+l(this.getUTCDate())+"T"+l(this.getUTCHours())+":"+l(this.getUTCMinutes())+":"+l(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(a){return this.valueOf()});var m=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
g=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,d,c,q={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},b;"function"!==typeof h.stringify&&(h.stringify=function(a,g,h){var l;c=d="";if("number"===typeof h)for(l=0;l<h;l+=1)c+=" ";else"string"===typeof h&&(c=h);if((b=g)&&"function"!==typeof g&&("object"!==typeof g||"number"!==typeof g.length))throw Error("JSON.stringify");return k("",{"":a})});"function"!==
typeof h.parse&&(h.parse=function(a,b){function c(a,d){var g,h,k=a[d];if(k&&"object"===typeof k)for(g in k)Object.prototype.hasOwnProperty.call(k,g)&&(h=c(k,g),void 0!==h?k[g]=h:delete k[g]);return b.call(a,d,k)}var d;a=String(a);m.lastIndex=0;m.test(a)&&(a=a.replace(m,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(a.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,
"")))return d=eval("("+a+")"),"function"===typeof b?c({"":d},""):d;throw new SyntaxError("JSON.parse");});InFlight.define("sdk/v1/json2",[],function(){return h})})();
(function(){var l=function(a){var b=Math.abs(a),c=Math.floor(b/60),b=b-60*c;10>c&&(c="0"+c);10>b&&(b="0"+b);return a=(0<a?"-":"+")+(""+c+b)},p=function(){this.shiftedDate=null;switch(arguments.length){case 0:this.date=new Date;break;case 1:this.date=new Date(arguments[0])}this.setTimezoneOffset(0)};p.prototype.setTimezoneOffset=function(a){if("number"!==typeof a)throw{code:400,text:""};var b=this.date.getTime();this.shiftedDate=new Date(b-6E4*a);this.timezoneOffset=a};p.prototype.getTimezoneOffset=
function(){return this.timezoneOffset};var k={getDate:"getUTCDate",getDay:"getUTCDay",getFullYear:"getUTCFullYear",getHours:"getUTCHours",getMilliseconds:"getUTCMilliseconds",getMinutes:"getUTCMinutes",getMonth:"getUTCMonth",getSeconds:"getUTCSeconds",toString:"toString"},h;for(h in k)p.prototype[h]=function(a){return function(){return this.shiftedDate[a]()}}(k[h]);for(var m="getTime getUTCDate getUTCDay getUTCFullYear getUTCHours getUTCMilliseconds getUTCMinutes getUTCMonth getUTCSeconds toISOString toJSON toUTCString".split(" "),
k=0;k<m.length;k++)h=m[k],p.prototype[h]=function(a){return function(){return this.date[a]()}}(h);m="setUTCDate setUTCFullYear setUTCHours setUTCMilliseconds setUTCMinutes setUTCMonth".split(" ");for(k=0;k<m.length;k++)h=m[k],p.prototype[h]=function(a){return function(){var b=this.date[a].apply(this.date,arguments);this.setTimezoneOffset(this.timezoneOffset);return b}}(h);var g="Sun Mon Tue Wed Thu Fri Sat".split(" "),d="Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),c="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),
q="January February March April May June July August September October November December".split(" "),b=function(a,b,c){for(a=""+a;a.length<c;)a=b+a;return a};p.prototype.getYear=function(){var a=""+this.shiftedDate.getUTCFullYear();return parseInt(a.substring(2),10)};p.prototype.toLocaleDateString=function(){return this.shiftedDate.toLocaleDateString()};p.prototype.toDateString=function(){return g[this.shiftedDate.getUTCDay()]+", "+d[this.shiftedDate.getUTCMonth()]+" "+b(this.shiftedDate.getUTCDate(),
"0",2)+" "+this.shiftedDate.getUTCFullYear()};p.prototype.toTimeString=function(){return b(this.shiftedDate.getUTCHours(),"0",2)+":"+b(this.shiftedDate.getUTCMinutes(),"0",2)+":"+b(this.shiftedDate.getUTCSeconds(),"0",2)+" "+l(this.timezoneOffset)};p.prototype.toLocaleDateString=function(){var a=this.date.toLocaleDateString(),a=a.replace(this.date.getFullYear(),this.shiftedDate.getUTCFullYear()),a=a.replace(c[this.date.getDay()],c[this.shiftedDate.getUTCDay()]),a=a.replace(q[this.date.getMonth()],
q[this.shiftedDate.getUTCMonth()]),a=a.replace(this.date.getDate(),this.shiftedDate.getUTCDate()),b=this.date.getMonth()+1,d=this.shiftedDate.getUTCMonth()+1;return a=a.replace(b,d)};p.prototype.toString=function(){return this.toDateString()+" "+this.toTimeString()};p.prototype.toLocaleString=function(){var a=this.shiftedDate.toLocaleString(),a=a.replace(/[A-Z][a-z]{2} [A-Z][a-z]{2} \d{1,2}/,g[this.shiftedDate.getUTCDay()]+" "+d[this.shiftedDate.getUTCMonth()]+" "+this.shiftedDate.getUTCDate()),a=
a.replace(/[A-Z][a-z]+day/,c[this.shiftedDate.getUTCDay()]),a=a.replace(/[A-Z][a-z]{3,} \d{1,2}/,q[this.shiftedDate.getUTCMonth()]+" "+this.shiftedDate.getUTCDate()),a=a.replace(this.date.getFullYear(),this.shiftedDate.getUTCFullYear()),h=this.shiftedDate,k=this.timezoneOffset,m=b(h.getUTCHours(),"0",2),p=b(h.getUTCMinutes(),"0",2),h=b(h.getUTCSeconds(),"0",2),a=a.replace(/\d?\d:\d\d:\d\d/,m+":"+p+":"+h),a=a.replace(/ (AM|PM) [A-Z]{3}/,""),a=a.replace(/ (AM|PM) ?/,""),k=l(k);-1!==a.indexOf("GMT")&&
(a=a.replace(/(GMT)(\+|\-)\d{4}(\s.+)?/,"GMT"+k));return a};p.prototype.toLocaleTimeString=function(){var a=this.shiftedDate,b=a.getUTCHours(),c=a.getUTCMinutes(),a=a.getUTCSeconds();10>b&&(b="0"+b);10>c&&(c="0"+c);10>a&&(a="0"+a);return b+":"+c+":"+a};InFlight.define("sdk/v1/localdate",[],function(){return p})})();
(function(){var l=function(a,b){this.service=a;this.category=b},p=null,k=null,h=null,m=null;l.prototype.Events={FILTER_CHANGED:"sdk.v1.logger.filter_changed",TIMEOUT:"sdk.v1.logger.timeout'"};var g=null,d=!0,c=null,q=!1,b=null,a=function(a){m?m.dispatchEvent(a):InFlight.initService("sdk/v1/event/EventDispatcher",function(b){m=new b;m.dispatchEvent(a)})},w=function(a,b){m?m.addEventListener(a,b):InFlight.initService("sdk/v1/event/EventDispatcher",function(c){m=new c;m.addEventListener(a,b)})},x=function(a,
b){return a.category>b.category?-1:a.category<b.category?1:0};l.prototype.trace=function(a){var b=[];Array.prototype.push.apply(b,arguments);b.unshift(p.TRACE.val);this.logMessage.apply(this,b)};l.prototype.debug=function(a){var b=[];Array.prototype.push.apply(b,arguments);b.unshift(p.DEBUG.val);this.logMessage.apply(this,b)};l.prototype.info=function(a){var b=[];Array.prototype.push.apply(b,arguments);b.unshift(p.INFO.val);this.logMessage.apply(this,b)};l.prototype.warn=function(a){var b=[];Array.prototype.push.apply(b,
arguments);b.unshift(p.WARN.val);this.logMessage.apply(this,b)};l.prototype.error=function(a){var b=[];Array.prototype.push.apply(b,arguments);b.unshift(p.ERROR.val);this.logMessage.apply(this,b)};l.prototype.critical=function(a){var b=[];Array.prototype.push.apply(b,arguments);b.unshift(p.CRITICAL.val);this.logMessage.apply(this,b)};l.prototype.logMessage=function(n,m){var y,u;y=new Date;var w=[],F=v(this.category);Array.prototype.push.apply(w,arguments);w.splice(0,1);u=p.get(n).str;if(F!=p.OFF.val||
d)y=y.getFullYear()+"-"+this.zeroPad(y.getMonth(),2)+"-"+this.zeroPad(y.getDate(),2)+"."+this.zeroPad(y.getHours(),2)+":"+this.zeroPad(y.getMinutes(),2)+":"+this.zeroPad(y.getSeconds(),2)+"."+this.zeroPad(y.getMilliseconds(),3),y+=" [js] ["+u.toUpperCase()+"] ["+this.service+"] ["+this.category+"]",F<=n?t(y,w):d&&(u=new h(this.category,u,y,w),null===c&&(c=[]),c.push(u)),q||(q=!0,InFlight.initService("sdk/v1/event",function(e){e.register({event_name:"set",namespace:"core.logging",callback:function(e){null!==
b&&(window.clearTimeout(b),b=null);var h=e.data;e=0;var n,m=!1;if(void 0!==h.platform&&void 0!==h.level&&"js"===h.platform){d=!1;n=new k(h.level,h.category);null===g&&(g=[]);for(e=0;e<g.length;e++)if(g[e].category==n.category){g[e]=n;m=!0;break}m||g.push(n);n={type:l.prototype.Events.FILTER_CHANGED,data:n,argv:[]};g.sort(x);if(null!==c){if(h.level.toUpperCase()!==p.OFF.str.toUpperCase()){m=[];for(e=0;e<c.length;e++)h=v(c[e].category),h<=p.get(c[e].level).val&&t(c[e].message,c[e].args);for(e=m.length;e--;)c.splice(m[e],
1)}else for(e=c.length;e--;)c[e].category===h.category&&p.get(c[e].level).val<=p.get(h.level).val&&c.splice(e,1);c=null}a(n)}}})}))};var v=function(a){var b,c,d=p.OFF.val;if(null!==g)for(b=0;b<g.length;b++)if(c=g[b],0<=a.indexOf(c.category)||"*"==c.category){d=c.level;break}return d},t=function(a,b){window.console&&("object"===typeof window.console.log?"undefined"!==typeof b?window.console.log(a+" "+b.join(", ")):window.console.log(a):"undefined"!==typeof b?(b.unshift(a),window.console.log.apply(window.console,
b)):window.console.log.apply(window.console,[a]))};l.prototype.zeroPad=function(a,b){for(var c=""+a;c.length<b;)c="0"+c;return c};InFlight.define("sdk/v1/logger",["sdk/v1/logger/LogLevel","sdk/v1/logger/LogFilter","sdk/v1/logger/LogMessage"],function(n,m,q){p=n;k=m;h=q;b=setTimeout(function(){b=null;d&&(d=!1,c=null,a({type:l.prototype.Events.TIMEOUT,data:{}}))},5E3);return{createLogger:function(a,b){return new l(a,b)},getLogFilters:function(){return g},addEventListener:function(a,b){w(a,b)}}})})();
(function(){var l,p,k,h=[],m=!0,g=!1,d=null,c=function(){k.createLogger("sdk/v1/network","timeout").trace("network timeout");null!==d&&(window.clearTimeout(d),d=null);b(!1)},q=function(a){var c=null;if("string"===typeof a)try{c=JSON.parse(a)}catch(d){InFlight.console.warn("Unable to parse native app network_connection event")}null!==c&&void 0!==c.data&&"boolean"===typeof c.data.online&&b(c.data.online)},b=function(b){var c=k.createLogger("sdk/v1/network","setConnectionOnline");if(m!==b){c.debug("is online ["+
b+"]");var c={event:a.Events.NET_STATE_CHANGE,online:b},d=k.createLogger("sdk/v1/network","notifyEventListeners");d.trace("execute "+h.length+" callbacks");for(var g=0;g<h.length;g++){d.trace("execute callback "+g);try{h[g](c)}catch(l){InFlight.console.error(l)}}d.trace("execute callbacks complete");m=b}},a={Events:{NET_STATE_CHANGE:"network.state_change"},onStateChange:function(x){h.push(x);var v=!1;if(l.getBridgeType()!=l.BridgeTypes.NONE&&l.getBridgeType()!=l.BridgeTypes.ANDROID){var t={event:"inflight.app.network_connection"};
try{v=JSON.parse(l.call("ifapi.hasEventSupport",t))}catch(n){InFlight.console.warn("Unable to detect native app network_connection event support")}}v?InFlight.addEventListener("inflight.app.network_connection",q):g||0!=p.baseURL.indexOf("http://")&&(0!=p.baseURL.indexOf("https://")||1!=p.getHTTPSEventServer_Enabled())||(p.register({event_name:"nop",namespace:"core.event_server",callback:function(a){k.createLogger("sdk/v1/network","no-op").trace("event received");null!==d&&(window.clearTimeout(d),
d=null);b(!0);d=window.setTimeout(c,9E3)}}),g=!0,d=window.setTimeout(c,6E3));x({event:a.Events.NET_STATE_CHANGE,online:m})}},w=["sdk/v1/http","sdk/v1/app_bridge","sdk/v1/event","sdk/v1/logger"];JSON||w.push("sdk/v1/json2");InFlight.define("sdk/v1/network",w,function(b,c,d,g,h){k=g;l=c;p=d;h&&(JSON=h);return a})})();
(function(){var l=function(){null===p&&(this.visibilityChangeEvent=this.hiddenPropertyName=this.lastEvent=this.listeners=null,"undefined"!==typeof document.hidden?(this.hiddenPropertyName="hidden",this.visibilityChangeEvent="visibilitychange"):"undefined"!==typeof document.mozHidden?(this.hiddenPropertyName="mozHidden",this.visibilityChangeEvent="mozvisibilitychange"):"undefined"!==typeof document.msHidden?(this.hiddenPropertyName="msHidden",this.visibilityChangeEvent="msvisibilitychange"):"undefined"!==
typeof document.webkitHidden&&(this.hiddenPropertyName="webkitHidden",this.visibilityChangeEvent="webkitvisibilitychange"),window.addEventListener?(k.debug("add load/unload event handler"),window.addEventListener("load",c,!1),window.addEventListener("unload",c,!1),null!==this.visibilityChangeEvent&&(k.debug("add visibility event handler"),document.addEventListener(this.visibilityChangeEvent,c,!1)),h.isiOS()&&8.1>h.getiOSVersion()?(k.debug("add ios MobileSafari pageshow/pagehide event handler"),window.addEventListener("pageshow",
d,!1),window.addEventListener("pagehide",d,!1)):(k.debug("add pageshow/pagehide event handler"),window.addEventListener("pageshow",c,!1),window.addEventListener("pagehide",c,!1))):(k.debug("add window.unload callback"),q(c)),void 0!==window.InFlight.addEventListener&&(k.debug("add inflight.app.wakeup event handler"),window.InFlight.addEventListener("inflight.app.wakeup",g)),p=this)},p=null,k=null,h;l.prototype.PAGE_LOAD="page_load";l.prototype.PAGE_UNLOAD="page_unload";l.prototype.PAGE_VISIBLE="page_visible";
l.prototype.PAGE_HIDDEN="page_hidden";l.prototype.addEventListener=function(b,a){var c=m();null===c.listeners&&(c.listeners=[]);c.listeners[b]=a;k.debug("add event listener - "+b)};l.prototype.removeEventListener=function(b){var a=m();if(null!==a.listeners)for(var c in a.listeners)c===b&&delete a.listeners[b];k.debug("remove event listener - "+b)};var m=function(){null===p&&(p=new l);return p},g=function(){c({type:"inflight.app.wakeup"})},d=function(b){var a={type:b.type},d=void 0!==b.persisted?b.persisted:
!1,g=m();d&&(a.type=g.visibilityChangeEvent);k.debug("ios mobile safari event ["+b.type+"], persistent ["+d+"]");c(a)},c=function(b){var a=m(),c=!1,d=null;if(null!==a){switch(b.type){case "load":case "pageshow":c=!0;d=l.prototype.PAGE_LOAD;break;case "unload":case "pagehide":c=!1;d=l.prototype.PAGE_UNLOAD;break;case a.visibilityChangeEvent:d=(c=!document[a.hiddenPropertyName])?l.prototype.PAGE_VISIBLE:l.prototype.PAGE_HIDDEN;break;case "inflight.app.wakeup":case "ios.safari.visible":c=!0;d=l.prototype.PAGE_VISIBLE;
break;case "ios.safair.hidden":c=!1,d=l.prototype.PAGE_HIDDEN}k.debug("page visibility event ["+b.type+"] visible: ["+c+"]");if(null!==d&&d!=a.lastEvent&&(a.lastEvent=d,null!==a.listeners&&a.listeners[d]))a.listeners[d]({type:d})}},q=function(b){var a=window.onunload;window.onunload=function(){a&&a.call(window,{type:"unload"});b.call(window,{type:"unload"})}};InFlight.define("sdk/v1/pagevisibilitydispatcher",["sdk/v1/logger","sdk/v1/platformdetection"],function(b,a){k=b.createLogger("sdk/v1/pagevisibilitydispatcher",
"api");h=a;return new l})})();
(function(){var l=function(){return-1<navigator.appVersion.toLowerCase().indexOf("win")},p=function(){return-1<navigator.appVersion.toLowerCase().indexOf("linux")||-1<navigator.appVersion.toLowerCase().indexOf("unix")||-1<navigator.platform.toLowerCase().indexOf("linux")||-1<navigator.platform.toLowerCase().indexOf("unix")},k=function(){return-1<navigator.userAgent.toLowerCase().indexOf("android")},h=function(){return k()&&-1<navigator.userAgent.indexOf("InFlight")},m=function(){var a="00.00.00.00",
e=/InFlight\/(\d+\.\d+\.\d+\.\d+)/.exec(navigator.userAgent);e&&2<=e.length&&(a=e[1]);return a},g=function(){return-1<navigator.userAgent.toLowerCase().indexOf("blackberry")},d=function(){return!b()&&-1<navigator.appVersion.toLowerCase().indexOf("mac")},c=function(){return-1<navigator.userAgent.toLowerCase().indexOf("iphone")},q=function(){return-1<navigator.userAgent.toLowerCase().indexOf("ipod")},b=function(){return c()||q()||-1<navigator.userAgent.toLowerCase().indexOf("ipad")},a=function(){return b()&&
-1<navigator.userAgent.indexOf("InFlight")},w=function(){return-1<navigator.userAgent.toLowerCase().indexOf("safari")&&!(-1<navigator.userAgent.toLowerCase().indexOf("chrome"))&&!(-1<navigator.userAgent.toLowerCase().indexOf("crios"))},x=function(){var a=window.chrome,e=window.navigator,b=e.vendor,c=-1<e.userAgent.indexOf("OPR"),d=-1<e.userAgent.indexOf("Edge");return e.userAgent.match("CriOS")?!0:null!==a&&void 0!==a&&"Google Inc."===b&&0==c&&0==d?!0:!1},v=function(){return"Microsoft Internet Explorer"==
navigator.appName||"Netscape"==navigator.appName&&null!=/Trident\/.*rv:([0-9]{1,}[.0-9]{0,})/.exec(navigator.userAgent)},t=function(){return-1<navigator.userAgent.toLowerCase().indexOf("firefox")},n=function(){return-1<navigator.userAgent.toLowerCase().indexOf("opera")},z=function(){var a=navigator.userAgent.toLowerCase().match(/android [0-9]+.[0-9]+/gi);return a=a?parseFloat(a[0].split(" ")[1]):0},y=function(){var a=navigator.userAgent.toLowerCase().match(/mac os x [0-9]+.[0-9]+/gi);return a=a?parseFloat(a[0].split(" ")[3].replace("_",
".")):0},u=function(){var a=window.navigator.appVersion.match(/Windows NT ([^;]*)/);return null!==a&&this.isWindows()?parseFloat(a[1]):0},C=function(){var a=0,e=/CPU.*OS ([0-9_]{1,5})|(CPU like).*AppleWebKit.*Mobile/i.exec(navigator.userAgent);null!==e&&(a=parseFloat(e[1].replace("undefined","3_2").replace("_",".").replace("_","")));return a},F=function(){var a=navigator.userAgent,e,b=a.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*([\d\.]+)/i)||[];if(/trident/i.test(b[1]))return e=
/\brv[ :]+([\d\.]+)/g.exec(a)||[],parseFloat(e[1]||"");if("Chrome"===b[1]&&(e=a.match(/\bOPR\/([\d\.]+)/),null!=e))return parseFloat(e[1]);b=b[2]?[b[2]]:[navigator.appVersion];return null!=(e=a.match(/version\/([\d\.]+)/i))?parseFloat(e[1]):parseFloat(b.join(""))},e=function(){var a=!0;t()&&3.5>F()&&(a=!1);return a};InFlight.define("sdk/v1/platformdetection",function(){return{isWindows:l,isiOSSDK:a,isLinux:p,isAndroid:k,getAndroidSDKVersion:m,isAndroidSDK:h,isBlackBerry:g,isOSX:d,isiPhone:c,isiPod:q,
isiOS:b,isFirefox:t,isOpera:n,isSafari:w,isChrome:x,isIE:v,getBrowserVersion:F,getAndroidVersion:z,getOSXVersion:y,getWindowsVersion:u,getiOSVersion:C,hasEventSourceSupport:e}})})();
(function(){var l={};l.isArray=Array.isArray?Array.isArray:function(l){return!!l&&"[object Array]"===Object.prototype.toString.call(l)};l.decodeFormURLEncoded=function(l){var k={};if(!l)return k;l=l.split("&");for(var h=0;h<l.length;h++){var m=l[h].split("=");1===m.length&&""!==m[0]?k[decodeURIComponent(m[0])]="":2===m.length&&(k[decodeURIComponent(m[0])]=decodeURIComponent(m[1]))}return k};l.debounce=function(p,k,h){var m,g,d,c,q,b=function(){var a=l.now()-c;a<k?m=setTimeout(b,k-a):(m=null,h||(q=
p.apply(d,g),d=g=null))};return function(){d=this;g=arguments;c=l.now();var a=h&&!m;m||(m=setTimeout(b,k));a&&(q=p.apply(d,g),d=g=null);return q}};l.now=Date.now||function(){return(new Date).getTime()};InFlight.define("sdk/v1/util",[],function(){return l})})();
(function(){var l={};(function(){function l(a,b){var c=b||0,d=q;return d[a[c++]]+d[a[c++]]+d[a[c++]]+d[a[c++]]+"-"+d[a[c++]]+d[a[c++]]+"-"+d[a[c++]]+d[a[c++]]+"-"+d[a[c++]]+d[a[c++]]+"-"+d[a[c++]]+d[a[c++]]+d[a[c++]]+d[a[c++]]+d[a[c++]]+d[a[c++]]}var k;if("function"==typeof require)try{var h=require("crypto").randomBytes;k=h&&function(){return h(16)}}catch(m){}if(!k&&this.crypto&&crypto.getRandomValues){var g=new Uint8Array(16);k=function(){crypto.getRandomValues(g);return g}}if(!k){var d=Array(16);
k=function(){for(var a=0,b;16>a;a++)0===(a&3)&&(b=4294967296*Math.random()),d[a]=b>>>((a&3)<<3)&255;return d}}for(var c="function"==typeof Buffer?Buffer:Array,q=[],b={},a=0;256>a;a++)q[a]=(a+256).toString(16).substr(1),b[q[a]]=a;var a=k(),w=[a[0]|1,a[1],a[2],a[3],a[4],a[5]],x=(a[6]<<8|a[7])&16383,v=0,t=0,a={v1:function(a,b,c){c=b&&c||0;var d=b||[];a=a||{};var g=null!=a.clockseq?a.clockseq:x,h=null!=a.msecs?a.msecs:(new Date).getTime(),e=null!=a.nsecs?a.nsecs:t+1,k=h-v+(e-t)/1E4;0>k&&null==a.clockseq&&
(g=g+1&16383);(0>k||h>v)&&null==a.nsecs&&(e=0);if(1E4<=e)throw Error("uuid.v1(): Can't create more than 10M uuids/sec");v=h;t=e;x=g;h+=122192928E5;e=(1E4*(h&268435455)+e)%4294967296;d[c++]=e>>>24&255;d[c++]=e>>>16&255;d[c++]=e>>>8&255;d[c++]=e&255;h=h/4294967296*1E4&268435455;d[c++]=h>>>8&255;d[c++]=h&255;d[c++]=h>>>24&15|16;d[c++]=h>>>16&255;d[c++]=g>>>8|128;d[c++]=g&255;a=a.node||w;for(g=0;6>g;g++)d[c+g]=a[g];return b?b:l(d)},v4:function(a,b,d){d=b&&d||0;"string"==typeof a&&(b="binary"==a?new c(16):
null,a=null);a=a||{};a=a.random||(a.rng||k)();a[6]=a[6]&15|64;a[8]=a[8]&63|128;if(b)for(var g=0;16>g;g++)b[d+g]=a[g];return b||l(a)},parse:function(a,c,d){var g=c&&d||0,h=0;c=c||[];for(a.toLowerCase().replace(/[0-9a-f]{2}/g,function(a){16>h&&(c[g+h++]=b[a])});16>h;)c[g+h++]=0;return c}};a.unparse=l;a.BufferClass=c;this.uuid=a}).call(l);InFlight.define("sdk/v1/uuid",function(){return l.uuid})})();
(function(){var l=null,p=function(){this.eventListeners=null};p.sortListeners=function(k,h){return k.priority<h.priority?1:k.priority>h.priority?-1:k.index-h.index};p.prototype.addEventListener=function(k,h,m){var g;m=isNaN(m)?0:m;var d=0;g=l.createLogger("sdk/v1/event/EventDispatcher","addEventListener");if("function"!==typeof h)try{throw Error('listener is not of type "function"');}catch(c){void 0!==c.stack?g.error(c.message+"\n"+c.stack):g.error(c.message)}else{g.debug("type ["+k+"], priority ["+
m+"]");null===this.eventListeners&&(this.eventListeners={});void 0===this.eventListeners[k]?(g=[],this.eventListeners[k]=g):g=this.eventListeners[k];for(k=0;k<g.length;k++)d=Math.max(d,g[k].index);d++;h={priority:m,listener:h,index:d};g.push(h);g.sort(p.sortListeners)}};p.prototype.removeEventListener=function(k,h){var m,g=!1,d;l.createLogger("sdk/v1/event/EventDispatcher","removeEventListener").debug("["+k+"]");if(null!==this.eventListeners&&void 0!==this.eventListeners[k]){d=this.eventListeners[k];
for(m=0;m<d.length;m++)h===d[m].listener&&(g=!0),g&&m+1<d.length&&(d[m]=d[m+1]);g&&d.length--;0===d.length&&delete this.eventListeners[k]}};p.prototype.hasEventListener=function(k){var h=!1;null!==this.eventListeners&&void 0!==this.eventListeners[k]&&(h=!0);return h};p.prototype.dispatchEvent=function(k){var h,m,g,d=l.createLogger("sdk/v1/event/EventDispatcher","dispatchEvent");d.debug("["+k.type+"]");if(null!==this.eventListeners&&void 0!==this.eventListeners[k.type]){m=this.eventListeners[k.type];
g=[];for(h=0;h<m.length;h++)g[h]=m[h];for(h=0;h<g.length;h++){m=g[h].listener;try{m.call(this,k)}catch(c){m="Error executing event handler:\n\tType:\t"+k.type+"\n\tName:\t"+c.name+"\n\tMessage:\t"+c.message,void 0!==c.stack?d.error(m+"\n"+c.stack):d.error(m)}}}};InFlight.define("sdk/v1/event/EventDispatcher",["sdk/v1/logger"],function(k){l=k;return p})})();
(function(l){function p(){this.listeners={};return this}function k(){}function h(b,a){function g(){var a=B.event,e=B.readyState,b=String(a.type);B=B.next;if(2!==y.readyState&&(null!==e&&(y.readyState=e),0===e&&(216E5<C&&(C=216E5),null===Z&&(Z=setTimeout(z,C),m.createLogger("sdk/v1/event/fastcgiconnection","onTimeout").trace("will retry connection in "+C+" ms"))),a.target=y,y.dispatchEvent(a),("message"===b||"error"===b||"open"===b)&&"function"===typeof y["on"+b]))y["on"+b](a)}function h(a,e){N.event=
a;N.readyState=e;N=N.next={next:null,event:null,readyState:null};L?L.port2.postMessage(""):setTimeout(g,0)}function v(){var a=m.createLogger("sdk/v1/event/fastcgiconnection","onProgress"),b=A.responseText||"",c,d,g,k;if(!ea){try{c=A.getResponseHeader?A.getResponseHeader("Content-Type"):A.contentType}catch(n){null===Z&&(a.error("unable to getResponseHeader, reconnecting in "+C+" ms"),Z=setTimeout(z,C))}c&&/^text\/event\-stream/i.test(c)&&(h({type:"open"},1),ea=!0,C=u)}null!==e&&(window.clearTimeout(e),
e=null);if(ea){for(c=b.slice(T);-1!==(d=c.search(q));)g=b.slice(oa,T+d),d+="\r\n"===c.slice(d,d+2)?2:1,T=oa=T+d,c=c.slice(d),g?(k="",d=g.indexOf(":"),-1!==d&&(k=g.slice(d+(" "===g.slice(d+1,d+2)?2:1)),g=g.slice(0,d)),"event"===g&&(X=k),"id"===g&&(Q=k),"retry"===g&&/^\d+$/.test(k)&&(C=u=Number(k)),"heartbeatTimeout"===g&&/^\d+$/.test(k)&&(F=Number(k),F=1>F?1:216E5<F?216E5:F),"data"===g&&(J=null===J?k:J+("\n"+k))):(null!==J&&(a.trace("data received, type ["+X+"] payload ["+J+"]"),r=Q,h({type:X||"message",
lastEventId:Q,data:J},null)),J=null,X="");T=b.length}}function t(){m.createLogger("sdk/v1/event/fastcgiconnection","onLoad").trace("connection completed, check for new content to parse");v()}function n(){if(3===A.readyState)v();else if(4===A.readyState){m.createLogger("sdk/v1/event/fastcgiconnection","onReadyStateChange").trace("connection closed, call error handler");var a=m.createLogger("sdk/v1/event/fastcgiconnection","onError");a.trace("event stream connection error detected");a.trace("remove event listener for beforeunload event");
window.removeEventListener("beforeunload",y.close,!1);h({type:"error"},0)}}function z(){var a=m.createLogger("sdk/v1/event/fastcgiconnection","openConnection");a.trace("attempt to open connection");a.trace("add event listener for beforeunload event");window.addEventListener("beforeunload",y.close,!1);A.onload=A.onerror=t;A.onprogress=v;A.onreadystatechange=n;T=oa=0;ea=!1;J=null;X="";Q=r;var c;c=-1===b.indexOf("?")?b+"?timestamp="+(new Date).getTime():b+"&timestamp="+(new Date).getTime();A.open("GET",
c,!0);A.withCredentials=W;null!==Z&&(window.clearTimeout(Z),Z=null);A.setRequestHeader&&(A.setRequestHeader("Content-type","application/x-www-form-urlencoded"),A.setRequestHeader("Accept","text/event-stream"));A.send(""!==r?"Last-Event-ID="+encodeURIComponent(r):"");null!==e&&(window.clearTimeout(e),e=null);e=setTimeout(function(){null===A?a.info("connection closed while waiting for timeout"):3!==A.readyState&&1===A.readyState&&(a.info("connection timeout"),A.abort(),z())},F)}b=String(b);var y=this,
u=1E3,C=u,F=1E3,e=null,r="",A=new c,Z=null,W=Boolean(d&&a&&a.withCredentials),oa,T,ea,J="",Q="",X="",N={next:null,event:null,readyState:null},B=N,L=null;a=null;y.url=b;y.readyState=0;y.withCredentials=W;l.MessageChannel&&(L=new l.MessageChannel,L.port1.onmessage=g);y.close=function(){var a=m.createLogger("sdk/v1/event/fastcgiconnection","close");a.trace("remove event listener for beforeunload event");window.removeEventListener("beforeunload",y.close,!1);null!==A&&(a.info("close connection"),A.onload=
A.onerror=A.onprogress=A.onreadystatechange=k,A.abort(),A=null);y.readyState=2};p.call(y);z();return y}var m=null;p.prototype={listeners:null,throwError:function(b){setTimeout(function(){throw b;},0)},invokeEvent:function(b){var a=b.eventPhase,c=this.listeners[String(b.type)];if(c)for(var a=c[1===a?0:3===a?2:1],c=a.length,d=0;d<c;){b.currentTarget=this;try{a[d]&&a[d].call(this,b)}catch(g){this.throwError(g)}b.currentTarget=null;d+=1}},dispatchEvent:function(b){b.eventPhase=2;this.invokeEvent(b)},
addEventListener:function(b,a,c){b=String(b);c=c?0:2;var d=this.listeners,g=d[b];g||(d[b]=g=[[],[],[]]);b=g[c];for(d=b.length;0<d;)if(--d,b[d]===a)return;b.push(a);g[2-c].push(null);g[1].push(a)},removeEventListener:function(b,a,c){b=String(b);var d=this.listeners,g=d[b];if(g){c=g[c?0:2];for(var h=c.length,k=[[],[],[]],l=0;l<h;)c[l]!==a&&(k[0].push(g[0][l]),k[1].push(g[1][l]),k[2].push(g[2][l])),l+=1;0===k[0].length?delete d[b]:d[b]=k}}};var g=l.XMLHttpRequest,d=g&&l.ProgressEvent&&void 0!==(new g).withCredentials,
c=d?g:l.XDomainRequest,q=/\r[\s\S]|\n/,g=new p;g.CONNECTING=0;g.OPEN=1;g.CLOSED=2;h.prototype=g;h.CONNECTING=0;h.OPEN=1;h.CLOSED=2;g=null;InFlight.define("sdk/v1/event/fastcgiconnection",["sdk/v1/logger"],function(b){return c?(m=b,h):!1})})(this);
(function(){var l=null,p=null,k=null,h=null,m=null,g=!1,d={},c=!1,q=function(){var a=[],b;for(b in d)a.push(b);return a},b=function(){var a=0,b;for(b in d)a++;return a},a=function(a){var b={type:a.type,data:h.decodeFormURLEncoded(a.data),argv:[]},c=h.decodeFormURLEncoded(a.data);a.rawData=a.data;a.data=c;for(a=1;;a++)if(c.hasOwnProperty("param"+a))b.argv.push(c["param"+a]);else break;l.dispatchEvent(b)},w=function(){setTimeout(function(){if(null!==m&&!c)return!0;var d=k.createLogger("sdk/v1/event/fastcgisource",
"refreshEventSource");d.debug("new connection may be required");null!==m&&(d.debug("close current connection"),m.close(),m=null);0===b()?d.debug("we have no listeners, don't create a new connection"):x(function(){d.debug("window has been loaded");if(null===m&&c){d.debug("create new connection");var b=p,g=q(),g=InFlight.makeServiceURL("/event/v1/eventstream")+"?event="+g.join("|")+"&time="+(new Date).getTime();m=new b(g+"&padding=1");m.onmessage=a;b=q();for(g=0;g<b.length;g++)m.addEventListener(b[g],
a);c=!1}})},0)},x=function(a){var b=k.createLogger("sdk/v1/event/fastcgisource","onWindowLoad");if(g)b.trace("window already loaded"),a(),c=!0;else{var c=!1;if("complete"!==document.readyState||c)if(document.readyState||(b.trace("document.readyState isn't available, set 3 second load timer"),setTimeout(function(){b.trace("load timeout complete, assume page is loaded");a();c=!0},3E3)),window.addEventListener)window.addEventListener("load",function(){b.trace("window load event fired");c||(a(),c=!0)},
!1);else if(window.onload){var d=window.onload;window.onload=function(a){b.trace("window.onload event fired");c||(f(a),c=!0);d(a)}}else window.onload=a;else b.trace("document.readyState == complete"),a(),c=!0}},v={addEventListener:function(a,b,g){l.addEventListener(a,b,g);"undefined"===typeof d[a]&&(c=d[a]=!0);w()},removeEventListener:function(a,b){l.removeEventListener(a,b);l.hasEventListener(a)||void 0===d[a]||(delete d[a],c=!0);w()}};InFlight.define("sdk/v1/event/fastcgisource",["sdk/v1/event/fastcgiconnection",
"sdk/v1/event/EventDispatcher","sdk/v1/util","sdk/v1/logger"],function(a,b,c,d){l=new b;p=a;h=c;k=d;x(function(){g=!0});return v})})();
(function(){var l=null,p=null,k=null,h=null,m={},g=function(c){var d=k.createLogger("sdk/v1/event/nativesdksource","dispatchEvent");if("string"===typeof c)try{h.parse(c)}catch(b){void 0!==b.stack?d.error(b.message+"\n"+b.stack):d.error(b.message)}else if("object"===typeof c)d.trace(h.stringify(c)),l.dispatchEvent(c);else try{throw Error("invalid event payload");}catch(a){void 0!==a.stack?d.error(a.message+"\n"+a.stack):d.error(a.message)}},d={addEventListener:function(c,d,b){l.addEventListener(c,
d,b);if(void 0===m[c]){m[c]=!0;p.call("ifapi.event.v1.eventstream.subscribe",{event_name:c});c=0;for(var a in m)c++;1===c&&window.InFlight.addEventListener("inflight.app.event.v1.eventstream",g)}},removeEventListener:function(c,d){l.removeEventListener(c,d);l.hasEventListener(c)||(delete m[c],p.call("ifapi.event.v1.eventstream.unsubscribe",{event_name:c}))}};InFlight.define("sdk/v1/event/nativesdksource",["sdk/v1/app_bridge","sdk/v1/event/EventDispatcher","sdk/v1/json2","sdk/v1/logger"],function(c,
g,b,a){l=new g;p=c;h=void 0!==window.JSON?b:window.JSON;k=a;return d})})();(function(){var l,p=function(k,h){this.level=l.get(k).val;this.category=void 0===h||null===h?"*":h};p.toString=function(){return"{category:"+this.category+", level: "+this.level+"}"};InFlight.define("sdk/v1/logger/LogFilter",["sdk/v1/logger/LogLevel"],function(k){l=k;return p})})();
(function(){var l={TRACE:{val:0,str:"trace"},DEBUG:{val:1,str:"debug"},INFO:{val:2,str:"info"},WARN:{val:3,str:"warn"},ERROR:{val:4,str:"error"},CRITICAL:{val:5,str:"critical"},OFF:{val:6,str:"off"},get:function(p){switch(p){case l.CRITICAL.val:case l.CRITICAL.str:return l.CRITICAL;case l.ERROR.val:case l.ERROR.str:return l.ERROR;case l.WARN.val:case l.WARN.str:return l.WARN;case l.INFO.val:case l.INFO.str:return l.INFO;case l.DEBUG.val:case l.DEBUG.str:return l.DEBUG;case l.TRACE.val:case l.TRACE.str:return l.TRACE;
default:return l.OFF}}};InFlight.define("sdk/v1/logger/LogLevel",[],function(){return l})})();(function(){var l=function(l,k,h,m){this.category=l;this.level=k;this.message=h;this.args=m};InFlight.define("sdk/v1/logger/LogMessage",[],function(){return l})})();
(function(){function l(a){this.method="string"===typeof a.method?a.method:"GET";switch(this.method.toUpperCase()){case "GET":this.method="GET";break;case "POST":this.method="POST";break;case "OPTIONS":this.method="OPTIONS"}this.url="string"===typeof a.url?a.url:"";this.query="object"===typeof a.query?a.query:null;this.data=void 0!==a.data?a.data:null;this.headers="object"===typeof a.headers?a.headers:null;this.synchronous=!0===a.synchronous;this.timeout=isNaN(a.timeout)?0:a.timeout}function p(a,b,
c){this.body=a;this.code=b;this.headers=void 0!==c?c:null}function k(a,b,c,d){var g,h,l,n,m,p=isFinite(c)?c:0,q=15;b&&(this.encoding=b.toString());a:switch(this.encoding){case "UTF-8":l=k.s;n=k.j;b=Uint8Array;break a;case "UTF-16":l=k.r;n=k.i;b=Uint16Array;break a;case "UTF-32":b=Uint32Array;q&=14;break a;default:b=Uint8Array,q&=14}a:switch(typeof a){case "string":q&=7;break a;case "object":switch(a.constructor){case k:q&=3;break a;case String:q&=7;break a;case ArrayBuffer:g=new b(a);m="UTF-32"===
this.encoding?a.byteLength>>>2:"UTF-16"===this.encoding?a.byteLength>>>1:a.byteLength;h=0!==p||isFinite(d)&&d!==m?new b(a,p,isFinite(d)?d:m-p):g;break a;case Uint32Array:case Uint16Array:case Uint8Array:b=a.constructor;m=a.length;g=0===a.byteOffset&&a.length===(b===Uint32Array?a.buffer.byteLength>>>2:b===Uint16Array?a.buffer.byteLength>>>1:a.buffer.byteLength)?a:new b(a.buffer);h=0!==p||isFinite(d)&&d!==m?a.subarray(p,isFinite(d)?p+d:m):a;break a;default:g=new b(a),m=g.length,h=0!==p||isFinite(d)&&
d!==m?g.subarray(p,isFinite(d)?p+d:m):g}break a;default:g=h=new b(Number(a)||0)}if(8>q){var t,v,u,x;if(q&4)h=a,t=m=h.length,q^="UTF-32"===this.encoding?0:2,p=c=c?Math.max((t+c)%t,0):0,d=v=(Number.k(d)?Math.min(Math.max(d,0)+p,t):t)-1;else{p=h=a.b;v=p.length;m=0;var w=isNaN(void 0)?Infinity:void 0;if(NaN>p.length)throw new RangeError("StringView.prototype.makeIndex - The offset can't be major than the length of the array - 1.");switch(a.encoding){case "UTF-8":var z;for(t=0;m<v&&t<w;t++)z=p[m],m+=251<
z&&254>z&&m+5<v?6:247<z&&252>z&&m+4<v?5:239<z&&248>z&&m+3<v?4:223<z&&240>z&&m+2<v?3:191<z&&224>z&&m+1<v?2:1;break;case "UTF-16":for(t=0;m<v&&t<w;t++)m+=55231<p[m]&&m+1<p.length?2:1;break;default:t=isFinite(void 0)?void 0:v-1}m=t;p=c=c?Math.max((m+c)%m,0):0;t=Number.k(d)?Math.min(Math.max(d,0),m-c):m;d=v=t+c;"UTF-8"===a.encoding?(u=k.j,x=k.n):"UTF-16"===a.encoding?(u=k.i,x=k.m):q&=1}if(0===t||4>q&&h.encoding===this.encoding&&0===c&&t===m)q=7;a:switch(q){case 0:g=new b(t);for(n=0;n<t;g[n]=h[p+n++]);
break a;case 1:t=0;for(a=p;a<d;a++)t+=n(h[a]);g=new b(t);a=p;for(n=0;n<t;a++)n=l(g,h[a],n);break a;case 2:for(w=p=0;w<c;w++)m=x(h,p),p+=u(m);g=new b(t);a=p;for(n=0;n<t;a+=u(m),n++)m=x(h,a),g[n]=m;break a;case 3:for(a=w=t=0;w<v;a+=u(m))m=x(h,a),w===c&&(p=a),++w>c&&(t+=n(m));g=new b(t);a=p;for(n=0;n<t;a+=u(m))m=x(h,a),n=l(g,m,n);break a;case 4:g=new b(t);for(l=0;l<t;l++)g[l]=h.charCodeAt(l)&255;break a;case 5:for(g=t=0;g<m;g++)g===c&&(p=t),t+=n(h.charCodeAt(g)),g===v&&(d=t);g=new b(t);for(w=n=0;n<t;w++)n=
l(g,h.charCodeAt(w),n);break a;case 6:g=new b(t);for(l=0;l<t;l++)g[l]=h.charCodeAt(l);break a;case 7:g=new b(t?h:0)}h=3<q&&(0<p||d<g.length-1)?g.subarray(p,d):g}this.buffer=g.buffer;this.b=h;Object.freeze(this)}function h(a){var b=null,c;c=[];for(b in a)c.push(encodeURIComponent(b)+"="+encodeURIComponent(a[b]));return c.join("&")}function m(a,b){var c=a,d="";null!==b&&(d=h(b));c=0<c.indexOf("?")?c+"&":c+"?";return c+d}function g(a,b,c){var g=null,h=this;this.callback=b;this.h=c;this.responseType=
this.c=this.d=this.f=this.e=null;this.a=new XMLHttpRequest;null!==a.query&&(a.url=m(a.url,a.query));this.a.open(a.method,a.url,!a.synchronous);(this.l=a.synchronous)||(this.a.timeout=a.timeout,this.a.ontimeout=function(){d(h)},this.a.onreadystatechange=function(){switch(h.a.readyState){case 4:d(h)}});this.setData(a.data);if(null!==a.headers)for(g in a.headers)this.a.setRequestHeader(g,a.headers[g])}function d(a){if(null===a.e)if(a.d=a.a.status,0==a.d||408==a.d)a.d=408,a.c='{ "code": '+a.d+',  "text":"" }';
else{var b,d,g,h,k={};b=a.a.getAllResponseHeaders();if(null!==b)for(h=b.split("\n"),b=0;b<h.length;b++)""!==h[b]&&(g=h[b].indexOf(": "),d=h[b].slice(0,g).toLowerCase(),k[d]=h[b].slice(g+1),k[d]=k[d].replace(/^\s+|\s+$/g,""));a.f=k;k=a.f["content-type"]||a.f["Content-Type"];b=a.a.responseText;if(k&&-1<k.indexOf("application/vnd.panasonic.inflight.obf"))try{var l=y.q(b),n,m;for(n=0;n<l.b.length;n++)m=l.b[n],1<=m&&127!=m&&(m=n%2?m+128:158-m),l.b[n]=m;b=l.toString()}catch(p){a.c=null;a.e={code:500,text:""};
return}switch(a.responseType){case "json":try{a.c=u.parse(b)}catch(q){a.c=null,a.e={code:500,text:""}}break;default:a.c=b}}c(a);null!==a.h&&a.h.call(a)}function c(a){if(null!==a.a){a.a.ontimeout=null;a.a.onreadystatechange=null;a.a.abort();try{a.a.responseText="",a.a.u=null,a.a.response=null}catch(b){}a.a=null}}function q(a,b){return new g(new l(a),b,z)}function b(a,b){var c=q(a,b);n(c);c.load()}function a(a,b){a.method="HEAD";var c=q(a,b);n(c);c.load()}function w(a,b){a.method="OPTIONS";var c=q(a,
b);n(c);c.load()}function x(a,b){a.method="GET";var c=q(a,b);c.responseType="json";n(c);c.load()}function v(a,b){var c,d="application/x-www-form-urlencoded";void 0===a.headers&&(a.headers={});for(c in a.headers)if("string"===typeof c&&"content-type"===c.toLowerCase()){d=a.headers[c];delete a.headers[c];break}a.headers["Content-Type"]=d;a.method="POST";c=q(a,b);n(c);c.load()}function t(a,b){var c,d="application/x-www-form-urlencoded";void 0===a.headers&&(a.headers={});for(c in a.headers)if("string"===
typeof c&&"content-type"===c.toLowerCase()){d=a.headers[c];delete a.headers[c];break}a.headers["Content-Type"]=d;a.method="POST";c=q(a,b);c.responseType="json";n(c);c.load()}function n(a){null===C&&(C=[]);C.push(a)}function z(){var a=null;a:{var b;if(null!==C){for(b=0;b<C.length;b++)if(C[b]===this){C.splice(b,1);break a}0==C.length&&(C=null)}}try{b=null,null===this.e&&null!==this.c&&null!==this.d&&(b=new p(this.c,this.d,this.f)),this.callback.call(this,this.e,b)}catch(d){a=d}c(this);this.h=this.callback=
this.e=this.f=this.responseType=this.d=this.c=this.a=this.data=null;delete this.l;if(null!==a)throw a;}var y=k;Number.k||(Number.k=function(a){return"number"===typeof a&&isFinite(a)&&-9007199254740992<a&&9007199254740992>a&&Math.floor(a)===a});k.n=function(a,b){var c=a.length,d=a[b];return 251<d&&254>d&&b+5<c?1073741824*(d-252)+(a[b+1]-128<<24)+(a[b+2]-128<<18)+(a[b+3]-128<<12)+(a[b+4]-128<<6)+a[b+5]-128:247<d&&252>d&&b+4<c?(d-248<<24)+(a[b+1]-128<<18)+(a[b+2]-128<<12)+(a[b+3]-128<<6)+a[b+4]-128:
239<d&&248>d&&b+3<c?(d-240<<18)+(a[b+1]-128<<12)+(a[b+2]-128<<6)+a[b+3]-128:223<d&&240>d&&b+2<c?(d-224<<12)+(a[b+1]-128<<6)+a[b+2]-128:191<d&&224>d&&b+1<c?(d-192<<6)+a[b+1]-128:d};k.s=function(a,b,c){128>b?a[c++]=b:(2048>b?a[c++]=192+(b>>>6):(65536>b?a[c++]=224+(b>>>12):(2097152>b?a[c++]=240+(b>>>18):(67108864>b?a[c++]=248+(b>>>24):(a[c++]=252+b/1073741824,a[c++]=128+(b>>>24&63)),a[c++]=128+(b>>>18&63)),a[c++]=128+(b>>>12&63)),a[c++]=128+(b>>>6&63)),a[c++]=128+(b&63));return c};k.j=function(a){return 128>
a?1:2048>a?2:65536>a?3:2097152>a?4:67108864>a?5:6};k.m=function(a,b){var c=a[b];return 55231<c&&b+1<a.length?(c-55296<<10)+a[b+1]+9216:c};k.r=function(a,b,c){65536>b?a[c++]=b:(a[c++]=55232+(b>>>10),a[c++]=56320+(b&1023));return c};k.i=function(a){return 65536>a?1:2};k.o=function(a){return 64<a&&91>a?a-65:96<a&&123>a?a-71:47<a&&58>a?a+4:43===a?62:47===a?63:0};k.g=function(a){return 26>a?a+65:52>a?a+71:62>a?a-4:62===a?43:63===a?47:65};k.t=function(a){for(var b=(3-a.length%3)%3,c="",d,g=a.length,h=0,
l=0;l<g;l++)if(d=l%3,h|=a[l]<<(16>>>d&24),2===d||1===a.length-l)c+=String.fromCharCode(k.g(h>>>18&63),k.g(h>>>12&63),k.g(h>>>6&63),k.g(h&63)),h=0;return 0===b?c:c.substring(0,c.length-b)+(1===b?"=":"==")};k.p=function(a){a=a.replace(/[^A-Za-z0-9\+\/]/g,"");for(var b=a.length,c=3*b+1>>>2,d=new Uint8Array(c),g,h=0,l=0,n=0;n<b;n++)if(g=n&3,h|=k.o(a.charCodeAt(n))<<18-6*g,3===g||1===b-n){for(g=0;3>g&&l<c;g++,l++)d[l]=h>>>(16>>>g&24)&255;h=0}return d};k.q=function(a){return new k(k.p(a),void 0,void 0,
void 0)};k.prototype.encoding="UTF-8";k.prototype.valueOf=k.prototype.toString=function(){if("UTF-8"!==this.encoding&&"UTF-16"!==this.encoding)return String.fromCharCode.apply(null,this.b);var a,b,c="";"UTF-8"===this.encoding?(b=k.j,a=k.n):"UTF-16"===this.encoding&&(b=k.i,a=k.m);for(var d,g=this.b.length,h=0;h<g;h+=b(d))d=a(this.b,h),c+=String.fromCharCode(d);return c};var u=window.JSON;g.prototype.load=function(){this.a.send(this.data);this.l&&d(this)};g.prototype.setData=function(a){if(null!==a)switch(a.constructor){case window.ArrayBuffer:case window.ArrayBufferView:case window.Blob:case window.Document:case window.FormData:case window.String:this.data=
a;break;case window.Object:this.data=h(a)}};var C=null,F=[];F.push("sdk/v1/json2");window.InFlight.define("sdk/v1/http",F,function(c){var d={head:a,options:w,get:b,getJSON:x,post:v,postJSON:t};null!==u&&(u=c);return d})})();
new function(){function l(a,b){function c(){}c.prototype=b.prototype;a.m=b.prototype;a.prototype=new c;a.prototype.constructor=a;a.l=function(a,c,d){for(var g=Array(arguments.length-2),h=2;h<arguments.length;h++)g[h-2]=arguments[h];return b.prototype[c].apply(a,g)}}function p(a){if(Error.captureStackTrace)Error.captureStackTrace(this,p);else{var b=Error().stack;b&&(this.stack=b)}a&&(this.message=String(a))}function k(a,b){this.code=a;this.text=null!=b?b:"";p.call(this,b)}function h(){g=d.createLogger("extv/program_guide/v1",
"api");g.info("ExTV Program Guide API Loaded")}function m(a,g,k,l){q=a;b=g;d=k;c=l;return new h}l(p,Error);p.prototype.name="CustomError";l(k,p);k.prototype.name="ExTVPGError";var g,d,c,q,b,a=["inflight","extv","programGuide","v1","Api"],w=this;a[0]in w||!w.execScript||w.execScript("var "+a[0]);for(var x;a.length&&(x=a.shift());)a.length||void 0===h?w[x]?w=w[x]:w=w[x]={}:w[x]=h;h.prototype.Events={CHANNEL_CHANGED:"channel_changed"};h.prototype.Events=h.prototype.Events;h.prototype.a={UNKNOWN:10001,
INVALID_ARGUMENTS:10002};h.prototype.ErrorType=h.prototype.a;h.prototype.isCommissioned=function(a){c.isCommissioned(function(b,c){b?a({code:b.code,text:""},null):a(null,c)})};h.prototype.isCommissioned=h.prototype.isCommissioned;h.prototype.b=function(a){g.info("getAvailableChannels");q.getJSON({url:window.InFlight.makeServiceURL("/extv/v2/channels")},function(b,c){b?a({code:b.code,text:""},null):200!==c.code?a({code:c.code,text:""},null):a(null,c.body.data)})};h.prototype.getAvailableChannels=h.prototype.b;
h.prototype.g=function(a){g.info("getNowPlayingPrograms");q.getJSON({url:window.InFlight.makeServiceURL("/extv/v2/search"),query:{end_data_limit:0}},function(b,c){b?a({code:b.code,text:""},null):200!==c.code?a({code:c.code,text:""},null):a(null,c.body.data)})};h.prototype.getNowPlayingPrograms=h.prototype.g;h.prototype.h=function(a,b){g.info("getProgramsPlayingAtDate");a?q.getJSON({url:window.InFlight.makeServiceURL("/extv/v2/search"),query:a},function(a,c){a?b({code:a.code,text:""},null):200!==c.code?
b({code:c.code,text:""},null):b(null,c.body.data)}):b(new k(10002),null)};h.prototype.getProgramsPlayingAtDate=h.prototype.h;h.prototype.i=function(a,b){g.info("searchProgramsByFields");a?q.getJSON({url:window.InFlight.makeServiceURL("/extv/v2/search"),query:a},function(a,c){a?b({code:a.code,text:""},null):200!==c.code?b({code:c.code,text:""},null):b(null,c.body.data)}):b(new k(10002),null)};h.prototype.searchProgramsByFields=h.prototype.i;h.prototype.j=function(a,b){g.info("searchProgramsByText");
a?q.getJSON({url:window.InFlight.makeServiceURL("/extv/v2/search"),query:a},function(a,c){a?b({code:a.code,text:""},null):200!==c.code?b({code:c.code,text:""},null):b(null,c.body.data)}):b(new k(10002),null)};h.prototype.searchProgramsByText=h.prototype.j;h.prototype.c=function(a,b){g.info("getAvailablePrograms");q.getJSON({url:window.InFlight.makeServiceURL("/extv/v2/programs"),query:a},function(a,c){a?b({code:a.code,text:""},null):200!==c.code?b({code:c.code,text:""},null):b(null,c.body.data)})};
h.prototype.getAvailablePrograms=h.prototype.c;h.prototype.f=function(a){g.info("getChannelCategories");q.getJSON({url:window.InFlight.makeServiceURL("/extv/v2/categories")},function(b,c){b?a({code:b.code,text:""},null):200!==c.code?a({code:c.code,text:""},null):a(null,c.body.data)})};h.prototype.getChannelCategories=h.prototype.f;h.prototype.addEventListener=function(a,c){g.info("add event listener - "+a);b.register({event_name:a,namespace:"core.extv_metadata",callback:function(a){c(a,null)}})};
h.prototype.addEventListener=h.prototype.addEventListener;h.prototype.getRequiredSoftwareForMedia=function(a,b){g.info("getRequiredSoftwareForMedia");c.getRequiredSoftwareForMedia(a,function(a,c){a?b({code:a.code,text:""},null):b(null,c)})};h.prototype.getRequiredSoftwareForMedia=h.prototype.getRequiredSoftwareForMedia;h.factory=m;window.InFlight.define("extv/program_guide/v1",["sdk/v1/http","sdk/v1/event","sdk/v1/logger","extv_metadata/v1"],m)};
(function(){function l(a){return void 0!==a}function p(){}function k(a){var b=typeof a;if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&
!a.propertyIsEnumerable("call"))return"function"}else return"null";else if("function"==b&&"undefined"==typeof a.call)return"object";return b}function h(a){return"array"==k(a)}function m(a){return"string"==typeof a}function g(a){return"function"==k(a)}function d(a,b,c){return a.call.apply(a.bind,arguments)}function c(a,b,c){if(!a)throw Error();if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(c,
d);return a.apply(b,c)}}return function(){return a.apply(b,arguments)}}function q(a,b,e){q=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?d:c;return q.apply(null,arguments)}function b(a,b){function c(){}c.prototype=b.prototype;a.T=b.prototype;a.prototype=new c;a.prototype.constructor=a;a.za=function(a,c,d){for(var e=Array(arguments.length-2),g=2;g<arguments.length;g++)e[g-2]=arguments[g];return b.prototype[c].apply(a,e)}}function a(a){return/^\s*$/.test(a)?
!1:/^[\],:{}\s\u2028\u2029]*$/.test(a.replace(/\\["\\\/bfnrtu]/g,"@").replace(/(?:"[^"\\\n\r\u2028\u2029\x00-\x08\x0a-\x1f]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?)[\s\u2028\u2029]*(?=:|,|]|}|$)/g,"]").replace(/(?:^|:|,)(?:[\s\u2028\u2029]*\[)+/g,""))}function w(b){b=String(b);if(a(b))try{return eval("("+b+")")}catch(c){}throw Error("Invalid JSON string: "+b);}function x(a){var b=[];t(new v,a,b);return b.join("")}function v(){}function t(a,b,c){if(null==b)c.push("null");else{if("object"==
typeof b){if(h(b)){var d=b;b=d.length;c.push("[");for(var e="",g=0;g<b;g++)c.push(e),t(a,d[g],c),e=",";c.push("]");return}if(b instanceof String||b instanceof Number||b instanceof Boolean)b=b.valueOf();else{c.push("{");e="";for(d in b)Object.prototype.hasOwnProperty.call(b,d)&&(g=b[d],"function"!=typeof g&&(c.push(e),n(d,c),c.push(":"),t(a,g,c),e=","));c.push("}");return}}switch(typeof b){case "string":n(b,c);break;case "number":c.push(isFinite(b)&&!isNaN(b)?String(b):"null");break;case "boolean":c.push(String(b));
break;case "function":c.push("null");break;default:throw Error("Unknown type: "+typeof b);}}}function n(a,b){b.push('"',a.replace(Wc,function(a){var b=rc[a];b||(b="\\u"+(a.charCodeAt(0)|65536).toString(16).substr(1),rc[a]=b);return b}),'"')}function z(a){a=fa.getData(a);return l(a)?a:null}function y(a,b){m(b)&&(b=b.trim());fa.setData(a,b);C(a)}function u(a,b){null!==b?(fa.setData(a,b.toString()),C(a)):(fa.deleteData(a),F(a))}function C(a){var b=w(fa.getData("inflight.survey.keys"));null===b&&(b=[]);
0>b.indexOf(a)&&(b.push(a),fa.setData("inflight.survey.keys",x(b)))}function F(a){for(var b=w(fa.getData("inflight.survey.keys")),c=[],d=0;d<b.length;d++)b[d]!==a&&c.push(b[d]);fa.setData("inflight.survey.keys",x(c))}function e(a){if(Error.captureStackTrace)Error.captureStackTrace(this,e);else{var b=Error().stack;b&&(this.stack=b)}a&&(this.message=String(a))}function r(a,b){return a<b?-1:a>b?1:0}function A(){0!=sc&&(tc[this[vb]||(this[vb]=++uc)]=this);this.u=this.u;this.w=this.w}function Z(a,b,c,
d,e){this.listener=a;this.a=null;this.src=b;this.type=c;this.M=!!d;this.P=e;++Xc;this.G=this.L=!1}function W(a){a.G=!0;a.listener=null;a.a=null;a.src=null;a.P=null}function oa(a,b){for(var c,d,e=1;e<arguments.length;e++){d=arguments[e];for(c in d)a[c]=d[c];for(var g=0;g<vc.length;g++)c=vc[g],Object.prototype.hasOwnProperty.call(d,c)&&(a[c]=d[c])}}function T(a){return Array.prototype.concat.apply(Array.prototype,arguments)}function ea(a){this.src=a;this.a={};this.b=0}function J(a,b,c,d,e){var g=b.toString();
(b=a.a[g])||(b=a.a[g]=[],a.b++);var h=X(b,c,d,e);-1<h?(a=b[h],a.L=!1):(a=new Z(c,a.src,g,!!d,e),a.L=!1,b.push(a));return a}function Q(a,b){var c=b.type;if(c in a.a){var d=a.a[c],e=Ob(d,b),g;(g=0<=e)&&Array.prototype.splice.call(d,e,1);g&&(W(b),a.a[c].length||(delete a.a[c],a.b--))}}function X(a,b,c,d){for(var e=0;e<a.length;++e){var g=a[e];if(!g.G&&g.listener==b&&g.M==!!c&&g.P==d)return e}return-1}function N(a,b){this.type=a;this.a=this.b=b;this.Z=!0}function B(a){return-1!=Za.indexOf(a)}function L(a){L[" "](a);
return a}function ra(){var a=aa.document;return a?a.documentMode:void 0}function da(a,b){N.call(this,a?a.type:"");this.g=this.a=this.b=null;if(a){this.type=a.type;this.b=a.target||a.srcElement;this.a=b;var c=a.relatedTarget;if(c&&wc)try{L(c.nodeName)}catch(d){}this.g=a;a.defaultPrevented&&this.c()}}function na(a,b,c,d,e){if(h(b))for(var g=0;g<b.length;g++)na(a,b[g],c,d,e);else if(c=Ea(c),a&&a[wb])J(a.s,String(b),c,d,e);else{if(!b)throw Error("Invalid event type");var g=!!d,k=E(a);k||(a[Pb]=k=new ea(a));
c=J(k,b,c,d,e);if(!c.a){d=qa();c.a=d;d.src=a;d.listener=c;if(a.addEventListener)a.addEventListener(b.toString(),d,g);else if(a.attachEvent)a.attachEvent(D(b.toString()),d);else throw Error("addEventListener and attachEvent are unavailable.");xc++}}}function qa(){var a=la,b=yc?function(c){return a.call(b.src,b.listener,c)}:function(c){c=a.call(b.src,b.listener,c);if(!c)return c};return b}function I(a,b,c,d,e){if(h(b))for(var g=0;g<b.length;g++)I(a,b[g],c,d,e);else(c=Ea(c),a&&a[wb])?(a=a.s,b=String(b).toString(),
b in a.a&&(g=a.a[b],c=X(g,c,d,e),-1<c&&(W(g[c]),Array.prototype.splice.call(g,c,1),g.length||(delete a.a[b],a.b--)))):a&&(a=E(a))&&(b=a.a[b.toString()],a=-1,b&&(a=X(b,c,!!d,e)),(c=-1<a?b[a]:null)&&ka(c))}function ka(a){if("number"!=typeof a&&a&&!a.G){var b=a.src;if(b&&b[wb])Q(b.s,a);else{var c=a.type,d=a.a;b.removeEventListener?b.removeEventListener(c,d,a.M):b.detachEvent&&b.detachEvent(D(c),d);xc--;(c=E(b))?(Q(c,a),c.b||(c.src=null,b[Pb]=null)):W(a)}}}function D(a){return a in Qb?Qb[a]:Qb[a]="on"+
a}function ba(a,b,c,d){var e=!0;if(a=E(a))if(b=a.a[b.toString()])for(b=b.concat(),a=0;a<b.length;a++){var g=b[a];g&&g.M==c&&!g.G&&(g=U(g,d),e=e&&!1!==g)}return e}function U(a,b){var c=a.listener,d=a.P||a.src;a.L&&ka(a);return c.call(d,b)}function la(a,b){if(a.G)return!0;if(!yc){var c;if(!(c=b))a:{c=["window","event"];for(var d=aa,e;e=c.shift();)if(null!=d[e])d=d[e];else{c=null;break a}c=d}e=c;c=new da(e,this);d=!0;if(!(0>e.keyCode||void 0!=e.returnValue)){a:{var g=!1;if(!e.keyCode)try{e.keyCode=-1;
break a}catch(h){g=!0}if(g||void 0==e.returnValue)e.returnValue=!0}e=[];for(g=c.a;g;g=g.parentNode)e.push(g);for(var g=a.type,k=e.length-1;0<=k;k--){c.a=e[k];var l=ba(e[k],g,!0,c),d=d&&l}for(k=0;k<e.length;k++)c.a=e[k],l=ba(e[k],g,!1,c),d=d&&l}return d}return U(a,new da(b,this))}function E(a){a=a[Pb];return a instanceof ea?a:null}function Ea(a){if(g(a))return a;a[Rb]||(a[Rb]=function(b){return a.handleEvent(b)});return a[Rb]}function M(){A.call(this);this.s=new ea(this);this.R=this;this.B=null}function ta(a,
b){var c,d=a.B;if(d)for(c=[];d;d=d.B)c.push(d);var d=a.R,e=b,g=e.type||e;if(m(e))e=new N(e,d);else if(e instanceof N)e.b=e.b||d;else{var h=e,e=new N(g,d);oa(e,h)}var h=!0,k;if(c)for(var l=c.length-1;0<=l;l--)k=e.a=c[l],h=Ca(k,g,!0,e)&&h;k=e.a=d;h=Ca(k,g,!0,e)&&h;h=Ca(k,g,!1,e)&&h;if(c)for(l=0;l<c.length;l++)k=e.a=c[l],h=Ca(k,g,!1,e)&&h}function Ca(a,b,c,d){b=a.s.a[String(b)];if(!b)return!0;b=b.concat();for(var e=!0,g=0;g<b.length;++g){var h=b[g];if(h&&!h.G&&h.M==c){var k=h.listener,l=h.P||h.src;h.L&&
Q(a.s,h);e=!1!==k.call(l,d)&&e}}return e&&0!=d.Z}function Da(a){M.call(this);this.surveyId=a.survey_id;this.K=l(a.title)?a.title:null;this.ea=l(a.short_description)?a.short_description:null;this.ya=l(a.long_description)?a.long_description:null;this.o=l(a.conclusion_text)?a.conclusion_text:null;this.f=h(a.images)?a.images:null;y("inflight.survey.currentFlightId",hb);this.i="inflight.survey."+hb+"."+this.surveyId;this.a=parseInt(fa.getData(this.i+".currentCollectionIndex"),10);isNaN(this.a)&&(this.a=
0);l(Sb)||(Sb=Y.createLogger("survey/v1","inflight.survey.v1.survey.AbstractSurvey"));Sb.info("loaded, survey id = "+this.surveyId)}function Wa(a,b){a.a=b;u(a.i+".currentCollectionIndex",b)}function wa(a,b){N.call(this,a,b)}function ja(a,b){M.call(this);this.text=l(a.text)?a.text:null;this.id=a.answer_id;this.a=b;l(Tb)||(Tb=Y.createLogger("survey/v1","inflight.survey.v1.answer.AbstractAnswer"));Tb.info("loaded, answer id = "+this.id)}function Na(a,b,c){this.g=c;this.c=a;this.f=b;this.b=0;this.a=null}
function fb(a,b){a.f(b);a.b<a.g&&(a.b++,b.next=a.a,a.a=b)}function Ga(){var a=zc,b=null;a.a&&(b=a.a,a.a=a.a.next,a.a||(a.b=null),b.next=null);return b}function Ka(){this.next=this.b=this.a=null}function xa(a){aa.setTimeout(function(){throw a;},0)}function ub(){var a=aa.MessageChannel;"undefined"===typeof a&&"undefined"!==typeof window&&window.postMessage&&window.addEventListener&&!B("Presto")&&(a=function(){var a=document.createElement("IFRAME");a.style.display="none";a.src="";document.documentElement.appendChild(a);
var b=a.contentWindow,a=b.document;a.open();a.write("");a.close();var c="callImmediate"+Math.random(),d="file:"==b.location.protocol?"*":b.location.protocol+"//"+b.location.host,a=q(function(a){if(("*"==d||a.origin==d)&&a.data==c)this.port1.onmessage()},this);b.addEventListener("message",a,!1);this.port1={};this.port2={postMessage:function(){b.postMessage(c,d)}}});if("undefined"!==typeof a&&!B("Trident")&&!B("MSIE")){var b=new a,c={},d=c;b.port1.onmessage=function(){if(l(c.next)){c=c.next;var a=c.X;
c.X=null;a()}};return function(a){d.next={X:a};d=d.next;b.port2.postMessage(0)}}return"undefined"!==typeof document&&"onreadystatechange"in document.createElement("SCRIPT")?function(a){var b=document.createElement("SCRIPT");b.onreadystatechange=function(){b.onreadystatechange=null;b.parentNode.removeChild(b);b=null;a();a=null};document.documentElement.appendChild(b)}:function(a){aa.setTimeout(a,0)}}function Pa(a,b){xb||Va();Ub||(xb(),Ub=!0);var c=zc,d=Ac.get();d.set(a,b);c.b?c.b.next=d:c.a=d;c.b=
d}function Va(){if(aa.Promise&&aa.Promise.resolve){var a=aa.Promise.resolve(void 0);xb=function(){a.then(H)}}else xb=function(){var a=H;!g(aa.setImmediate)||aa.Window&&aa.Window.prototype&&!B("Edge")&&aa.Window.prototype.setImmediate==aa.setImmediate?(Vb||(Vb=ub()),Vb(a)):aa.setImmediate(a)}}function H(){for(var a;a=Ga();){try{a.a.call(a.b)}catch(b){xa(b)}fb(Ac,a)}Ub=!1}function gb(a){a.prototype.then=a.prototype.then;a.prototype.$goog_Thenable=!0}function ia(a){if(!a)return!1;try{return!!a.$goog_Thenable}catch(b){return!1}}
function O(a,b){this.a=Qa;this.u=void 0;this.g=this.b=this.c=null;this.f=this.i=!1;if(a!=p)try{var c=this;a.call(b,function(a){Fa(c,yb,a)},function(a){if(!(a instanceof Ua))try{if(a instanceof Error)throw a;throw Error("Promise rejected.");}catch(b){}Fa(c,Ha,a)})}catch(d){Fa(this,Ha,d)}}function S(){this.next=this.c=this.b=this.g=this.a=null;this.f=!1}function eb(a,b,c){var d=Bc.get();d.g=a;d.b=b;d.c=c;return d}function ca(a,b){if(a.a==Qa)if(a.c){var c=a.c;if(c.b){for(var d=0,e=null,g=null,h=c.b;h&&
(h.f||(d++,h.a==a&&(e=h),!(e&&1<d)));h=h.next)e||(g=h);e&&(c.a==Qa&&1==d?ca(c,b):(g?(d=g,d.next==c.g&&(c.g=d),d.next=d.next.next):Oa(c),Ya(c,e,Ha,b)))}a.c=null}else Fa(a,Ha,b)}function Xa(a,b){a.b||a.a!=yb&&a.a!=Ha||a.i||(a.i=!0,Pa(a.j,a));a.g?a.g.next=b:a.b=b;a.g=b}function ma(a,b,c,d){var e=eb(null,null,null);e.a=new O(function(a,g){e.g=b?function(c){try{var e=b.call(d,c);a(e)}catch(h){g(h)}}:a;e.b=c?function(b){try{var e=c.call(d,b);!l(e)&&b instanceof Ua?g(b):a(e)}catch(h){g(h)}}:g});e.a.c=a;
Xa(a,e);return e.a}function Fa(a,b,c){if(a.a==Qa){a===c&&(b=Ha,c=new TypeError("Promise cannot resolve to itself"));a.a=1;var d;a:{var e=c,h=a.o,k=a.w;if(e instanceof O)Xa(e,eb(h||p,k||null,a)),d=!0;else if(ia(e))e.then(h,k,a),d=!0;else{var l=typeof e;if("object"==l&&null!=e||"function"==l)try{var m=e.then;if(g(m)){K(e,m,h,k,a);d=!0;break a}}catch(n){k.call(a,n);d=!0;break a}d=!1}}d||(a.u=c,a.a=b,a.c=null,a.i||(a.i=!0,Pa(a.j,a)),b!=Ha||c instanceof Ua||Uc(a,c))}}function K(a,b,c,d,e){function g(a){k||
(k=!0,d.call(e,a))}function h(a){k||(k=!0,c.call(e,a))}var k=!1;try{b.call(a,h,g)}catch(l){g(l)}}function Oa(a){var b=null;a.b&&(b=a.b,a.b=b.next,b.next=null);a.b||(a.g=null);return b}function Ya(a,b,c,d){if(c==Ha&&b.b&&!b.f)for(;a&&a.f;a=a.c)a.f=!1;if(b.a)b.a.c=null,oc(b,c,d);else try{b.f?b.g.call(b.c):oc(b,c,d)}catch(e){Cc.call(null,e)}fb(Bc,b)}function oc(a,b,c){b==yb?a.g.call(a.c,c):a.b&&a.b.call(a.c,c)}function Uc(a,b){a.f=!0;Pa(function(){a.f&&Cc.call(null,b)})}function Ua(a){e.call(this,a)}
function Ia(a,b,c){A.call(this);this.o=null!=c?q(a,c):a;this.j=b;this.f=q(this.B,this);this.c=[]}function pc(a){var b;b=a.f;var c=a.j;if(!g(b))if(b&&"function"==typeof b.handleEvent)b=q(b.handleEvent,b);else throw Error("Invalid listener argument");b=2147483647<Number(c)?-1:aa.setTimeout(b,c||0);a.a=b;a.o.apply(null,a.c)}function tb(a,b){this.answer_id=a;this.answer_text=l(b)?b:void 0;l(Wb)||(Wb=Y.createLogger("survey/v1","inflight.survey.v1.answer.AnswerResponseVO"));Wb.info("created "+x(arguments))}
function db(a,b,c){this.qid=a;this.question_type=b;this.answers=l(c)?c:[]}function Vc(a,b){this.surveyId=a;this.response=l(b)?b:[];l(Xb)||(Xb=Y.createLogger("survey/v1","inflight.survey.v1.survey.SurveyResponseVO"));Xb.info("created",this)}function pa(a,b){ja.call(this,a,b);l(zb)||(zb=Y.createLogger("survey/v1","inflight.survey.v1.answer.MultipleChoiceAnswer"));zb.info("loaded, answer id = "+a.answer_id);this.v="1"===fa.getData(this.a)?!0:!1}function Ja(a,b){this.D={};this.m=[];this.a=0;var c=arguments.length;
if(1<c){if(c%2)throw Error("Uneven number of arguments");for(var d=0;d<c;d+=2)this.set(arguments[d],arguments[d+1])}else if(a){var e;if(a instanceof Ja)for(qc(a),d=a.m.concat(),qc(a),e=[],c=0;c<a.m.length;c++)e.push(a.D[a.m[c]]);else{var c=[],g=0;for(d in a)c[g++]=d;d=c;c=[];g=0;for(e in a)c[g++]=a[e];e=c}for(c=0;c<d.length;c++)this.set(d[c],e[c])}}function qc(a){if(a.a!=a.m.length){for(var b=0,c=0;b<a.m.length;){var d=a.m[b];Object.prototype.hasOwnProperty.call(a.D,d)&&(a.m[c++]=d);b++}a.m.length=
c}if(a.a!=a.m.length){for(var e={},c=b=0;b<a.m.length;)d=a.m[b],Object.prototype.hasOwnProperty.call(e,d)||(a.m[c++]=d,e[d]=1),b++;a.m.length=c}}function ua(a,b){ja.call(this,a,b);l(Ab)||(Ab=Y.createLogger("survey/v1","inflight.survey.v1.answer.FreeTextAnswer"));Ab.info("loaded, answer id = "+a.answer_id);this.b=z(this.a)}function va(a,b){pa.call(this,a,b);l(Bb)||(Bb=Y.createLogger("survey/v1","inflight.survey.v1.answer.MultipleChoiceOtherAnswer"));Bb.info("loaded, answer id = "+a.answer_id);this.b=
z(this.a+".text")}function ya(a,b){ja.call(this,a,b);l(Cb)||(Cb=Y.createLogger("survey/v1","inflight.survey.v1.answer.OrdinalAnswer"));Cb.info("loaded, answer id = "+a.answer_id);this.index=parseInt(fa.getData(this.a),10)}function V(a,b){M.call(this);l(Db)||(Db=Y.createLogger("survey/v1","inflight.survey.v1.question.AbstractQuestion"));Db.info("loaded, question id = "+a.qid);this.j=b;this.f=h(a.images)?a.images:null;this.text=l(a.question_text)?a.question_text:null;this.b=l(a.required)?a.required:
!1;this.id=a.qid}function ha(a,b){V.call(this,a,b);l(Ra)||(Ra=Y.createLogger("survey/v1","inflight.survey.v1.question.ScaleQuestion"));Ra.info("loaded, question id = "+a.qid);this.c=[];if(l(a.answers)&&h(a.answers))for(var c=0;c<a.answers.length;c++)this.c.push(a.answers[c].text);this.a=[];if(h(a.sub_questions))for(var d=0;d<a.sub_questions.length;d++)a.sub_questions[d].answers=a.answers,a.sub_questions[d].question_type="mcq",c=Yb(a.sub_questions[d],b),J(c.s,"answer_change",this.i,!1,this),this.a.push(c);
else c=Yb({qid:a.qid,question_type:"mcq",question_text:"",required:a.required,answers:a.answers},b),J(c.s,"answer_change",this.i,!1,this),this.a.push(c)}function ib(a,b){ha.call(this,a,b);l(Zb)||(Zb=Y.createLogger("survey/v1","inflight.survey.v1.question.SemanticDifferentialQuestion"));Zb.info("loaded, question id = "+a.qid)}function sa(a,b){V.call(this,a,b);l($b)||($b=Y.createLogger("survey/v1","inflight.survey.v1.question.NonScaleQuestion"));$b.info("loaded, question id = "+a.qid);this.answers=
[];if(h(a.answers))for(var c=0;c<a.answers.length;c++){var d;d=a;var e=a.answers[c],g=d.qid+"_"+e.answer_id,k=b+"."+e.answer_id;l(ac)||(ac=Y.createLogger("survey/v1","inflight.survey.v1.answer.AnswerFactory"));ac.info("createFromJSON for question/answer key = "+g);var g=d.question_type,m=null;"mcqOther"===g&&Ob(d.answers,e)<d.answers.length-1&&(g="mcq");"mcqOtherMany"===g&&Ob(d.answers,e)<d.answers.length-1&&(g="mcqMany");switch(g){case "mcq":case "mcqMany":case "likertScale":case "semanticDifferentialScale":m=
new pa(e,k);break;case "mcqOther":case "mcqOtherMany":m=new va(e,k);break;case "freeTextResponse":m=new ua(e,k);break;case "ordinalResponse":m=new ya(e,k)}d=m?m:void 0;J(d.s,"answer_change",this.o,!1,this);this.answers.push(d)}}function za(a,b){sa.call(this,a,b);l(Sa)||(Sa=Y.createLogger("survey/v1","inflight.survey.v1.question.MultipleChoiceQuestion"));Sa.info("loaded, question id = "+a.qid);this.K=a.question_type;this.c=null;switch(a.question_type){case "mcqOther":case "mcq":this.i="RADIO";break;
case "mcqOtherMany":case "mcqMany":this.i="CHECKBOX";break;default:this.i="RADIO"}if("RADIO"===this.i)for(var c=this.A(),d=0;d<c.length;d++)if(c[d].v){this.c=c[d];break}}function La(a,b){sa.call(this,a,b);l(jb)||(jb=Y.createLogger("survey/v1","inflight.survey.v1.question.OrdinalQuestion"));jb.info("loaded, question id = "+a.qid)}function kb(a,b){ha.call(this,a,b);l(bc)||(bc=Y.createLogger("survey/v1","inflight.survey.v1.question.LikertQuestion"));bc.info("loaded, question id = "+a.qid)}function Ta(a,
b){sa.call(this,a,b);l(Eb)||(Eb=Y.createLogger("survey/v1","inflight.survey.v1.question.FreeTextQuestion"));Eb.info("loaded, question id = "+a.qid)}function Yb(a,b){l(cc)||(cc=Y.createLogger("survey/v1","inflight.survey.v1.question.QuestionFactory"));cc.info("createFromJSON for question id = "+a.qid);var c=null,d=b+"."+a.qid;switch(a.question_type){case "mcq":case "mcqOther":case "mcqMany":case "mcqOtherMany":c=new za(a,d);break;case "freeTextResponse":c=new Ta(a,d);break;case "ordinalResponse":c=
new La(a,d);break;case "likertScale":c=new kb(a,d);break;case "semanticDifferentialScale":c=new ib(a,d)}return c}function lb(a,b){this.text=a.collection_text;if(h(a.questions))for(var c=0;c<a.questions.length;c++)this.push(Yb(a.questions[c],b))}function dc(a,b){N.call(this,a,b)}function G(a){Da.call(this,a);this.j=new Ia(this.da,6E4,this);this.b=[];this.c=!1;mb.addEventListener(mb.PAGE_UNLOAD,q(this.ca,this));mb.addEventListener(mb.PAGE_HIDDEN,q(this.aa,this));l(P)||(P=Y.createLogger("survey/v1",
"inflight.survey.v1.survey.SequentialSurvey"));P.info("loaded, Survey id = "+this.surveyId);var b,c,d,e;if(h(a.collections)){for(c=0;c<a.collections.length;c++){b=new lb(a.collections[c],this.i);for(d=0;d<b.length;d++)e=b[d],J(e.s,"answer_change",this.xa,!1,this);this.b.push(b)}this.c=this.F()}else P.error("No collections defined")}function Dc(a,b){l($a)||($a=Y.createLogger("survey/v1","inflight.survey.v1.question.SurveyFactory"));var c=a+(b?"_"+b:"");$a.info("createSurveyAdaptor, survey id = "+a+
", lang = "+b);return Object.prototype.hasOwnProperty.call(ec.D,c)?ec.get(c):null}function Aa(a,b){this.code=a;this.text=null!=b?b:"";e.call(this,b)}function Ma(a,b){this.f=[];this.R=a;this.B=b||null;this.g=this.a=!1;this.c=void 0;this.o=this.K=this.u=!1;this.i=0;this.b=null;this.j=0}function ab(a,b,c){a.a=!0;a.c=c;a.g=!b;Ec(a)}function nb(a){if(a.a){if(!a.o)throw new Fb;a.o=!1}}function Fc(a,b,c){a.f.push([b,c,void 0]);a.a&&Ec(a)}function Gc(a){return Yc(a.f,function(a){return g(a[1])})}function Ec(a){if(a.i&&
a.a&&Gc(a)){var b=a.i,c=Gb[b];c&&(aa.clearTimeout(c.a),delete Gb[b]);a.i=0}a.b&&(a.b.j--,delete a.b);for(var b=a.c,d=c=!1;a.f.length&&!a.u;){var e=a.f.shift(),g=e[0],h=e[1],e=e[2];if(g=a.g?h:g)try{var k=g.call(e||a.B,b);l(k)&&(a.g=a.g&&(k==b||k instanceof Error),a.c=b=k);if(ia(b)||"function"===typeof aa.Promise&&b instanceof aa.Promise)d=!0,a.u=!0}catch(m){b=m,a.g=!0,Gc(a)||(c=!0)}}a.c=b;d&&(k=q(a.w,a,!0),d=q(a.w,a,!1),b instanceof Ma?(Fc(b,k,d),b.K=!0):b.then(k,d));c&&(b=new Hc(b),Gb[b.a]=b,a.i=
b.a)}function Fb(){e.call(this)}function ob(){e.call(this)}function Hc(a){this.a=aa.setTimeout(q(this.c,this),0);this.b=a}function R(){l(ga)||(ga=Y.createLogger("survey/v1","Api"));Ba=new Ma;ga.info("Survey API Loaded");fc.addEventListener(fc.NET_STATE_CHANGE,function(a){Hb="undefined"!==typeof a.online?a.online:null;ga.info("Network state is "+Hb,a);!0===Hb&&Zc()});pb.addEventListener(pb.Events.FLIGHT_ID,function(a){ga.info("Flight Id has changed",a);Ba.cancel();Ba=new Ma;Ic(a.data)});pb.flightId(function(a,
b){if(a){ga.error("Error getting flight id: "+a.code);qb=!1;Ib(null);var c=Ba;nb(c);ab(c,!1,void 0)}else Ic(b)})}function Ib(a){hb="undefined"!==typeof a&&null!==a?a:null;a=z("inflight.survey.currentFlightId");if("string"===typeof a&&a!==hb){a=w(fa.getData("inflight.survey.keys"));if(null!==a){for(var b=0;b<a.length;b++)fa.deleteData(a[b]);fa.deleteData("inflight.survey.keys")}ga.info("Flight Id changed - flush storage")}}function Ic(a){pb.flightState(function(b,c){if(b){ga.error("Error getting flight state: "+
b.code);qb=!1;Ib(null);var d=Ba;nb(d);ab(d,!1,void 0)}else c?(ga.info("Flight Id is "+a),qb=!0,Ib(a),hb&&$c&&(ga.info("Survey Service is available"),d=Ba,nb(d),ab(d,!0,void 0))):(ga.warn("Flight is closed"),qb=!1,Ib(null),d=Ba,nb(d),ab(d,!1,void 0))})}function Zc(){var a=z("inflight.survey.keys");if(null!=a){for(var a=w(a),b=[],c=[],d=0;d<a.length;d++){var e=a[d].split(".");"pendingSave"!==e[e.length-1]||b[e[3]]||(b[e[3]]=!0,c.push(e[3]))}0<c.length&&(ga.info("Found pendingSave answers",c),R.prototype.Y({lang:"eng",
"class":"ped",ids:c},function(a,b){if(a)ga.error("There was an error getting surveys details for the requested survey id's: "+a.code,"error");else for(var c=0;c<b.length;c++)b[c].submit()}))}}var aa=this,vb="closure_uid_"+(1E9*Math.random()>>>0),uc=0,rc={'"':'\\"',"\\":"\\\\","/":"\\/","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\x0B":"\\u000b"},Wc=/\uffff/.test("\uffff")?/[\\\"\x00-\x1f\x7f-\uffff]/g:/[\\\"\x00-\x1f\x7f-\xff]/g;b(e,Error);e.prototype.name="CustomError";var Jc=String.prototype.trim?
function(a){return a.trim()}:function(a){return a.replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")},sc=0,tc={};A.prototype.u=!1;A.prototype.dispose=function(){if(!this.u&&(this.u=!0,this.g(),0!=sc)){var a=this[vb]||(this[vb]=++uc);delete tc[a]}};A.prototype.g=function(){if(this.w)for(;this.w.length;)this.w.shift()()};var wb="closure_listenable_"+(1E6*Math.random()|0),Xc=0,vc="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" "),Ob=Array.prototype.indexOf?function(a,
b,c){return Array.prototype.indexOf.call(a,b,c)}:function(a,b,c){c=null==c?0:0>c?Math.max(0,a.length+c):c;if(m(a))return m(b)&&1==b.length?a.indexOf(b,c):-1;for(;c<a.length;c++)if(c in a&&a[c]===b)return c;return-1},Yc=Array.prototype.some?function(a,b,c){return Array.prototype.some.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=m(a)?a.split(""):a,g=0;g<d;g++)if(g in e&&b.call(c,e[g],g,a))return!0;return!1};N.prototype.c=function(){this.Z=!1};var Za;a:{var Kc=aa.navigator;if(Kc){var Lc=Kc.userAgent;
if(Lc){Za=Lc;break a}}Za=""}L[" "]=p;var ad=B("Opera"),rb=B("Trident")||B("MSIE"),bd=B("Edge"),wc=B("Gecko")&&!(-1!=Za.toLowerCase().indexOf("webkit")&&!B("Edge"))&&!(B("Trident")||B("MSIE"))&&!B("Edge"),cd=-1!=Za.toLowerCase().indexOf("webkit")&&!B("Edge"),Jb;a:{var gc="",hc=function(){var a=Za;if(wc)return/rv\:([^\);]+)(\)|;)/.exec(a);if(bd)return/Edge\/([\d\.]+)/.exec(a);if(rb)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(a);if(cd)return/WebKit\/(\S+)/.exec(a);if(ad)return/(?:Version)[ \/]?(\S+)/.exec(a)}();
hc&&(gc=hc?hc[1]:"");if(rb){var ic=ra();if(null!=ic&&ic>parseFloat(gc)){Jb=String(ic);break a}}Jb=gc}var jc={},Mc,Nc=aa.document;Mc=Nc&&rb?ra()||("CSS1Compat"==Nc.compatMode?parseInt(Jb,10):5):void 0;var kc;(kc=!rb)||(kc=9<=Number(Mc));var yc=kc,lc;if(lc=rb){var mc;if(Object.prototype.hasOwnProperty.call(jc,"9"))mc=jc["9"];else{for(var Kb=0,Oc=Jc(String(Jb)).split("."),Pc=Jc("9").split("."),dd=Math.max(Oc.length,Pc.length),Lb=0;!Kb&&Lb<dd;Lb++){var Qc=Oc[Lb]||"",Rc=Pc[Lb]||"";do{var bb=/(\d*)(\D*)(.*)/.exec(Qc)||
["","","",""],cb=/(\d*)(\D*)(.*)/.exec(Rc)||["","","",""];if(0==bb[0].length&&0==cb[0].length)break;Kb=r(0==bb[1].length?0:parseInt(bb[1],10),0==cb[1].length?0:parseInt(cb[1],10))||r(0==bb[2].length,0==cb[2].length)||r(bb[2],cb[2]);Qc=bb[3];Rc=cb[3]}while(!Kb)}mc=jc["9"]=0<=Kb}lc=!mc}var ed=lc;b(da,N);da.prototype.c=function(){da.T.c.call(this);var a=this.g;if(a.preventDefault)a.preventDefault();else if(a.returnValue=!1,ed)try{if(a.ctrlKey||112<=a.keyCode&&123>=a.keyCode)a.keyCode=-1}catch(b){}};
var Pb="closure_lm_"+(1E6*Math.random()|0),Qb={},xc=0,Rb="__closure_events_fn_"+(1E9*Math.random()>>>0);b(M,A);M.prototype[wb]=!0;M.prototype.addEventListener=function(a,b,c,d){na(this,a,b,c,d)};M.prototype.removeEventListener=function(a,b,c,d){I(this,a,b,c,d)};M.prototype.g=function(){M.T.g.call(this);if(this.s){var a=this.s,b=0,c;for(c in a.a){for(var d=a.a[c],e=0;e<d.length;e++)++b,W(d[e]);delete a.a[c];a.b--}}this.B=null};var Sb;b(Da,M);Da.prototype.Events={NEXT_COLLECTION_AVAILABILITY_CHANGED:"next_collection_availability_changed",
SURVEY_COMPLETE:"survey_complete"};Da.prototype.Events=Da.prototype.Events;b(wa,N);var Tb;b(ja,M);ja.prototype.I=function(){return this.text};ja.prototype.getText=ja.prototype.I;ja.prototype.l=function(){return new tb(this.id)};Na.prototype.get=function(){var a;0<this.b?(this.b--,a=this.a,this.a=a.next,a.next=null):a=this.c();return a};var Ac=new Na(function(){return new Ka},function(a){a.reset()},100);Ka.prototype.set=function(a,b){this.a=a;this.b=b;this.next=null};Ka.prototype.reset=function(){this.next=
this.b=this.a=null};var Vb,xb,Ub=!1,zc=new function(){this.b=this.a=null},Qa=0,yb=2,Ha=3;S.prototype.reset=function(){this.c=this.b=this.g=this.a=null;this.f=!1};var Bc=new Na(function(){return new S},function(a){a.reset()},100);O.prototype.then=function(a,b,c){return ma(this,g(a)?a:null,g(b)?b:null,c)};gb(O);O.prototype.cancel=function(a){this.a==Qa&&Pa(function(){var b=new Ua(a);ca(this,b)},this)};O.prototype.o=function(a){this.a=Qa;Fa(this,yb,a)};O.prototype.w=function(a){this.a=Qa;Fa(this,Ha,
a)};O.prototype.j=function(){for(var a;a=Oa(this);)Ya(this,a,this.a,this.u);this.i=!1};var Cc=xa;b(Ua,e);Ua.prototype.name="cancel";b(Ia,A);Ia.prototype.b=!1;Ia.prototype.a=null;Ia.prototype.i=function(a){this.c=arguments;this.a?this.b=!0:pc(this)};Ia.prototype.g=function(){Ia.T.g.call(this);this.a&&(aa.clearTimeout(this.a),this.a=null,this.b=!1,this.c=[])};Ia.prototype.B=function(){this.a=null;this.b&&(this.b=!1,pc(this))};var Wb,Xb,zb;b(pa,ja);pa.prototype.h=function(){return"select"};pa.prototype.getType=
pa.prototype.h;pa.prototype.na=function(){return this.v};pa.prototype.getSelected=pa.prototype.na;pa.prototype.$=function(a){if(a!==this.v){zb.info("setSelected, dispatch answer change event");this.v=a;var b=this.a;a?(fa.setData(b,"1"),C(b)):(fa.deleteData(b),F(b));ta(this,new wa("answer_change",this))}};pa.prototype.setSelected=pa.prototype.$;Ja.prototype.get=function(a,b){return Object.prototype.hasOwnProperty.call(this.D,a)?this.D[a]:b};Ja.prototype.set=function(a,b){Object.prototype.hasOwnProperty.call(this.D,
a)||(this.a++,this.m.push(a));this.D[a]=b};Ja.prototype.clone=function(){return new Ja(this)};var Ab;b(ua,ja);ua.prototype.h=function(){return"text"};ua.prototype.getType=ua.prototype.h;ua.prototype.O=function(){return this.b};ua.prototype.getValue=ua.prototype.O;ua.prototype.V=function(a){a!==this.b&&(Ab.info("setValue, dispatch answer change event"),this.b=a,y(this.a,this.b),ta(this,new wa("answer_change",this)))};ua.prototype.setValue=ua.prototype.V;ua.prototype.l=function(){return new tb(this.id,
this.b)};var Bb;b(va,pa);va.prototype.h=function(){return"select_with_text"};va.prototype.getType=va.prototype.h;va.prototype.O=function(){return this.b};va.prototype.getValue=va.prototype.O;va.prototype.V=function(a){a!==this.b&&(Bb.info("setValue, dispatch answer change event"),this.b=a,y(this.a+".text",this.b),ta(this,new wa("answer_change",this)))};va.prototype.setValue=va.prototype.V;va.prototype.l=function(){return new tb(this.id,this.b)};var Cb;b(ya,ja);ya.prototype.h=function(){return"ordinal"};
ya.prototype.getType=ya.prototype.h;ya.prototype.ka=function(){return this.index};ya.prototype.getIndex=ya.prototype.ka;ya.prototype.S=function(a){a!==this.index&&(Cb.info("setIndex, dispatch answer change event"),this.index=a,u(this.a,a),ta(this,new wa("answer_change",this)))};ya.prototype.setIndex=ya.prototype.S;ya.prototype.l=function(){return isNaN(this.index)||null===this.index?null:new tb(this.id,String(this.index+1))};var ac;new Ja;var Db;b(V,M);V.prototype.U=function(a){if(h(this.f))for(var b=
0;b<this.f.length;b++)if(this.f[b].width==a.width&&this.f[b].height==a.height)return this.f[b].url;return null};V.prototype.getImageUrl=V.prototype.U;V.prototype.ua=function(){return this.b};V.prototype.isRequired=V.prototype.ua;V.prototype.I=function(){return this.text};V.prototype.getText=V.prototype.I;V.prototype.C=function(){return parseInt(fa.getData(this.j+".pendingSave"),10)};V.prototype.getPendingSave=V.prototype.C;V.prototype.H=function(){u(this.j+".pendingSave",(new Date).getTime())};V.prototype.setPendingSave=
V.prototype.H;V.prototype.N=function(a){parseInt(fa.getData(this.j+".pendingSave"),10)<a&&u(this.j+".pendingSave",null)};V.prototype.clearPendingSave=V.prototype.N;V.prototype.o=function(a){Db.info("answer change event handler",a);this.H();ta(this,new wa("answer_change",this))};var Ra;b(ha,V);ha.prototype.h=function(){};ha.prototype.ia=function(){return this.c};ha.prototype.getAnswerTitles=ha.prototype.ia;ha.prototype.qa=function(){return this.a};ha.prototype.getSubQuestions=ha.prototype.qa;ha.prototype.i=
function(){Ra.info("answer change event handler");this.H();ta(this,new wa("answer_change",this))};ha.prototype.l=function(){var a,b;if(this.C()){a=[];Ra.info("subquestions",this.a);for(var c=0;c<this.a.length;c++)this.a[c].C()&&(b=this.a[c].l())&&a.push(new db(this.a[c].id,this.h(),b.answers));if(0<a.length)return a}return null};ha.prototype.J=function(){var a,b=!0,c,d;if(this.b)for(c=0;b&&c<this.a.length;c++){a=this.a[c].A();for(d=0;d<a.length;d++)if(a[d].v){Ra.info("answer selected ["+a[d].v+"]");
break}d===a.length&&(Ra.info("scale isn't valid; index ["+d+"], length ["+a.length+"]"),b=!1)}return b};var Zb;b(ib,ha);ib.prototype.h=function(){return"semanticDifferentialScale"};ib.prototype.getType=ib.prototype.h;var $b;b(sa,V);sa.prototype.A=function(){return 0<this.answers.length?this.answers:null};sa.prototype.getAnswerOptions=sa.prototype.A;sa.prototype.h=function(){};sa.prototype.l=function(){};sa.prototype.J=function(){};var Sa;b(za,sa);za.prototype.h=function(){return"mcq"};za.prototype.getType=
za.prototype.h;za.prototype.oa=function(){return this.i};za.prototype.getSelectionType=za.prototype.oa;za.prototype.l=function(){var a,b=this.A();if(this.C()){a=[];for(var c=0;c<b.length;c++)b[c].v&&a.push(b[c].l());return new db(this.id,this.K,a)}return null};za.prototype.J=function(){var a,b=!0,c;if(this.b){a=this.A();for(c=0;c<a.length&&!a[c].v;c++);c===a.length&&(Sa.info("mcq isn't valid; index ["+c+"], length ["+a.length+"]"),b=!1)}return b};za.prototype.o=function(a){var b=a.b;Sa.info("answer change event handler",
b);"RADIO"===this.i&&b.v&&(Sa.info("item selected",this.c),this.c&&(Sa.info("unselect previous item"),this.c.$(!1)),this.c=b);za.T.o.call(this,a)};var jb;b(La,sa);La.prototype.h=function(){return"ordinalResponse"};La.prototype.getType=La.prototype.h;La.prototype.l=function(){var a,b,c=this.A();if(this.C()){a=[];for(var d=0;d<c.length;d++)(b=c[d].l())&&a.push(b);return this.b&&a.length!==this.answers.length?new db(this.id,this.h(),[]):new db(this.id,this.h(),a)}return null};La.prototype.J=function(){var a=
!0,b,c;if(this.b){for(b=0;b<this.answers.length&&(c=this.answers[b].index,!isNaN(c)&&null!==c);b++);b!==this.answers.length&&(jb.info("ordinal isn't valid; index ["+b+"], length ["+this.answers.length+"]"),a=!1)}return a};La.prototype.o=function(a){var b=a.b;null===sb&&(sb=b.id);var c,d,e;a=!1;jb.info("answer change event handler",b);b=[];for(c=0;c<this.answers.length;c++)b[c]=null;for(c=0;c<this.answers.length;c++)d=this.answers[c].index,isNaN(d)||null===d||(Array.isArray(b[d])||(b[d]=[]),b[d].push(this.answers[c]));
for(c=0;c<b.length;c++)if(!b[c])a=!0;else if(a){if(1===b[c].length){d=b[c][0].index;b[c][0].S(d-1);return}for(var g=0;g<b[c].length;g++)if(d=b[c][g].index,e=b[c][g].id,null!==d&&e!==sb){b[c][g].S(d-1);return}}else if(1!==b[c].length)for(g=0;g<b[c].length;g++)if(d=b[c][g].index,e=b[c][g].id,null!==d&&e!==sb){b[c][g].S(d+1);return}sb=null;this.b?c===this.answers.length&&this.H():this.H();ta(this,new wa("answer_change",this))};var sb=null,bc;b(kb,ha);kb.prototype.h=function(){return"likertScale"};kb.prototype.getType=
kb.prototype.h;var Eb;b(Ta,sa);Ta.prototype.h=function(){return"freeTextResponse"};Ta.prototype.getType=Ta.prototype.h;Ta.prototype.l=function(){var a,b=this.A();if(this.C()){a=[];for(var c=0;c<b.length;c++)a.push(b[c].l());if(0<a.length)return new db(this.id,this.h(),a)}return null};Ta.prototype.J=function(){var a,b=this.A();if(this.b)for(var c=0;c<b.length;c++)if(a=b[c].O(),null===a||!a.length)return Eb.info("text field not valid"),!1;return!0};var cc;new Ja;b(lb,Array);lb.prototype.I=function(){return this.text};
lb.prototype.getText=lb.prototype.I;b(dc,N);var P;b(G,Da);G.prototype.submit=function(a){var b=this,c,d=[],e=[],g;a=l(a)?a:!1;if(Hb&&qb)if(P.info("Ready to send, survey id = "+this.surveyId),h(this.b)){for(var k=(new Date).getTime(),m=0;m<this.b.length;m++)for(var n=0;n<this.b[m].length;n++){var ma=!1;c=this.b[m][n];if(c.C())if(c instanceof ha){if(g=c.l()){ma=!0;d.push(c);e=T(e,g);g=c.a;for(var p=0;p<g.length;p++)d.push(g[p])}}else if(g=c.l())ma=!0,d.push(c),e.push(g);ma||c.N(k)}0<d.length?(P.info("Submit, survey id = "+
this.surveyId),c={data:new Vc(this.surveyId,e)},Mb.postJSON({url:window.InFlight.makeServiceURL("/surveys/v1/survey_response"),headers:{"content-type":"application/json"},synchronous:a,data:x(c)},function(a,c){if(a)P.error("failed to save data",a);else if(200!==c.code)P.error("failed to save data, response code ["+c.code+"]");else if(c.body.error)P.error("failed to save data, response error code ["+c.body.error.code+"]");else{P.info("submitted successfully, id = "+b.surveyId);for(var e=0;e<d.length;e++){if(d[e]instanceof
ha)for(var g=d[e].a,h=0;h<g.length;h++)g[h].N(k);d[e].N(k)}}})):P.error("Found nothing to submit")}else P.error("No collections defined");else P.error("Not connected or flight state not valid")};G.prototype.ma=function(){return this.a<this.b.length?this.b[this.a]:null};G.prototype.getQuestions=G.prototype.ma;G.prototype.wa=function(a){var b=this;Ba.then(function(){Wa(b,0);a(null)},function(){a(new Aa(Nb))})};G.prototype.restart=G.prototype.wa;G.prototype.va=function(a){var b=this;Ba.then(function(){b.a?
(Wa(b,b.a-1),b.c=b.F(),a(null),b.submit()):(P.info("previous out of range"),a(new Aa(nc)))},function(){a(new Aa(Nb))})};G.prototype.previous=G.prototype.va;G.prototype.next=function(a){var b=this;Ba.then(function(){if(b.a<b.b.length)if(b.F()){for(var c=b.b[b.a],d=0;d<c.length;d++)"ordinalResponse"==c[d].h()&&(P.info("if question is ordinal then guarantee an answer is submitted"),c[d].H());Wa(b,b.a+1);b.c=b.F();P.info("next. New collectionIndex ["+b.a+"]");b.a==b.b.length&&(P.info("complete, dispatch SURVEY_COMPLETE event"),
ta(b,new dc("survey_complete",b)));a(null);b.submit()}else P.info("collection, requirements not met"),a(new Aa(Sc));else Wa(b,b.b.length),a(new Aa(nc))},function(){a(new Aa(Nb))})};G.prototype.next=G.prototype.next;G.prototype.F=function(){var a;P.info("is next available ["+this.a+"], length ["+this.b.length+"]");if(this.a<this.b.length){a=this.b[this.a];for(var b=0;b<a.length;b++)if(P.info("is question valid"),!a[b].J())return P.info("next is not available"),!1}P.info("next is available");return!0};
G.prototype.isNextAvailable=G.prototype.F;G.prototype.ta=function(){return 0<this.a?!0:!1};G.prototype.isPreviousAvailable=G.prototype.ta;G.prototype.sa=function(){return this.K};G.prototype.getTitle=G.prototype.sa;G.prototype.pa=function(){return this.ea};G.prototype.getShortDescription=G.prototype.pa;G.prototype.la=function(){return this.ya};G.prototype.getLongDescription=G.prototype.la;G.prototype.U=function(a){if(h(this.f))for(var b=0;b<this.f.length;b++)if(this.f[b].width==a.width&&this.f[b].height==
a.height)return this.f[b].url;return null};G.prototype.getImageUrl=G.prototype.U;G.prototype.ja=function(){return this.o};G.prototype.getConclusionText=G.prototype.ja;G.prototype.addEventListener=function(a,b){P.info("add event listener - "+a);J(this.s,String(a),b,void 0,void 0)};G.prototype.addEventListener=G.prototype.addEventListener;G.prototype.xa=function(){P.info("answer change event handler");var a=this.F();a!==this.c&&(P.info("dispatch next collection available event "+a+" "+this.c),this.c=
a,ta(this,new dc("next_collection_availability_changed",this)));this.j&&(P.info("throttle fire"),this.j.i())};G.prototype.da=function(){P.info("throttle has been triggered.  Save survey data if anything changed");this.submit()};G.prototype.ca=function(){P.info("Page is unloading.  Save survey data if anything changed");this.submit(!0)};G.prototype.aa=function(){P.info("Page is hidden.  Save survey data if anything changed");this.submit()};var $a,ec=new Ja,Nb=20003,nc=20004,Sc=20005,fd={UNKNOWN:20001,
SURVEY_EXPIRED:Nb,INDEX_OUT_OF_RANGE:nc,REQUIREMENTS_NOT_MET:Sc,SURVEY_SERVICE_UNAVAILABLE:20006};b(Aa,e);Aa.prototype.name="SurveyError";Ma.prototype.cancel=function(a){if(this.a)this.c instanceof Ma&&this.c.cancel();else{if(this.b){var b=this.b;delete this.b;a?b.cancel(a):(b.j--,0>=b.j&&b.cancel())}this.R?this.R.call(this.B,this):this.o=!0;this.a||(a=new ob,nb(this),ab(this,!1,a))}};Ma.prototype.w=function(a,b){this.u=!1;ab(this,a,b)};Ma.prototype.then=function(a,b,c){var d,e,g=new O(function(a,
b){d=a;e=b});Fc(this,d,function(a){a instanceof ob?g.cancel():e(a)});return g.then(a,b,c)};gb(Ma);b(Fb,e);Fb.prototype.message="Deferred has already fired";Fb.prototype.name="AlreadyCalledError";b(ob,e);ob.prototype.message="Deferred was canceled";ob.prototype.name="CanceledError";Hc.prototype.c=function(){delete Gb[this.a];throw this.b;};var Gb={},fa,Y,mb,Mb,Ba,ga,fc,pb,Tc;R.prototype.Events={SHOW:"show"};R.prototype.Events=R.prototype.Events;R.prototype.ga={LIKERT:"likertScale",MULTIPLE_CHOICE:"mcq",
SEMANTIC_DIFFERENTIAL:"semanticDifferentialScale",ORDINAL:"ordinalResponse",TEXT:"freeTextResponse"};R.prototype.QuestionType=R.prototype.ga;R.prototype.ba={SELECT:"select",SELECT_WITH_TEXT:"select_with_text",ORDINAL:"ordinal",TEXT:"text"};R.prototype.AnswerType=R.prototype.ba;R.prototype.ha={RADIO:"RADIO",CHECKBOX:"CHECKBOX"};R.prototype.SelectionType=R.prototype.ha;R.prototype.fa=fd;R.prototype.Errors=R.prototype.fa;R.prototype.Y=function(a,b){ga.info("getSurveyDetails");a?Ba.then(function(){var c=
a.ids;Array.isArray(c)||(c=[c]);for(var d=[],e=0;e<c.length;e++){var g=Dc(c[e],a.lang);if(g)d.push(g);else{d=null;break}}if(d)return b(null,d,null);c={lang:a.lang,id:a.ids};Mb.getJSON({url:window.InFlight.makeServiceURL("/surveys/v1/survey_questions"),query:c},function(c,d){if(c)b({code:c.code,text:""},null,null);else if(200!=d.code)b({code:d.code,text:""},null,null);else{var e,g=null;if(d.body.error){e=d.body.error;for(var h=0;h<e.length;h++)g||(g=[]),g.push(e[h]),ga.error("Error: Survey adaptor not created for survey id = "+
e[h].survey_id)}var k=null;if(d.body.data)for(e=d.body.data,h=0;h<e.length;h++){k||(k=[]);var m;m=e[h];var n=a.lang;l($a)||($a=Y.createLogger("survey/v1","inflight.survey.v1.question.SurveyFactory"));$a.info("createSurveyAdaptor, survey id = "+m.survey_id+", lang = "+n);var ma=Dc(m.survey_id,n),n=m.survey_id+(n?"_"+n:"");if(!ma){switch(m.flow){case "sequential":ma=new G(m)}ma&&ec.set(n,ma)}(m=ma)?(k.push(m),ga.info("Survey adaptor created for survey id = "+e[h].survey_id)):(g||(g=[]),g.push({code:404,
message:"Failed to create survey adaptor",survey_id:e[h].survey_id}),ga.error("Error: 404 - Failed to create survey adaptor for survey id = "+e[h].survey_id))}b(null,k,g)}})},function(){b(new Aa(20006),null,null)}):b(new Aa(400),null,null)};R.prototype.getSurveyDetails=R.prototype.Y;R.prototype.ra=function(a,b){ga.info("getSurveySummaries");a?(Array.isArray(a.W)&&0<a.W.length&&(a.W=a.W.join()),Ba.then(function(){Mb.getJSON({url:window.InFlight.makeServiceURL("/surveys/v1/survey_summary"),query:a},
function(a,c){a?b({code:a.code,text:""},null):200!=c.code?b({code:c.code,text:""},null):b(null,c.body.data)})},function(){b(new Aa(20006),null)})):b(new Aa(400),null)};R.prototype.getSurveySummaries=R.prototype.ra;R.prototype.addEventListener=function(a,b){ga.info("add survey event listener - "+a);Tc.register({event_name:a,namespace:"core.survey",callback:function(a){b(a)}})};R.prototype.addEventListener=R.prototype.addEventListener;var Hb=null,hb=null,qb=!1,$c=!0;window.InFlight.define("survey/v1",
"sdk/v1/http sdk/v1/event sdk/v1/logger sdk/v1/devicestorage sdk/v1/pagevisibilitydispatcher system/v1 flightdata/v2 service_control/v1".split(" "),function(a,b,c,d,e,g,h){Mb=a;Tc=b;Y=c;fa=d;mb=e;fc=g;pb=h;return new R})}).call(window);
new function(){function l(){k.createLogger("user/ppv/v1","main").info("user/ppv/v1 service loaded")}function p(c,d){h=c;k=d;return new l}var k,h,m=["inflight","user","v1","Api"],g=this;m[0]in g||!g.execScript||g.execScript("var "+m[0]);for(var d;m.length&&(d=m.shift());)m.length||void 0===l?g[d]?g=g[d]:g=g[d]={}:g[d]=l;l.prototype.setGroundPurchaseTokens=function(c,d){var b=k.createLogger("user/ppv/v1","setGroundPurchaseTokens");b.info("setGroundPurchaseTokens",c);if(c&&c.tokens&&Array.isArray(c.tokens)){var a=
{tokens:c.tokens};h.postJSON({url:window.InFlight.makeServiceURL("/ppv/v1/jwt_tokens",!0),data:JSON.stringify(a),headers:{"Content-Type":"application/json"}},function(a,c){a?(b.trace("HTTP error",a),d({code:a.code,text:""},null)):200!==c.code?(b.trace("HTTP error",c.code),d({code:c.code,text:""},null)):(c.body.error&&(b.trace("Service Error",c.body),d({code:c.body.error.code,text:""},null)),d(null,c.body))})}else b.error("invalid arguments: "+JSON.stringify(c)),d({code:400,text:""},null)};l.prototype.setGroundPurchaseTokens=
l.prototype.setGroundPurchaseTokens;l.factory=p;window.InFlight.define("user/ppv/v1",["sdk/v1/http","sdk/v1/logger"],p)};
(function(){function l(){}function p(a){var b=typeof a;if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";
else if("function"==b&&"undefined"==typeof a.call)return"object";return b}function k(a){return"function"==p(a)}function h(a){var b=typeof a;return"object"==b&&null!=a||"function"==b}function m(a,b,c){return a.call.apply(a.bind,arguments)}function g(a,b,c){if(!a)throw Error();if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(c,d);return a.apply(b,c)}}return function(){return a.apply(b,arguments)}}
function d(a,b,c){d=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?m:g;return d.apply(null,arguments)}function c(a,b){function c(){}c.prototype=b.prototype;a.U=b.prototype;a.prototype=new c;a.prototype.constructor=a;a.T=function(a,c,d){for(var e=Array(arguments.length-2),g=2;g<arguments.length;g++)e[g-2]=arguments[g];return b.prototype[c].apply(a,e)}}function q(a){if(Error.captureStackTrace)Error.captureStackTrace(this,q);else{var b=Error().stack;b&&(this.stack=
b)}a&&(this.message=String(a))}function b(a,b){this.code=a;this.text=null!=b?b:"";q.call(this,b)}function a(a,b,c){this.f=c;this.c=a;this.g=b;this.b=0;this.a=null}function w(a,b){a.g(b);a.b<a.f&&(a.b++,b.next=a.a,a.a=b)}function x(){var a=fb,b=null;a.a&&(b=a.a,a.a=a.a.next,a.a||(a.b=null),b.next=null);return b}function v(){this.next=this.b=this.a=null}function t(a){M.setTimeout(function(){throw a;},0)}function n(){var a=M.MessageChannel;"undefined"===typeof a&&"undefined"!==typeof window&&window.postMessage&&
window.addEventListener&&-1==Ca.indexOf("Presto")&&(a=function(){var a=document.createElement("IFRAME");a.style.display="none";a.src="";document.documentElement.appendChild(a);var b=a.contentWindow,a=b.document;a.open();a.write("");a.close();var c="callImmediate"+Math.random(),e="file:"==b.location.protocol?"*":b.location.protocol+"//"+b.location.host,a=d(function(a){if(("*"==e||a.origin==e)&&a.data==c)this.port1.onmessage()},this);b.addEventListener("message",a,!1);this.port1={};this.port2={postMessage:function(){b.postMessage(c,
e)}}});if("undefined"!==typeof a&&-1==Ca.indexOf("Trident")&&-1==Ca.indexOf("MSIE")){var b=new a,c={},e=c;b.port1.onmessage=function(){if(void 0!==c.next){c=c.next;var a=c.K;c.K=null;a()}};return function(a){e.next={K:a};e=e.next;b.port2.postMessage(0)}}return"undefined"!==typeof document&&"onreadystatechange"in document.createElement("SCRIPT")?function(a){var b=document.createElement("SCRIPT");b.onreadystatechange=function(){b.onreadystatechange=null;b.parentNode.removeChild(b);b=null;a();a=null};
document.documentElement.appendChild(b)}:function(a){M.setTimeout(a,0)}}function z(a,b){ja||y();Na||(ja(),Na=!0);var c=fb,d=ta.get();d.set(a,b);c.b?c.b.next=d:c.a=d;c.b=d}function y(){if(M.Promise&&M.Promise.resolve){var a=M.Promise.resolve(void 0);ja=function(){a.then(u)}}else ja=function(){var a=u;!k(M.setImmediate)||M.Window&&M.Window.prototype&&-1==Ca.indexOf("Edge")&&M.Window.prototype.setImmediate==M.setImmediate?(wa||(wa=n()),wa(a)):M.setImmediate(a)}}function u(){for(var a;a=x();){try{a.a.call(a.b)}catch(b){t(b)}w(ta,
a)}Na=!1}function C(a){a.prototype.then=a.prototype.then;a.prototype.$goog_Thenable=!0}function F(a){if(!a)return!1;try{return!!a.$goog_Thenable}catch(b){return!1}}function e(a,b){this.a=Ga;this.j=void 0;this.f=this.b=this.c=null;this.g=this.i=!1;if(a!=l)try{var c=this;a.call(b,function(a){T(c,Ka,a)},function(a){if(!(a instanceof B))try{if(a instanceof Error)throw a;throw Error("Promise rejected.");}catch(b){}T(c,xa,a)})}catch(d){T(this,xa,d)}}function r(){this.next=this.c=this.b=this.f=this.a=null;
this.g=!1}function A(a,b,c){var d=ub.get();d.f=a;d.b=b;d.c=c;return d}function Z(a,b){if(a.a==Ga)if(a.c){var c=a.c;if(c.b){for(var d=0,e=null,g=null,h=c.b;h&&(h.g||(d++,h.a==a&&(e=h),!(e&&1<d)));h=h.next)e||(g=h);e&&(c.a==Ga&&1==d?Z(c,b):(g?(d=g,d.next==c.f&&(c.f=d),d.next=d.next.next):J(c),Q(c,e,xa,b)))}a.c=null}else T(a,xa,b)}function W(a,b){a.b||a.a!=Ka&&a.a!=xa||a.i||(a.i=!0,z(a.m,a));a.f?a.f.next=b:a.b=b;a.f=b}function oa(a,b,c,d){var g=A(null,null,null);g.a=new e(function(a,e){g.f=b?function(c){try{var g=
b.call(d,c);a(g)}catch(h){e(h)}}:a;g.b=c?function(b){try{var g=c.call(d,b);void 0===g&&b instanceof B?e(b):a(g)}catch(h){e(h)}}:e});g.a.c=a;W(a,g);return g.a}function T(a,b,c){if(a.a==Ga){a===c&&(b=xa,c=new TypeError("Promise cannot resolve to itself"));a.a=1;var d;a:{var g=c,m=a.o,n=a.s;if(g instanceof e)W(g,A(m||l,n||null,a)),d=!0;else if(F(g))g.then(m,n,a),d=!0;else{if(h(g))try{var p=g.then;if(k(p)){ea(g,p,m,n,a);d=!0;break a}}catch(q){n.call(a,q);d=!0;break a}d=!1}}d||(a.j=c,a.a=b,a.c=null,a.i||
(a.i=!0,z(a.m,a)),b!=xa||c instanceof B||N(a,c))}}function ea(a,b,c,d,e){function g(a){k||(k=!0,d.call(e,a))}function h(a){k||(k=!0,c.call(e,a))}var k=!1;try{b.call(a,h,g)}catch(l){g(l)}}function J(a){var b=null;a.b&&(b=a.b,a.b=b.next,b.next=null);a.b||(a.f=null);return b}function Q(a,b,c,d){if(c==xa&&b.b&&!b.g)for(;a&&a.g;a=a.c)a.g=!1;if(b.a)b.a.c=null,X(b,c,d);else try{b.g?b.f.call(b.c):X(b,c,d)}catch(e){Pa.call(null,e)}w(ub,b)}function X(a,b,c){b==Ka?a.f.call(a.c,c):a.b&&a.b.call(a.c,c)}function N(a,
b){a.g=!0;z(function(){a.g&&Pa.call(null,b)})}function B(a){q.call(this,a)}function L(a,b){this.g=[];this.M=a;this.L=b||null;this.f=this.a=!1;this.b=void 0;this.o=this.S=this.j=!1;this.i=0;this.c=null;this.m=0}function ra(a,b,c){a.g.push([b,c,void 0]);a.a&&na(a)}function da(a){return Wa(a.g,function(a){return k(a[1])})}function na(a){if(a.i&&a.a&&da(a)){var b=a.i,c=Va[b];c&&(M.clearTimeout(c.a),delete Va[b]);a.i=0}a.c&&(a.c.m--,delete a.c);for(var b=a.b,e=c=!1;a.g.length&&!a.j;){var g=a.g.shift(),
h=g[0],k=g[1],g=g[2];if(h=a.f?k:h)try{var l=h.call(g||a.L,b);void 0!==l&&(a.f=a.f&&(l==b||l instanceof Error),a.b=b=l);if(F(b)||"function"===typeof M.Promise&&b instanceof M.Promise)e=!0,a.j=!0}catch(m){b=m,a.f=!0,da(a)||(c=!0)}}a.b=b;e&&(l=d(a.s,a,!0),e=d(a.s,a,!1),b instanceof L?(ra(b,l,e),b.S=!0):b.then(l,e));c&&(b=new ka(b),Va[b.a]=b,a.i=b.a)}function qa(){q.call(this)}function I(){q.call(this)}function ka(a){this.a=M.setTimeout(d(this.c,this),0);this.b=a}function D(){void 0!==H||(H=gb.createLogger("content_discovery/v1",
"Api"));this.h=null;H.info("Content Discovery API Loaded")}function ba(a){var b=[];a.min&&b.push(a.min);b.push("-");a.max&&b.push(a.max);return b.join("")}function U(a){var b={},c;for(c in a)switch(c){case "filters":if(h(a[c]))for(var d in a[c]){var e;e=a[c][d];(e="array"==p(e)&&0<e.length?e.join():h(e)&&(e.min||e.max)?ba(e):"string"!=typeof e&&"number"!=typeof e||""===e&&void 0===e?null:e)&&(b[d]=e)}break;case "image_resolution":e=[];if("array"==p(a[c])){for(var g in a[c])if(h(a[c])){var k;k=a[c][g];
var l=[];k.width&&l.push(k.width);l.push("x");k.height&&l.push(k.height);(k=l.join(""))&&e.push(k)}b[c]=e.join()}break;case "requested_fields":case "image_size_selector":case "tag_names":case "tag_filter_value":case "content_uri_list":b[c]=a[c].join();break;default:b[c]=a[c]}return b}function la(a,b){this.code=a;this.text=null!=b?b:"";q.call(this,b)}function E(){void 0!==S||(S=eb.createLogger("content_discovery/v2","Api"));this.h=null;S.info("Content Discovery API Loaded")}function Ea(a){var b={},
c;for(c in a)b[c]=a[c];return b}var M=this;c(q,Error);q.prototype.name="CustomError";c(b,q);b.prototype.name="ContentDiscoveryError";a.prototype.get=function(){var a;0<this.b?(this.b--,a=this.a,this.a=a.next,a.next=null):a=this.c();return a};var ta=new a(function(){return new v},function(a){a.reset()},100);v.prototype.set=function(a,b){this.a=a;this.b=b;this.next=null};v.prototype.reset=function(){this.next=this.b=this.a=null};var Ca;a:{var Da=M.navigator;if(Da&&(Da=Da.userAgent)){Ca=Da;break a}Ca=
""}var Wa=Array.prototype.some?function(a,b,c){return Array.prototype.some.call(a,b,c)}:function(a,b,c){for(var d=a.length,e="string"==typeof a?a.split(""):a,g=0;g<d;g++)if(g in e&&b.call(c,e[g],g,a))return!0;return!1},wa,ja,Na=!1,fb=new function(){this.b=this.a=null},Ga=0,Ka=2,xa=3;r.prototype.reset=function(){this.c=this.b=this.f=this.a=null;this.g=!1};var ub=new a(function(){return new r},function(a){a.reset()},100);e.prototype.then=function(a,b,c){return oa(this,k(a)?a:null,k(b)?b:null,c)};C(e);
e.prototype.cancel=function(a){this.a==Ga&&z(function(){var b=new B(a);Z(this,b)},this)};e.prototype.o=function(a){this.a=Ga;T(this,Ka,a)};e.prototype.s=function(a){this.a=Ga;T(this,xa,a)};e.prototype.m=function(){for(var a;a=J(this);)Q(this,a,this.a,this.j);this.i=!1};var Pa=t;c(B,q);B.prototype.name="cancel";L.prototype.cancel=function(a){if(this.a)this.b instanceof L&&this.b.cancel();else{if(this.c){var b=this.c;delete this.c;a?b.cancel(a):(b.m--,0>=b.m&&b.cancel())}this.M?this.M.call(this.L,this):
this.o=!0;if(!this.a){a=new I;if(this.a){if(!this.o)throw new qa;this.o=!1}this.a=!0;this.b=a;this.f=!0;na(this)}}};L.prototype.s=function(a,b){this.j=!1;this.a=!0;this.b=b;this.f=!a;na(this)};L.prototype.then=function(a,b,c){var d,g,h=new e(function(a,b){d=a;g=b});ra(this,d,function(a){a instanceof I?h.cancel():g(a)});return h.then(a,b,c)};C(L);c(qa,q);qa.prototype.message="Deferred has already fired";qa.prototype.name="AlreadyCalledError";c(I,q);I.prototype.message="Deferred was canceled";I.prototype.name=
"CanceledError";ka.prototype.c=function(){delete Va[this.a];throw this.b;};var Va={},H,gb,ia,O;D.prototype.N={UNKNOWN:40001,INVALID_ARGUMENTS:40002,INVALID_METHOD_NAME:40003,SERVICE_UNAVAILABLE:40004};D.prototype.Errors=D.prototype.N;D.prototype.w=function(a){H.info("getContentNames");ia.getJSON({url:window.InFlight.makeServiceURL("/content_discovery/v1/content_inventory")},function(b,c){b?a({code:b.code,text:""},null):200!=c.code?a({code:c.code,text:""},null):a(null,c.body.data)})};D.prototype.getContentNames=
D.prototype.w;D.prototype.A=function(a,c){H.info("getContentTypes",a);a?ia.getJSON({url:window.InFlight.makeServiceURL("/content_discovery/v1/content_type_list"),query:a},function(a,b){a?c({code:a.code,text:""},null):200!=b.code?c({code:b.code,text:""},null):c(null,b.body.data)}):c(new b(400),null)};D.prototype.getContentTypes=D.prototype.A;D.prototype.C=function(){if(1===arguments.length)return D.prototype.D(arguments[0]);if(2===arguments.length)return D.prototype.F(arguments[0],arguments[1])};D.prototype.getLanguages=
D.prototype.C;D.prototype.D=function(a){H.info("getLanguages");ia.getJSON({url:window.InFlight.makeServiceURL("/content_discovery/v1/language_list")},function(b,c){b?a({code:b.code,text:""},null):200!=c.code?a({code:c.code,text:""},null):a(null,c.body.data)})};D.prototype.F=function(a,c){H.info("getLanguages");a?ia.getJSON({url:window.InFlight.makeServiceURL("/content_discovery/v1/language_list"),query:U(a)},function(a,b){a?c({code:a.code,text:""},null):200!=b.code?c({code:b.code,text:""},null):c(null,
b.body.data)}):c(new b(400),null)};D.prototype.v=function(a,c){H.info("getCategories",a);a&&a.content_name?ia.getJSON({url:window.InFlight.makeServiceURL("/content_discovery/v1/category_list"),query:U(a)},function(a,b){a?c({code:a.code,text:""},null):200!=b.code?c({code:b.code,text:""},null):c(null,b.body.data)}):c(new b(400),null)};D.prototype.getCategories=D.prototype.v;D.prototype.H=function(a,c){H.info("getTags",a);a?ia.getJSON({url:window.InFlight.makeServiceURL("/content_discovery/v1/tag_list"),
query:a},function(a,b){a?c({code:a.code,text:""},null):200!=b.code?c({code:b.code,text:""},null):c(null,b.body.data)}):c(new b(400),null)};D.prototype.getTags=D.prototype.H;D.prototype.G=function(a,c){H.info("getTagValues",a);a?ia.getJSON({url:window.InFlight.makeServiceURL("/content_discovery/v1/tag_value_list"),query:U(a)},function(a,b){a?c({code:a.code,text:""},null):200!=b.code?c({code:b.code,text:""},null):c(null,b.body.data)}):c(new b(400),null)};D.prototype.getTagValues=D.prototype.G;D.prototype.R=
function(a,c){var d=this;H.info("getItemsByTagValue",a);a?ia.getJSON({url:window.InFlight.makeServiceURL("/content_discovery/v1/items_by_tag_value"),query:U(a)},function(a,b){if(a)c({code:a.code,text:""},null);else if(200!=b.code)c({code:b.code,text:""},null);else{if(Array.isArray(b.body.data))for(var e=0;e<b.body.data.length;e++)b.body.data[e].playable=d.l(b.body.data[e].key_type);c(null,b.body.data)}}):c(new b(400),null)};D.prototype.getItemsByTagValue=D.prototype.R;D.prototype.B=function(a,c){var d=
this;H.info("getItemDetails",a);a?ia.getJSON({url:window.InFlight.makeServiceURL("/content_discovery/v1/items_detail"),query:U(a)},function(a,b){if(a)c({code:a.code,text:""},null);else if(200!=b.code)c({code:b.code,text:""},null);else{if(Array.isArray(b.body.data))for(var e=0;e<b.body.data.length;e++)b.body.data[e].playable=d.l(b.body.data[e].key_type);c(null,b.body.data)}}):c(new b(400),null)};D.prototype.getItemDetails=D.prototype.B;D.prototype.I=function(a,c){var d=this;H.info("searchByField",
a);a?ia.getJSON({url:window.InFlight.makeServiceURL("/content_discovery/v1/search_by_field"),query:U(a)},function(a,b){if(a)c({code:a.code,text:""},null);else if(200!=b.code)c({code:b.code,text:""},null);else{if(Array.isArray(b.body.data))for(var e=0;e<b.body.data.length;e++)b.body.data[e].playable=d.l(b.body.data[e].key_type);c(null,b.body.data)}}):c(new b(400),null)};D.prototype.searchByField=D.prototype.I;D.prototype.J=function(a,c){var d=this;H.info("searchByText",a);a?ia.getJSON({url:window.InFlight.makeServiceURL("/content_discovery/v1/search_by_text"),
query:U(a)},function(a,b){if(a)c({code:a.code,text:""},null);else if(200!=b.code)c({code:b.code,text:""},null);else{if(Array.isArray(b.body.data))for(var e=0;e<b.body.data.length;e++)b.body.data[e].playable=d.l(b.body.data[e].key_type);c(null,b.body.data)}}):c(new b(400),null)};D.prototype.searchByText=D.prototype.J;D.prototype.u=function(a,c){H.info("getBundles",a);a?ia.getJSON({url:window.InFlight.makeServiceURL("/content_discovery/v1/bundles"),query:{content_name:a.content_name,seat_class:a.seat_class,
price:ba(a.price)}},function(a,b){a?c({code:a.code,text:""},null):200!=b.code?c({code:b.code,text:""},null):c(null,b.body.data)}):c(new b(400),null)};D.prototype.getBundles=D.prototype.u;D.prototype.l=function(a){if(!this.h){if(!O)return"playable.no";this.h=O.getEncryptionSupport()}return a&&this.h[a]?this.h[a].toString():"playable.no"};window.InFlight.define("content_discovery/v1",["sdk/v1/http","sdk/v1/logger","avod/v1"],function(a,b,c){ia=a;gb=b;O=c;return new D});c(la,q);la.prototype.name="ContentDiscoveryError";
var S,eb,ca,Xa;E.prototype.w=function(a){S.info("getContentNames");ca.getJSON({url:window.InFlight.makeServiceURL("/content_discovery/v1/content_inventory")},function(b,c){b?a({code:b.code,text:""},null):200!=c.code?a({code:c.code,text:""},null):a(null,c.body.data)})};E.prototype.getContentNames=E.prototype.w;E.prototype.A=function(a,b){S.info("getContentTypes",a);a?ca.getJSON({url:window.InFlight.makeServiceURL("/content_discovery/v1/content_type_list"),query:a},function(a,c){a?b({code:a.code,text:""},
null):200!=c.code?b({code:c.code,text:""},null):b(null,c.body.data)}):b(new la(400),null)};E.prototype.getContentTypes=E.prototype.A;E.prototype.C=function(){console.log("WE are in V2 space!!!!!!!!!!!!!!!!!!!!");if(1===arguments.length)return E.prototype.D(arguments[0]);if(2===arguments.length)return E.prototype.F(arguments[0],arguments[1])};E.prototype.getLanguages=E.prototype.C;E.prototype.D=function(a){S.info("getLanguages");ca.getJSON({url:window.InFlight.makeServiceURL("/content_discovery/v1/language_list")},
function(b,c){b?a({code:b.code,text:""},null):200!=c.code?a({code:c.code,text:""},null):a(null,c.body.data)})};E.prototype.F=function(a,b){S.info("getLanguages");a?ca.getJSON({url:window.InFlight.makeServiceURL("/content_discovery/v1/language_list"),query:Ea(a)},function(a,c){a?b({code:a.code,text:""},null):200!=c.code?b({code:c.code,text:""},null):b(null,c.body.data)}):b(new la(400),null)};E.prototype.v=function(a,b){S.info("getCategories",a);a&&a.content_name?ca.getJSON({url:window.InFlight.makeServiceURL("/content_discovery/v1/category_list"),
query:Ea(a)},function(a,c){a?b({code:a.code,text:""},null):200!=c.code?b({code:c.code,text:""},null):b(null,c.body.data)}):b(new la(400),null)};E.prototype.getCategories=E.prototype.v;E.prototype.H=function(a,b){S.info("getTags",a);a?ca.getJSON({url:window.InFlight.makeServiceURL("/content_discovery/v1/tag_list"),query:a},function(a,c){a?b({code:a.code,text:""},null):200!=c.code?b({code:c.code,text:""},null):b(null,c.body.data)}):b(new la(400),null)};E.prototype.getTags=E.prototype.H;E.prototype.G=
function(a,b){S.info("getTagValues",a);a?ca.getJSON({url:window.InFlight.makeServiceURL("/content_discovery/v1/tag_value_list"),query:Ea(a)},function(a,c){a?b({code:a.code,text:""},null):200!=c.code?b({code:c.code,text:""},null):b(null,c.body.data)}):b(new la(400),null)};E.prototype.getTagValues=E.prototype.G;E.prototype.P=function(a,b){S.info("getItems",a);a?ca.getJSON({url:window.InFlight.makeServiceURL("/content_discovery/v1/items_by_tag_value"),query:Ea(a)},function(a,c){a?b({code:a.code,text:""},
null):200!=c.code?b({code:c.code,text:""},null):b(null,c.body.data)}):b(new la(400),null)};E.prototype.getItems=E.prototype.P;E.prototype.B=function(a,b){S.info("getItemDetails",a);a?ca.getJSON({url:window.InFlight.makeServiceURL("/content_discovery/v1/items_detail"),query:Ea(a)},function(a,c){a?b({code:a.code,text:""},null):200!=c.code?b({code:c.code,text:""},null):b(null,c.body.data)}):b(new la(400),null)};E.prototype.getItemDetails=E.prototype.B;E.prototype.I=function(a,b){S.info("searchByField",
a);a?ca.getJSON({url:window.InFlight.makeServiceURL("/content_discovery/v1/search_by_field"),query:Ea(a)},function(a,c){a?b({code:a.code,text:""},null):200!=c.code?b({code:c.code,text:""},null):b(null,c.body.data)}):b(new la(400),null)};E.prototype.searchByField=E.prototype.I;E.prototype.J=function(a,b){S.info("searchByText",a);a?ca.getJSON({url:window.InFlight.makeServiceURL("/content_discovery/v1/search_by_text"),query:Ea(a)},function(a,c){a?b({code:a.code,text:""},null):200!=c.code?b({code:c.code,
text:""},null):b(null,c.body.data)}):b(new la(400),null)};E.prototype.searchByText=E.prototype.J;E.prototype.u=function(a,b){S.info("getBundles",a);a?ca.getJSON({url:window.InFlight.makeServiceURL("/content_discovery/v1/bundles"),query:U(a)},function(a,c){a?b({code:a.code,text:""},null):200!=c.code?b({code:c.code,text:""},null):b(null,c.body.data)}):b(new la(400),null)};E.prototype.getBundles=E.prototype.u;E.prototype.O=function(a,b){S.info("getFieldValue",a);a?ca.getJSON({url:window.InFlight.makeServiceURL("/content_discovery/v1/field_values"),
query:U(a)},function(a,c){a?b({code:a.code,text:""},null):200!=c.code?b({code:c.code,text:""},null):b(null,c.body.data)}):b(new la(400),null)};E.prototype.getFieldValue=E.prototype.O;E.prototype.l=function(a){if(!this.h){if(!Xa)return"playable.no";this.h=Xa.getEncryptionSupport()}return a&&this.h[a]?this.h[a].toString():"playable.no"};window.InFlight.define("content_discovery/v2",["sdk/v1/http","sdk/v1/logger","avod/v1"],function(a,b,c){ca=a;eb=b;Xa=c;return new E})}).call(window);
